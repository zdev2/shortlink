{"version":3,"file":"index.umd.min.js","sources":["../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/createClass.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/callSuper.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/inherits.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-nil.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-type.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-string.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/clamp.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-number.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/common.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/mat4.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/vec3.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/path/util/rotate-vector.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/path/process/arc-2-cubic.js","../../g-plugin-canvas-path-generator/dist/index.esm.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/vec2.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../../g-math/dist/index.esm.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../g-plugin-canvas-picker/dist/index.esm.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase.js","../../../node_modules/.pnpm/@babel+runtime@7.25.6/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey.js","../../g-plugin-image-loader/dist/index.esm.js","../../g-plugin-canvas-renderer/dist/index.esm.js","../../g-plugin-dom-interaction/dist/index.esm.js","../../g-plugin-html-renderer/dist/index.esm.js","../src/Canvas2DContextService.ts","../src/ContextRegisterPlugin.ts","../src/index.ts"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nexport { _classCallCheck as default };","function _getPrototypeOf(t) {\n  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, _getPrototypeOf(t);\n}\nexport { _getPrototypeOf as default };","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  })();\n}\nexport { _isNativeReflectConstruct as default };","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nexport { _possibleConstructorReturn as default };","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nexport { _assertThisInitialized as default };","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nfunction _callSuper(t, o, e) {\n  return o = getPrototypeOf(o), possibleConstructorReturn(t, isNativeReflectConstruct() ? Reflect.construct(o, e || [], getPrototypeOf(t).constructor) : o.apply(t, e));\n}\nexport { _callSuper as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nexport { _inherits as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","// isFinite,\nvar isNil = function (value) {\n    /**\n     * isNil(null) => true\n     * isNil() => true\n     */\n    return value === null || value === undefined;\n};\nexport default isNil;\n//# sourceMappingURL=is-nil.js.map","var toString = {}.toString;\nvar isType = function (value, type) { return toString.call(value) === '[object ' + type + ']'; };\nexport default isType;\n//# sourceMappingURL=is-type.js.map","import isType from './is-type';\nexport default (function (str) {\n    return isType(str, 'String');\n});\n//# sourceMappingURL=is-string.js.map","var clamp = function (a, min, max) {\n    if (a < min) {\n        return min;\n    }\n    else if (a > max) {\n        return max;\n    }\n    return a;\n};\nexport default clamp;\n//# sourceMappingURL=clamp.js.map","/**\n * 判断是否数字\n * @return {Boolean} 是否数字\n */\nimport isType from './is-type';\nvar isNumber = function (value) {\n    return isType(value, 'Number');\n};\nexport default isNumber;\n//# sourceMappingURL=is-number.js.map","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","export function rotateVector(x, y, rad) {\n    var X = x * Math.cos(rad) - y * Math.sin(rad);\n    var Y = x * Math.sin(rad) + y * Math.cos(rad);\n    return { x: X, y: Y };\n}\n//# sourceMappingURL=rotate-vector.js.map","import { rotateVector } from '../util/rotate-vector';\n/**\n * Converts A (arc-to) segments to C (cubic-bezier-to).\n *\n * For more information of where this math came from visit:\n * http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n */\nexport function arcToCubic(X1, Y1, RX, RY, angle, LAF, SF, X2, Y2, recursive) {\n    var x1 = X1;\n    var y1 = Y1;\n    var rx = RX;\n    var ry = RY;\n    var x2 = X2;\n    var y2 = Y2;\n    // for more information of where this Math came from visit:\n    // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n    var d120 = (Math.PI * 120) / 180;\n    var rad = (Math.PI / 180) * (+angle || 0);\n    /** @type {number[]} */\n    var res = [];\n    var xy;\n    var f1;\n    var f2;\n    var cx;\n    var cy;\n    if (!recursive) {\n        xy = rotateVector(x1, y1, -rad);\n        x1 = xy.x;\n        y1 = xy.y;\n        xy = rotateVector(x2, y2, -rad);\n        x2 = xy.x;\n        y2 = xy.y;\n        var x = (x1 - x2) / 2;\n        var y = (y1 - y2) / 2;\n        var h = (x * x) / (rx * rx) + (y * y) / (ry * ry);\n        if (h > 1) {\n            h = Math.sqrt(h);\n            rx *= h;\n            ry *= h;\n        }\n        var rx2 = rx * rx;\n        var ry2 = ry * ry;\n        var k = (LAF === SF ? -1 : 1) *\n            Math.sqrt(Math.abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x)));\n        cx = (k * rx * y) / ry + (x1 + x2) / 2;\n        cy = (k * -ry * x) / rx + (y1 + y2) / 2;\n        // eslint-disable-next-line no-bitwise -- Impossible to satisfy no-bitwise\n        f1 = Math.asin(((((y1 - cy) / ry) * Math.pow(10, 9)) >> 0) / Math.pow(10, 9));\n        // eslint-disable-next-line no-bitwise -- Impossible to satisfy no-bitwise\n        f2 = Math.asin(((((y2 - cy) / ry) * Math.pow(10, 9)) >> 0) / Math.pow(10, 9));\n        f1 = x1 < cx ? Math.PI - f1 : f1;\n        f2 = x2 < cx ? Math.PI - f2 : f2;\n        if (f1 < 0)\n            f1 = Math.PI * 2 + f1;\n        if (f2 < 0)\n            f2 = Math.PI * 2 + f2;\n        if (SF && f1 > f2) {\n            f1 -= Math.PI * 2;\n        }\n        if (!SF && f2 > f1) {\n            f2 -= Math.PI * 2;\n        }\n    }\n    else {\n        f1 = recursive[0], f2 = recursive[1], cx = recursive[2], cy = recursive[3];\n    }\n    var df = f2 - f1;\n    if (Math.abs(df) > d120) {\n        var f2old = f2;\n        var x2old = x2;\n        var y2old = y2;\n        f2 = f1 + d120 * (SF && f2 > f1 ? 1 : -1);\n        x2 = cx + rx * Math.cos(f2);\n        y2 = cy + ry * Math.sin(f2);\n        res = arcToCubic(x2, y2, rx, ry, angle, 0, SF, x2old, y2old, [f2, f2old, cx, cy]);\n    }\n    df = f2 - f1;\n    var c1 = Math.cos(f1);\n    var s1 = Math.sin(f1);\n    var c2 = Math.cos(f2);\n    var s2 = Math.sin(f2);\n    var t = Math.tan(df / 4);\n    var hx = (4 / 3) * rx * t;\n    var hy = (4 / 3) * ry * t;\n    var m1 = [x1, y1];\n    var m2 = [x1 + hx * s1, y1 - hy * c1];\n    var m3 = [x2 + hx * s2, y2 - hy * c2];\n    var m4 = [x2, y2];\n    m2[0] = 2 * m1[0] - m2[0];\n    m2[1] = 2 * m1[1] - m2[1];\n    if (recursive) {\n        return m2.concat(m3, m4, res);\n        // return [...m2, ...m3, ...m4, ...res];\n    }\n    res = m2.concat(m3, m4, res);\n    // res = [...m2, ...m3, ...m4, ...res];\n    var newres = [];\n    for (var i = 0, ii = res.length; i < ii; i += 1) {\n        newres[i] = i % 2 ? rotateVector(res[i - 1], res[i], rad).y : rotateVector(res[i], res[i + 1], rad).x;\n    }\n    return newres;\n}\n// const TAU = Math.PI * 2;\n// const mapToEllipse = (\n//   { x, y }: { x: number; y: number },\n//   rx: number,\n//   ry: number,\n//   cosphi: number,\n//   sinphi: number,\n//   centerx: number,\n//   centery: number,\n// ) => {\n//   x *= rx;\n//   y *= ry;\n//   const xp = cosphi * x - sinphi * y;\n//   const yp = sinphi * x + cosphi * y;\n//   return {\n//     x: xp + centerx,\n//     y: yp + centery,\n//   };\n// };\n// const approxUnitArc = (ang1: number, ang2: number) => {\n//   // If 90 degree circular arc, use a constant\n//   // as derived from http://spencermortensen.com/articles/bezier-circle\n//   const a =\n//     ang2 === 1.5707963267948966\n//       ? 0.551915024494\n//       : ang2 === -1.5707963267948966\n//       ? -0.551915024494\n//       : (4 / 3) * Math.tan(ang2 / 4);\n//   const x1 = Math.cos(ang1);\n//   const y1 = Math.sin(ang1);\n//   const x2 = Math.cos(ang1 + ang2);\n//   const y2 = Math.sin(ang1 + ang2);\n//   return [\n//     {\n//       x: x1 - y1 * a,\n//       y: y1 + x1 * a,\n//     },\n//     {\n//       x: x2 + y2 * a,\n//       y: y2 - x2 * a,\n//     },\n//     {\n//       x: x2,\n//       y: y2,\n//     },\n//   ];\n// };\n// const vectorAngle = (ux: number, uy: number, vx: number, vy: number) => {\n//   const sign = ux * vy - uy * vx < 0 ? -1 : 1;\n//   let dot = ux * vx + uy * vy;\n//   if (dot > 1) {\n//     dot = 1;\n//   }\n//   if (dot < -1) {\n//     dot = -1;\n//   }\n//   return sign * Math.acos(dot);\n// };\n// const getArcCenter = (\n//   px: any,\n//   py: any,\n//   cx: any,\n//   cy: any,\n//   rx: number,\n//   ry: number,\n//   largeArcFlag: number,\n//   sweepFlag: number,\n//   sinphi: number,\n//   cosphi: number,\n//   pxp: number,\n//   pyp: number,\n// ) => {\n//   const rxsq = Math.pow(rx, 2);\n//   const rysq = Math.pow(ry, 2);\n//   const pxpsq = Math.pow(pxp, 2);\n//   const pypsq = Math.pow(pyp, 2);\n//   let radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n//   if (radicant < 0) {\n//     radicant = 0;\n//   }\n//   radicant /= rxsq * pypsq + rysq * pxpsq;\n//   radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n//   const centerxp = ((radicant * rx) / ry) * pyp;\n//   const centeryp = ((radicant * -ry) / rx) * pxp;\n//   const centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n//   const centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n//   const vx1 = (pxp - centerxp) / rx;\n//   const vy1 = (pyp - centeryp) / ry;\n//   const vx2 = (-pxp - centerxp) / rx;\n//   const vy2 = (-pyp - centeryp) / ry;\n//   const ang1 = vectorAngle(1, 0, vx1, vy1);\n//   let ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n//   if (sweepFlag === 0 && ang2 > 0) {\n//     ang2 -= TAU;\n//   }\n//   if (sweepFlag === 1 && ang2 < 0) {\n//     ang2 += TAU;\n//   }\n//   return [centerx, centery, ang1, ang2];\n// };\n// const arcToBezier = ({ px, py, cx, cy, rx, ry, xAxisRotation = 0, largeArcFlag = 0, sweepFlag = 0 }) => {\n//   const curves = [];\n//   if (rx === 0 || ry === 0) {\n//     return [{ x1: 0, y1: 0, x2: 0, y2: 0, x: cx, y: cy }];\n//   }\n//   const sinphi = Math.sin((xAxisRotation * TAU) / 360);\n//   const cosphi = Math.cos((xAxisRotation * TAU) / 360);\n//   const pxp = (cosphi * (px - cx)) / 2 + (sinphi * (py - cy)) / 2;\n//   const pyp = (-sinphi * (px - cx)) / 2 + (cosphi * (py - cy)) / 2;\n//   if (pxp === 0 && pyp === 0) {\n//     return [{ x1: 0, y1: 0, x2: 0, y2: 0, x: cx, y: cy }];\n//   }\n//   rx = Math.abs(rx);\n//   ry = Math.abs(ry);\n//   const lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n//   if (lambda > 1) {\n//     rx *= Math.sqrt(lambda);\n//     ry *= Math.sqrt(lambda);\n//   }\n//   let [centerx, centery, ang1, ang2] = getArcCenter(\n//     px,\n//     py,\n//     cx,\n//     cy,\n//     rx,\n//     ry,\n//     largeArcFlag,\n//     sweepFlag,\n//     sinphi,\n//     cosphi,\n//     pxp,\n//     pyp,\n//   );\n//   // If 'ang2' == 90.0000000001, then `ratio` will evaluate to\n//   // 1.0000000001. This causes `segments` to be greater than one, which is an\n//   // unecessary split, and adds extra points to the bezier curve. To alleviate\n//   // this issue, we round to 1.0 when the ratio is close to 1.0.\n//   let ratio = Math.abs(ang2) / (TAU / 4);\n//   if (Math.abs(1.0 - ratio) < 0.0000001) {\n//     ratio = 1.0;\n//   }\n//   const segments = Math.max(Math.ceil(ratio), 1);\n//   ang2 /= segments;\n//   for (let i = 0; i < segments; i++) {\n//     curves.push(approxUnitArc(ang1, ang2));\n//     ang1 += ang2;\n//   }\n//   return curves.map((curve) => {\n//     const { x: x1, y: y1 } = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery);\n//     const { x: x2, y: y2 } = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery);\n//     const { x, y } = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery);\n//     return { x1, y1, x2, y2, x, y };\n//   });\n// };\n// export function arcToCubic(\n//   x1: number,\n//   y1: number,\n//   rx: number,\n//   ry: number,\n//   angle: number,\n//   LAF: number,\n//   SF: number,\n//   x2: number,\n//   y2: number,\n// ) {\n//   const curves = arcToBezier({\n//     px: x1,\n//     py: y1,\n//     cx: x2,\n//     cy: y2,\n//     rx,\n//     ry,\n//     xAxisRotation: angle,\n//     largeArcFlag: LAF,\n//     sweepFlag: SF,\n//   });\n//   return curves.reduce((prev, cur) => {\n//     const { x1, y1, x2, y2, x, y } = cur;\n//     prev.push(x1, y1, x2, y2, x, y);\n//     return prev;\n//   }, [] as number[]);\n// }\n//# sourceMappingURL=arc-2-cubic.js.map","/*!\n * @antv/g-plugin-canvas-path-generator\n * @description A G plugin of path generator with Canvas2D API\n * @version 2.0.13\n * @date 10/23/2024, 11:14:32 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport { isDisplayObject, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport { clamp } from '@antv/util';\n\nfunction generatePath$6(context, parsedStyle) {\n  var _parsedStyle$cx = parsedStyle.cx,\n    cx = _parsedStyle$cx === void 0 ? 0 : _parsedStyle$cx,\n    _parsedStyle$cy = parsedStyle.cy,\n    cy = _parsedStyle$cy === void 0 ? 0 : _parsedStyle$cy,\n    r = parsedStyle.r;\n  context.arc(cx, cy, r, 0, Math.PI * 2, false);\n}\n\nfunction generatePath$5(context, parsedStyle) {\n  var _parsedStyle$cx = parsedStyle.cx,\n    cx = _parsedStyle$cx === void 0 ? 0 : _parsedStyle$cx,\n    _parsedStyle$cy = parsedStyle.cy,\n    cy = _parsedStyle$cy === void 0 ? 0 : _parsedStyle$cy,\n    rx = parsedStyle.rx,\n    ry = parsedStyle.ry;\n\n  // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n  if (context.ellipse) {\n    context.ellipse(cx, cy, rx, ry, 0, 0, Math.PI * 2, false);\n  } else {\n    // 如果不支持，则使用圆来绘制，进行变形\n    var r = rx > ry ? rx : ry;\n    var scaleX = rx > ry ? 1 : rx / ry;\n    var scaleY = rx > ry ? ry / rx : 1;\n    context.save();\n    context.scale(scaleX, scaleY);\n    context.arc(cx, cy, r, 0, Math.PI * 2);\n  }\n}\n\nfunction generatePath$4(context, parsedStyle) {\n  var x1 = parsedStyle.x1,\n    y1 = parsedStyle.y1,\n    x2 = parsedStyle.x2,\n    y2 = parsedStyle.y2,\n    markerStart = parsedStyle.markerStart,\n    markerEnd = parsedStyle.markerEnd,\n    markerStartOffset = parsedStyle.markerStartOffset,\n    markerEndOffset = parsedStyle.markerEndOffset;\n  var startOffsetX = 0;\n  var startOffsetY = 0;\n  var endOffsetX = 0;\n  var endOffsetY = 0;\n  var rad = 0;\n  var x;\n  var y;\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = x2 - x1;\n    y = y2 - y1;\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = x1 - x2;\n    y = y1 - y2;\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n  context.moveTo(x1 + startOffsetX, y1 + startOffsetY);\n  context.lineTo(x2 + endOffsetX, y2 + endOffsetY);\n}\n\nfunction generatePath$3(context, parsedStyle) {\n  var markerStart = parsedStyle.markerStart,\n    markerEnd = parsedStyle.markerEnd,\n    markerStartOffset = parsedStyle.markerStartOffset,\n    markerEndOffset = parsedStyle.markerEndOffset;\n  var _parsedStyle$d = parsedStyle.d,\n    absolutePath = _parsedStyle$d.absolutePath,\n    segments = _parsedStyle$d.segments;\n  var startOffsetX = 0;\n  var startOffsetY = 0;\n  var endOffsetX = 0;\n  var endOffsetY = 0;\n  var rad = 0;\n  var x;\n  var y;\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    var _getStartTangent = markerStart.parentNode.getStartTangent(),\n      _getStartTangent2 = _slicedToArray(_getStartTangent, 2),\n      p1 = _getStartTangent2[0],\n      p2 = _getStartTangent2[1];\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    var _getEndTangent = markerEnd.parentNode.getEndTangent(),\n      _getEndTangent2 = _slicedToArray(_getEndTangent, 2),\n      _p = _getEndTangent2[0],\n      _p2 = _getEndTangent2[1];\n    x = _p[0] - _p2[0];\n    y = _p[1] - _p2[1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n  for (var i = 0; i < absolutePath.length; i++) {\n    var params = absolutePath[i];\n    var command = params[0];\n    var nextSegment = absolutePath[i + 1];\n    var useStartOffset = i === 0 && (startOffsetX !== 0 || startOffsetY !== 0);\n    var useEndOffset = (i === absolutePath.length - 1 || nextSegment && (nextSegment[0] === 'M' || nextSegment[0] === 'Z')) && endOffsetX !== 0 && endOffsetY !== 0;\n    switch (command) {\n      case 'M':\n        // Use start marker offset\n        if (useStartOffset) {\n          context.moveTo(params[1] + startOffsetX, params[2] + startOffsetY);\n        } else {\n          context.moveTo(params[1], params[2]);\n        }\n        break;\n      case 'L':\n        if (useEndOffset) {\n          context.lineTo(params[1] + endOffsetX, params[2] + endOffsetY);\n        } else {\n          context.lineTo(params[1], params[2]);\n        }\n        break;\n      case 'Q':\n        context.quadraticCurveTo(params[1], params[2], params[3], params[4]);\n        if (useEndOffset) {\n          context.lineTo(params[3] + endOffsetX, params[4] + endOffsetY);\n        }\n        break;\n      case 'C':\n        context.bezierCurveTo(params[1], params[2], params[3], params[4], params[5], params[6]);\n        if (useEndOffset) {\n          context.lineTo(params[5] + endOffsetX, params[6] + endOffsetY);\n        }\n        break;\n      case 'A':\n        {\n          var arcParams = segments[i].arcParams;\n          var cx = arcParams.cx,\n            cy = arcParams.cy,\n            rx = arcParams.rx,\n            ry = arcParams.ry,\n            startAngle = arcParams.startAngle,\n            endAngle = arcParams.endAngle,\n            xRotation = arcParams.xRotation,\n            sweepFlag = arcParams.sweepFlag;\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n          if (context.ellipse) {\n            context.ellipse(cx, cy, rx, ry, xRotation, startAngle, endAngle, !!(1 - sweepFlag));\n          } else {\n            // @see https://stackoverflow.com/a/47494351\n            var r = rx > ry ? rx : ry;\n            var scaleX = rx > ry ? 1 : rx / ry;\n            var scaleY = rx > ry ? ry / rx : 1;\n            context.translate(cx, cy);\n            context.rotate(xRotation);\n            context.scale(scaleX, scaleY);\n            context.arc(0, 0, r, startAngle, endAngle, !!(1 - sweepFlag));\n            context.scale(1 / scaleX, 1 / scaleY);\n            context.rotate(-xRotation);\n            context.translate(-cx, -cy);\n          }\n          if (useEndOffset) {\n            context.lineTo(params[6] + endOffsetX, params[7] + endOffsetY);\n          }\n          break;\n        }\n      case 'Z':\n        context.closePath();\n        break;\n    }\n  }\n}\n\nfunction generatePath$2(context, parsedStyle) {\n  var markerStart = parsedStyle.markerStart,\n    markerEnd = parsedStyle.markerEnd,\n    markerStartOffset = parsedStyle.markerStartOffset,\n    markerEndOffset = parsedStyle.markerEndOffset;\n  var points = parsedStyle.points.points;\n  var length = points.length;\n  var x1 = points[0][0];\n  var y1 = points[0][1];\n  var x2 = points[length - 1][0];\n  var y2 = points[length - 1][1];\n  var startOffsetX = 0;\n  var startOffsetY = 0;\n  var endOffsetX = 0;\n  var endOffsetY = 0;\n  var rad = 0;\n  var x;\n  var y;\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = points[1][0] - points[0][0];\n    y = points[1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = points[length - 1][0] - points[0][0];\n    y = points[length - 1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n  context.moveTo(x1 + (startOffsetX || endOffsetX), y1 + (startOffsetY || endOffsetY));\n  for (var i = 1; i < length - 1; i++) {\n    var point = points[i];\n    context.lineTo(point[0], point[1]);\n  }\n  context.lineTo(x2, y2);\n}\n\nfunction generatePath$1(context, parsedStyle) {\n  var markerStart = parsedStyle.markerStart,\n    markerEnd = parsedStyle.markerEnd,\n    markerStartOffset = parsedStyle.markerStartOffset,\n    markerEndOffset = parsedStyle.markerEndOffset;\n  var points = parsedStyle.points.points;\n  var length = points.length;\n  var x1 = points[0][0];\n  var y1 = points[0][1];\n  var x2 = points[length - 1][0];\n  var y2 = points[length - 1][1];\n  var startOffsetX = 0;\n  var startOffsetY = 0;\n  var endOffsetX = 0;\n  var endOffsetY = 0;\n  var rad = 0;\n  var x;\n  var y;\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = points[1][0] - points[0][0];\n    y = points[1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = points[length - 2][0] - points[length - 1][0];\n    y = points[length - 2][1] - points[length - 1][1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n  context.moveTo(x1 + startOffsetX, y1 + startOffsetY);\n  for (var i = 1; i < length - 1; i++) {\n    var point = points[i];\n    context.lineTo(point[0], point[1]);\n  }\n  context.lineTo(x2 + endOffsetX, y2 + endOffsetY);\n}\n\nfunction generatePath(context, parsedStyle) {\n  var _parsedStyle$x = parsedStyle.x,\n    x = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n    _parsedStyle$y = parsedStyle.y,\n    y = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y,\n    radius = parsedStyle.radius,\n    width = parsedStyle.width,\n    height = parsedStyle.height;\n  var w = width;\n  var h = height;\n  var hasRadius = radius && radius.some(function (r) {\n    return r !== 0;\n  });\n  if (!hasRadius) {\n    // Canvas support negative width/height of rect\n    context.rect(x, y, w, h);\n  } else {\n    var signX = width > 0 ? 1 : -1;\n    var signY = height > 0 ? 1 : -1;\n    var sweepFlag = signX + signY === 0;\n    var _radius$map = radius.map(function (r) {\n        return clamp(r, 0, Math.min(Math.abs(w) / 2, Math.abs(h) / 2));\n      }),\n      _radius$map2 = _slicedToArray(_radius$map, 4),\n      tlr = _radius$map2[0],\n      trr = _radius$map2[1],\n      brr = _radius$map2[2],\n      blr = _radius$map2[3];\n    context.moveTo(signX * tlr + x, y);\n    context.lineTo(w - signX * trr + x, y);\n    if (trr !== 0) {\n      context.arc(w - signX * trr + x, signY * trr + y, trr, -signY * Math.PI / 2, signX > 0 ? 0 : Math.PI, sweepFlag);\n    }\n    context.lineTo(w + x, h - signY * brr + y);\n    if (brr !== 0) {\n      context.arc(w - signX * brr + x, h - signY * brr + y, brr, signX > 0 ? 0 : Math.PI, signY > 0 ? Math.PI / 2 : 1.5 * Math.PI, sweepFlag);\n    }\n    context.lineTo(signX * blr + x, h + y);\n    if (blr !== 0) {\n      context.arc(signX * blr + x, h - signY * blr + y, blr, signY > 0 ? Math.PI / 2 : -Math.PI / 2, signX > 0 ? Math.PI : 0, sweepFlag);\n    }\n    context.lineTo(x, signY * tlr + y);\n    if (tlr !== 0) {\n      context.arc(signX * tlr + x, signY * tlr + y, tlr, signX > 0 ? Math.PI : 0, signY > 0 ? Math.PI * 1.5 : Math.PI / 2, sweepFlag);\n    }\n  }\n}\n\nvar Plugin = /*#__PURE__*/function (_AbstractRendererPlug) {\n  function Plugin() {\n    var _this;\n    _classCallCheck(this, Plugin);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Plugin, [].concat(args));\n    _this.name = 'canvas-path-generator';\n    return _this;\n  }\n  _inherits(Plugin, _AbstractRendererPlug);\n  return _createClass(Plugin, [{\n    key: \"init\",\n    value: function init() {\n      var _pathGeneratorFactory;\n      var pathGeneratorFactory = (_pathGeneratorFactory = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_pathGeneratorFactory, Shape.CIRCLE, generatePath$6), Shape.ELLIPSE, generatePath$5), Shape.RECT, generatePath), Shape.LINE, generatePath$4), Shape.POLYLINE, generatePath$1), Shape.POLYGON, generatePath$2), Shape.PATH, generatePath$3), Shape.TEXT, undefined), Shape.GROUP, undefined), Shape.IMAGE, undefined), _defineProperty(_defineProperty(_pathGeneratorFactory, Shape.HTML, undefined), Shape.MESH, undefined));\n\n      // @ts-ignore\n      this.context.pathGeneratorFactory = pathGeneratorFactory;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      // @ts-ignore\n      delete this.context.pathGeneratorFactory;\n    }\n  }]);\n}(AbstractRendererPlugin);\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import * as glMatrix from \"./common.js\";\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\n * Math.round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec2} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\n * Get the angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\n * Alias for {@link vec2.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","import _typeof from \"./typeof.js\";\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  };\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nexport { _regeneratorRuntime as default };","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nexport { _toConsumableArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nexport { _arrayWithoutHoles as default };","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nexport { _iterableToArray as default };","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableSpread as default };","/*!\n * @antv/g-math\n * @description Geometry util\n * @version 3.0.0\n * @date 10/23/2024, 11:13:25 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport { isNumberEqual } from '@antv/util';\nimport { vec2 } from 'gl-matrix';\n\nfunction distance(x1, y1, x2, y2) {\n  var dx = x1 - x2;\n  var dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\nfunction getBBoxByArray(xArr, yArr) {\n  var minX = Math.min.apply(Math, _toConsumableArray(xArr));\n  var minY = Math.min.apply(Math, _toConsumableArray(yArr));\n  var maxX = Math.max.apply(Math, _toConsumableArray(xArr));\n  var maxY = Math.max.apply(Math, _toConsumableArray(yArr));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction piMod(angle) {\n  return (angle + Math.PI * 2) % (Math.PI * 2);\n}\n\nfunction copysign(v1, v2) {\n  var absv = Math.abs(v1);\n  return v2 > 0 ? absv : absv * -1;\n}\nfunction nearestPoint$4(x, y, rx, ry, x0, y0) {\n  var a = rx;\n  var b = ry;\n  // 假如椭圆半径为0则返回圆心\n  if (a === 0 || b === 0) {\n    return {\n      x: x,\n      y: y\n    };\n  }\n  // 转换成 0， 0 为中心的椭圆计算\n  var relativeX = x0 - x;\n  var relativeY = y0 - y;\n  var px = Math.abs(relativeX);\n  var py = Math.abs(relativeY);\n  var squareA = a * a;\n  var squareB = b * b;\n  // const angle0 = Math.atan2(relativeY, relativeX);\n  var t = Math.PI / 4;\n  var nearestX = 0; // 椭圆上的任一点\n  var nearestY = 0;\n  // 迭代 4 次\n  for (var i = 0; i < 4; i++) {\n    nearestX = a * Math.cos(t);\n    nearestY = b * Math.sin(t);\n    var ex = (squareA - squareB) * Math.pow(Math.cos(t), 3) / a;\n    var ey = (squareB - squareA) * Math.pow(Math.sin(t), 3) / b;\n    var rx1 = nearestX - ex;\n    var ry1 = nearestY - ey;\n    var qx = px - ex;\n    var qy = py - ey;\n    var r = Math.hypot(ry1, rx1);\n    var q = Math.hypot(qy, qx);\n    var delta_c = r * Math.asin((rx1 * qy - ry1 * qx) / (r * q));\n    var delta_t = delta_c / Math.sqrt(squareA + squareB - nearestX * nearestX - nearestY * nearestY);\n    t += delta_t;\n    t = Math.min(Math.PI / 2, Math.max(0, t));\n  }\n  return {\n    x: x + copysign(nearestX, relativeX),\n    y: y + copysign(nearestY, relativeY)\n  };\n}\n\n// 偏导数 x\nfunction derivativeXAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle) {\n  return -1 * rx * Math.cos(xRotation) * Math.sin(angle) - ry * Math.sin(xRotation) * Math.cos(angle);\n}\n\n// 偏导数 y\nfunction derivativeYAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle) {\n  return -1 * rx * Math.sin(xRotation) * Math.sin(angle) + ry * Math.cos(xRotation) * Math.cos(angle);\n}\n\n// x 的极值\nfunction xExtrema(rx, ry, xRotation) {\n  return Math.atan(-ry / rx * Math.tan(xRotation));\n}\n\n// y 的极值\nfunction yExtrema(rx, ry, xRotation) {\n  return Math.atan(ry / (rx * Math.tan(xRotation)));\n}\n\n// 根据角度求 x 坐标\nfunction xAt(cx, cy, rx, ry, xRotation, angle) {\n  return rx * Math.cos(xRotation) * Math.cos(angle) - ry * Math.sin(xRotation) * Math.sin(angle) + cx;\n}\n\n// 根据角度求 y 坐标\nfunction yAt(cx, cy, rx, ry, xRotation, angle) {\n  return rx * Math.sin(xRotation) * Math.cos(angle) + ry * Math.cos(xRotation) * Math.sin(angle) + cy;\n}\n\n// 获取点在椭圆上的角度\nfunction getAngle(rx, ry, x0, y0) {\n  var angle = Math.atan2(y0 * rx, x0 * ry);\n  // 转换到 0 - 2PI 内\n  return (angle + Math.PI * 2) % (Math.PI * 2);\n}\n\n// 根据角度获取，x,y\nfunction getPoint(rx, ry, angle) {\n  return {\n    x: rx * Math.cos(angle),\n    y: ry * Math.sin(angle)\n  };\n}\n\n// 旋转\nfunction rotate(x, y, angle) {\n  var cos = Math.cos(angle);\n  var sin = Math.sin(angle);\n  return [x * cos - y * sin, x * sin + y * cos];\n}\nfunction box$5(cx, cy, rx, ry, xRotation, startAngle, endAngle) {\n  var xDim = xExtrema(rx, ry, xRotation);\n  var minX = Infinity;\n  var maxX = -Infinity;\n  var xs = [startAngle, endAngle];\n  for (var i = -Math.PI * 2; i <= Math.PI * 2; i += Math.PI) {\n    var xAngle = xDim + i;\n    if (startAngle < endAngle) {\n      if (startAngle < xAngle && xAngle < endAngle) {\n        xs.push(xAngle);\n      }\n    } else if (endAngle < xAngle && xAngle < startAngle) {\n      xs.push(xAngle);\n    }\n  }\n  for (var _i = 0; _i < xs.length; _i++) {\n    var x = xAt(cx, cy, rx, ry, xRotation, xs[_i]);\n    if (x < minX) {\n      minX = x;\n    }\n    if (x > maxX) {\n      maxX = x;\n    }\n  }\n  var yDim = yExtrema(rx, ry, xRotation);\n  var minY = Infinity;\n  var maxY = -Infinity;\n  var ys = [startAngle, endAngle];\n  for (var _i2 = -Math.PI * 2; _i2 <= Math.PI * 2; _i2 += Math.PI) {\n    var yAngle = yDim + _i2;\n    if (startAngle < endAngle) {\n      if (startAngle < yAngle && yAngle < endAngle) {\n        ys.push(yAngle);\n      }\n    } else if (endAngle < yAngle && yAngle < startAngle) {\n      ys.push(yAngle);\n    }\n  }\n  for (var _i3 = 0; _i3 < ys.length; _i3++) {\n    var y = yAt(cx, cy, rx, ry, xRotation, ys[_i3]);\n    if (y < minY) {\n      minY = y;\n    }\n    if (y > maxY) {\n      maxY = y;\n    }\n  }\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction nearestPoint$3(cx, cy, rx, ry, xRotation, startAngle, endAngle, x0, y0) {\n  // 将最近距离问题转换成到椭圆中心 0,0 没有旋转的椭圆问题\n  var relativeVector = rotate(x0 - cx, y0 - cy, -xRotation);\n  var _relativeVector = _slicedToArray(relativeVector, 2),\n    x1 = _relativeVector[0],\n    y1 = _relativeVector[1];\n  // 计算点到椭圆的最近的点\n  var relativePoint = nearestPoint$4(0, 0, rx, ry, x1, y1);\n  // 获取点在椭圆上的角度\n  var angle = getAngle(rx, ry, relativePoint.x, relativePoint.y);\n  // 点没有在圆弧上\n  if (angle < startAngle) {\n    // 小于起始圆弧\n    relativePoint = getPoint(rx, ry, startAngle);\n  } else if (angle > endAngle) {\n    // 大于结束圆弧\n    relativePoint = getPoint(rx, ry, endAngle);\n  }\n  // 旋转到 xRotation 的角度\n  var vector = rotate(relativePoint.x, relativePoint.y, xRotation);\n  return {\n    x: vector[0] + cx,\n    y: vector[1] + cy\n  };\n}\nfunction tangentAngle$4(cx, cy, rx, ry, xRotation, startAngle, endAngle, t) {\n  var angle = (endAngle - startAngle) * t + startAngle;\n  var dx = derivativeXAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle);\n  var dy = derivativeYAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle);\n  return piMod(Math.atan2(dy, dx));\n}\n\nvar EPSILON = 0.0001;\n/**\n * 使用牛顿切割法求最近的点\n * @param {number[]} xArr      点的 x 数组\n * @param {number[]} yArr      点的 y 数组\n * @param {number}   x         指定的点 x\n * @param {number}   y         指定的点 y\n * @param {Function} tCallback 差值函数\n */\nfunction nearestPoint$2(xArr, yArr, x, y, tCallback, length) {\n  var t = -1;\n  var d = Infinity;\n  var v0 = [x, y];\n  var segNum = 20;\n  if (length && length > 200) {\n    segNum = length / 10;\n  }\n  var increaseRate = 1 / segNum;\n  var interval = increaseRate / 10;\n  for (var i = 0; i <= segNum; i++) {\n    var _t = i * increaseRate;\n    var v1 = [tCallback.apply(void 0, _toConsumableArray(xArr.concat([_t]))), tCallback.apply(void 0, _toConsumableArray(yArr.concat([_t])))];\n    var d1 = distance(v0[0], v0[1], v1[0], v1[1]);\n    if (d1 < d) {\n      t = _t;\n      d = d1;\n    }\n  }\n  // 提前终止\n  if (t === 0) {\n    return {\n      x: xArr[0],\n      y: yArr[0]\n    };\n  }\n  if (t === 1) {\n    var count = xArr.length;\n    return {\n      x: xArr[count - 1],\n      y: yArr[count - 1]\n    };\n  }\n  d = Infinity;\n  for (var _i = 0; _i < 32; _i++) {\n    if (interval < EPSILON) {\n      break;\n    }\n    var prev = t - interval;\n    var next = t + interval;\n    var _v = [tCallback.apply(void 0, _toConsumableArray(xArr.concat([prev]))), tCallback.apply(void 0, _toConsumableArray(yArr.concat([prev])))];\n    var _d = distance(v0[0], v0[1], _v[0], _v[1]);\n    if (prev >= 0 && _d < d) {\n      t = prev;\n      d = _d;\n    } else {\n      var v2 = [tCallback.apply(void 0, _toConsumableArray(xArr.concat([next]))), tCallback.apply(void 0, _toConsumableArray(yArr.concat([next])))];\n      var d2 = distance(v0[0], v0[1], v2[0], v2[1]);\n      if (next <= 1 && d2 < d) {\n        t = next;\n        d = d2;\n      } else {\n        interval *= 0.5;\n      }\n    }\n  }\n  return {\n    x: tCallback.apply(void 0, _toConsumableArray(xArr.concat([t]))),\n    y: tCallback.apply(void 0, _toConsumableArray(yArr.concat([t])))\n  };\n}\n\n// 近似求解 https://community.khronos.org/t/3d-cubic-bezier-segment-length/62363/2\nfunction snapLength(xArr, yArr) {\n  var totalLength = 0;\n  var count = xArr.length;\n  for (var i = 0; i < count; i++) {\n    var x = xArr[i];\n    var y = yArr[i];\n    var nextX = xArr[(i + 1) % count];\n    var nextY = yArr[(i + 1) % count];\n    totalLength += distance(x, y, nextX, nextY);\n  }\n  return totalLength / 2;\n}\n\nfunction box$4(x1, y1, x2, y2) {\n  return getBBoxByArray([x1, x2], [y1, y2]);\n}\nfunction length$4(x1, y1, x2, y2) {\n  return distance(x1, y1, x2, y2);\n}\nfunction pointAt$3(x1, y1, x2, y2, t) {\n  return {\n    x: (1 - t) * x1 + t * x2,\n    y: (1 - t) * y1 + t * y2\n  };\n}\nfunction pointDistance$4(x1, y1, x2, y2, x, y) {\n  // 投影距离 x1, y1 的向量，假设 p, p1, p2 三个点，投影点为 a\n  // p1a = p1p.p1p2/|p1p2| * (p1p 的单位向量)\n  var cross = (x2 - x1) * (x - x1) + (y2 - y1) * (y - y1);\n  if (cross < 0) {\n    return distance(x1, y1, x, y);\n  }\n  var lengthSquare = (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n  if (cross > lengthSquare) {\n    return distance(x2, y2, x, y);\n  }\n  return pointToLine(x1, y1, x2, y2, x, y);\n}\nfunction pointToLine(x1, y1, x2, y2, x, y) {\n  var d = [x2 - x1, y2 - y1];\n  // 如果端点相等，则判定点到点的距离\n  if (vec2.exactEquals(d, [0, 0])) {\n    return Math.sqrt((x - x1) * (x - x1) + (y - y1) * (y - y1));\n  }\n  var u = [-d[1], d[0]];\n  vec2.normalize(u, u);\n  var a = [x - x1, y - y1];\n  return Math.abs(vec2.dot(a, u));\n}\nfunction tangentAngle$3(x1, y1, x2, y2) {\n  return Math.atan2(y2 - y1, x2 - x1);\n}\n\nfunction cubicAt(p0, p1, p2, p3, t) {\n  var onet = 1 - t; // t * t * t 的性能大概是 Math.pow(t, 3) 的三倍\n  return onet * onet * onet * p0 + 3 * p1 * t * onet * onet + 3 * p2 * t * t * onet + p3 * t * t * t;\n}\nfunction derivativeAt(p0, p1, p2, p3, t) {\n  var onet = 1 - t;\n  return 3 * (onet * onet * (p1 - p0) + 2 * onet * t * (p2 - p1) + t * t * (p3 - p2));\n}\nfunction extrema$1(p0, p1, p2, p3) {\n  var a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3;\n  var b = 6 * p0 - 12 * p1 + 6 * p2;\n  var c = 3 * p1 - 3 * p0;\n  var extremas = [];\n  var t1;\n  var t2;\n  var discSqrt;\n  if (isNumberEqual(a, 0)) {\n    if (!isNumberEqual(b, 0)) {\n      t1 = -c / b;\n      if (t1 >= 0 && t1 <= 1) {\n        extremas.push(t1);\n      }\n    }\n  } else {\n    var disc = b * b - 4 * a * c;\n    if (isNumberEqual(disc, 0)) {\n      extremas.push(-b / (2 * a));\n    } else if (disc > 0) {\n      discSqrt = Math.sqrt(disc);\n      t1 = (-b + discSqrt) / (2 * a);\n      t2 = (-b - discSqrt) / (2 * a);\n      if (t1 >= 0 && t1 <= 1) {\n        extremas.push(t1);\n      }\n      if (t2 >= 0 && t2 <= 1) {\n        extremas.push(t2);\n      }\n    }\n  }\n  return extremas;\n}\n\n// 分割贝塞尔曲线\nfunction divideCubic(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n  // 划分点\n  var xt = cubicAt(x1, x2, x3, x4, t);\n  var yt = cubicAt(y1, y2, y3, y4, t);\n  // 计算两点之间的差值点\n  var c1 = pointAt$3(x1, y1, x2, y2, t);\n  var c2 = pointAt$3(x2, y2, x3, y3, t);\n  var c3 = pointAt$3(x3, y3, x4, y4, t);\n  var c12 = pointAt$3(c1.x, c1.y, c2.x, c2.y, t);\n  var c23 = pointAt$3(c2.x, c2.y, c3.x, c3.y, t);\n  return [[x1, y1, c1.x, c1.y, c12.x, c12.y, xt, yt], [xt, yt, c23.x, c23.y, c3.x, c3.y, x4, y4]];\n}\n\n// 使用迭代法取贝塞尔曲线的长度，二阶和三阶分开写，更清晰和便于调试\nfunction cubicLength(x1, y1, x2, y2, x3, y3, x4, y4, iterationCount) {\n  if (iterationCount === 0) {\n    return snapLength([x1, x2, x3, x4], [y1, y2, y3, y4]);\n  }\n  var cubics = divideCubic(x1, y1, x2, y2, x3, y3, x4, y4, 0.5);\n  var left = [].concat(_toConsumableArray(cubics[0]), [iterationCount - 1]);\n  var right = [].concat(_toConsumableArray(cubics[1]), [iterationCount - 1]);\n  return cubicLength.apply(void 0, _toConsumableArray(left)) + cubicLength.apply(void 0, _toConsumableArray(right));\n}\nfunction box$3(x1, y1, x2, y2, x3, y3, x4, y4) {\n  var xArr = [x1, x4];\n  var yArr = [y1, y4];\n  var xExtrema = extrema$1(x1, x2, x3, x4);\n  var yExtrema = extrema$1(y1, y2, y3, y4);\n  for (var i = 0; i < xExtrema.length; i++) {\n    xArr.push(cubicAt(x1, x2, x3, x4, xExtrema[i]));\n  }\n  for (var _i = 0; _i < yExtrema.length; _i++) {\n    yArr.push(cubicAt(y1, y2, y3, y4, yExtrema[_i]));\n  }\n  return getBBoxByArray(xArr, yArr);\n}\nfunction length$3(x1, y1, x2, y2, x3, y3, x4, y4) {\n  // 迭代三次，划分成 8 段求长度\n  return cubicLength(x1, y1, x2, y2, x3, y3, x4, y4, 3);\n}\nfunction nearestPoint$1(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length) {\n  return nearestPoint$2([x1, x2, x3, x4], [y1, y2, y3, y4], x0, y0, cubicAt, length);\n}\nfunction pointDistance$3(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length) {\n  var point = nearestPoint$1(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length);\n  return distance(point.x, point.y, x0, y0);\n}\nfunction pointAt$2(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n  return {\n    x: cubicAt(x1, x2, x3, x4, t),\n    y: cubicAt(y1, y2, y3, y4, t)\n  };\n}\nfunction tangentAngle$2(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n  var dx = derivativeAt(x1, x2, x3, x4, t);\n  var dy = derivativeAt(y1, y2, y3, y4, t);\n  return piMod(Math.atan2(dy, dx));\n}\n\nfunction analyzePoints(points) {\n  // 计算每段的长度和总的长度\n  var totalLength = 0;\n  var segments = [];\n  for (var i = 0; i < points.length - 1; i++) {\n    var from = points[i];\n    var to = points[i + 1];\n    var length = distance(from[0], from[1], to[0], to[1]);\n    var seg = {\n      from: from,\n      to: to,\n      length: length\n    };\n    segments.push(seg);\n    totalLength += length;\n  }\n  return {\n    segments: segments,\n    totalLength: totalLength\n  };\n}\nfunction lengthOfSegment(points) {\n  if (points.length < 2) {\n    return 0;\n  }\n  var totalLength = 0;\n  for (var i = 0; i < points.length - 1; i++) {\n    var from = points[i];\n    var to = points[i + 1];\n    totalLength += distance(from[0], from[1], to[0], to[1]);\n  }\n  return totalLength;\n}\n\n/**\n * 按照比例在数据片段中获取点\n * @param {array} points 点的集合\n * @param {number} t 百分比 0-1\n * @return {object} 点的坐标\n */\nfunction pointAtSegments(points, t) {\n  // 边界判断\n  if (t > 1 || t < 0 || points.length < 2) {\n    return null;\n  }\n  var _analyzePoints = analyzePoints(points),\n    segments = _analyzePoints.segments,\n    totalLength = _analyzePoints.totalLength;\n  // 多个点有可能重合\n  if (totalLength === 0) {\n    return {\n      x: points[0][0],\n      y: points[0][1]\n    };\n  }\n  // 计算比例\n  var startRatio = 0;\n  var point = null;\n  for (var i = 0; i < segments.length; i++) {\n    var seg = segments[i];\n    var from = seg.from,\n      to = seg.to;\n    var currentRatio = seg.length / totalLength;\n    if (t >= startRatio && t <= startRatio + currentRatio) {\n      var localRatio = (t - startRatio) / currentRatio;\n      point = pointAt$3(from[0], from[1], to[0], to[1], localRatio);\n      break;\n    }\n    startRatio += currentRatio;\n  }\n  return point;\n}\n\n/**\n * 按照比例在数据片段中获取切线的角度\n * @param {array} points 点的集合\n * @param {number} t 百分比 0-1\n */\nfunction angleAtSegments(points, t) {\n  // 边界判断\n  if (t > 1 || t < 0 || points.length < 2) {\n    return 0;\n  }\n  var _analyzePoints2 = analyzePoints(points),\n    segments = _analyzePoints2.segments,\n    totalLength = _analyzePoints2.totalLength;\n  // 计算比例\n  var startRatio = 0;\n  var angle = 0;\n  for (var i = 0; i < segments.length; i++) {\n    var seg = segments[i];\n    var from = seg.from,\n      to = seg.to;\n    var currentRatio = seg.length / totalLength;\n    if (t >= startRatio && t <= startRatio + currentRatio) {\n      angle = Math.atan2(to[1] - from[1], to[0] - from[0]);\n      break;\n    }\n    startRatio += currentRatio;\n  }\n  return angle;\n}\nfunction distanceAtSegment(points, x, y) {\n  var minDistance = Infinity;\n  for (var i = 0; i < points.length - 1; i++) {\n    var point = points[i];\n    var nextPoint = points[i + 1];\n    var _distance = pointDistance$4(point[0], point[1], nextPoint[0], nextPoint[1], x, y);\n    if (_distance < minDistance) {\n      minDistance = _distance;\n    }\n  }\n  return minDistance;\n}\n\nfunction box$2(points) {\n  var xArr = [];\n  var yArr = [];\n  for (var i = 0; i < points.length; i++) {\n    var point = points[i];\n    xArr.push(point[0]);\n    yArr.push(point[1]);\n  }\n  return getBBoxByArray(xArr, yArr);\n}\nfunction length$2(points) {\n  return lengthOfSegment(points);\n}\nfunction pointAt$1(points, t) {\n  return pointAtSegments(points, t);\n}\nfunction pointDistance$2(points, x, y) {\n  return distanceAtSegment(points, x, y);\n}\nfunction tangentAngle$1(points, t) {\n  return angleAtSegments(points, t);\n}\n\nfunction getAllPoints(points) {\n  var tmp = points.slice(0);\n  if (points.length) {\n    tmp.push(points[0]);\n  }\n  return tmp;\n}\nfunction box$1(points) {\n  return box$2(points);\n}\nfunction length$1(points) {\n  return lengthOfSegment(getAllPoints(points));\n}\nfunction pointAt(points, t) {\n  return pointAtSegments(getAllPoints(points), t);\n}\nfunction pointDistance$1(points, x, y) {\n  return distanceAtSegment(getAllPoints(points), x, y);\n}\nfunction tangentAngle(points, t) {\n  return angleAtSegments(getAllPoints(points), t);\n}\n\n// 差值公式\nfunction quadraticAt(p0, p1, p2, t) {\n  var onet = 1 - t;\n  return onet * onet * p0 + 2 * t * onet * p1 + t * t * p2;\n}\n\n// 求极值\nfunction extrema(p0, p1, p2) {\n  var a = p0 + p2 - 2 * p1;\n  if (isNumberEqual(a, 0)) {\n    return [0.5];\n  }\n  var rst = (p0 - p1) / a;\n  if (rst <= 1 && rst >= 0) {\n    return [rst];\n  }\n  return [];\n}\n\n// 分割贝塞尔曲线\nfunction divideQuadratic(x1, y1, x2, y2, x3, y3, t) {\n  // 划分点\n  var xt = quadraticAt(x1, x2, x3, t);\n  var yt = quadraticAt(y1, y2, y3, t);\n\n  // 分割的第一条曲线的控制点\n  var controlPoint1 = pointAt$3(x1, y1, x2, y2, t);\n  // 分割的第二条曲线的控制点\n  var controlPoint2 = pointAt$3(x2, y2, x3, y3, t);\n  return [[x1, y1, controlPoint1.x, controlPoint1.y, xt, yt], [xt, yt, controlPoint2.x, controlPoint2.y, x3, y3]];\n}\n\n// 使用迭代法取贝塞尔曲线的长度\nfunction quadraticLength(x1, y1, x2, y2, x3, y3, iterationCount) {\n  if (iterationCount === 0) {\n    return (distance(x1, y1, x2, y2) + distance(x2, y2, x3, y3) + distance(x1, y1, x3, y3)) / 2;\n  }\n  var quadratics = divideQuadratic(x1, y1, x2, y2, x3, y3, 0.5);\n  var left = quadratics[0];\n  var right = quadratics[1];\n  left.push(iterationCount - 1);\n  right.push(iterationCount - 1);\n  return quadraticLength.apply(void 0, _toConsumableArray(left)) + quadraticLength.apply(void 0, _toConsumableArray(right));\n}\nfunction box(x1, y1, x2, y2, x3, y3) {\n  var xExtrema = extrema(x1, x2, x3)[0];\n  var yExtrema = extrema(y1, y2, y3)[0];\n  // 控制点不加入 box 的计算\n  var xArr = [x1, x3];\n  var yArr = [y1, y3];\n  if (xExtrema !== undefined) {\n    xArr.push(quadraticAt(x1, x2, x3, xExtrema));\n  }\n  if (yExtrema !== undefined) {\n    yArr.push(quadraticAt(y1, y2, y3, yExtrema));\n  }\n  return getBBoxByArray(xArr, yArr);\n}\nfunction length(x1, y1, x2, y2, x3, y3) {\n  return quadraticLength(x1, y1, x2, y2, x3, y3, 3);\n}\nfunction nearestPoint(x1, y1, x2, y2, x3, y3, x0, y0) {\n  return nearestPoint$2([x1, x2, x3], [y1, y2, y3], x0, y0, quadraticAt);\n}\nfunction pointDistance(x1, y1, x2, y2, x3, y3, x0, y0) {\n  var point = nearestPoint(x1, y1, x2, y2, x3, y3, x0, y0);\n  return distance(point.x, point.y, x0, y0);\n}\n\nexport { box$5 as arcBox, nearestPoint$3 as arcNearestPoint, tangentAngle$4 as arcTangentAngle, box$3 as cubicBox, length$3 as cubicLength, nearestPoint$1 as cubicNearestPoint, pointAt$2 as cubicPointAt, pointDistance$3 as cubicPointDistance, tangentAngle$2 as cubicTangentAngle, distance, box$4 as lineBox, length$4 as lineLength, pointAt$3 as linePointAt, pointDistance$4 as linePointDistance, pointToLine as linePointToLine, tangentAngle$3 as lineTangentAngle, box$1 as polygonBox, length$1 as polygonLength, pointAt as polygonPointAt, pointDistance$1 as polygonPointDistance, tangentAngle as polygonTangentAngle, box$2 as polylineBox, length$2 as polylineLength, pointAt$1 as polylinePointAt, pointDistance$2 as polylinePointDistance, tangentAngle$1 as polylineTangentAngle, box as quadBox, length as quadLength, nearestPoint as quadNearestPoint, pointDistance as quadPointDistance };\n//# sourceMappingURL=index.esm.js.map\n","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nexport { _objectSpread2 as default };","/*!\n * @antv/g-plugin-canvas-picker\n * @description A G plugin for picking in canvas\n * @version 2.0.15\n * @date 10/23/2024, 11:16:32 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport { findClosestClipPathTarget, Point, isFillOrStrokeAffected, getOrCalculatePathTotalLength, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport _createForOfIteratorHelper from '@babel/runtime/helpers/createForOfIteratorHelper';\nimport _regeneratorRuntime from '@babel/runtime/helpers/regeneratorRuntime';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport { vec3, mat4 } from 'gl-matrix';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport { distance, linePointToLine, cubicPointDistance, quadPointDistance } from '@antv/g-math';\nimport { arcToCubic, clamp } from '@antv/util';\nimport _objectSpread from '@babel/runtime/helpers/objectSpread2';\n\nvar tmpVec3a = vec3.create();\nvar tmpVec3b = vec3.create();\nvar tmpVec3c = vec3.create();\nvar tmpMat4 = mat4.create();\n/**\n * pick shape(s) with Mouse/Touch event\n *\n * 1. find AABB with r-tree\n * 2. do math calculation with geometry in an accurate way\n */\nvar CanvasPickerPlugin = /*#__PURE__*/function () {\n  function CanvasPickerPlugin() {\n    var _this = this;\n    _classCallCheck(this, CanvasPickerPlugin);\n    this.isHit = function (displayObject, position, worldTransform, isClipPath) {\n      // use picker for current shape's type\n      var pick = _this.context.pointInPathPickerFactory[displayObject.nodeName];\n      if (pick) {\n        // invert with world matrix\n        var invertWorldMat = mat4.invert(tmpMat4, worldTransform);\n\n        // transform client position to local space, do picking in local space\n        var localPosition = vec3.transformMat4(tmpVec3b, vec3.set(tmpVec3c, position[0], position[1], 0), invertWorldMat);\n        if (pick(displayObject, new Point(localPosition[0], localPosition[1]), isClipPath, _this.isPointInPath, _this.context, _this.runtime)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    /**\n     * use native picking method\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/isPointInPath\n     */\n    this.isPointInPath = function (displayObject, position) {\n      var context = _this.runtime.offscreenCanvasCreator.getOrCreateContext(_this.context.config.offscreenCanvas);\n      var generatePath = _this.context.pathGeneratorFactory[displayObject.nodeName];\n      if (generatePath) {\n        context.beginPath();\n        generatePath(context, displayObject.parsedStyle);\n        context.closePath();\n      }\n      return context.isPointInPath(position.x, position.y);\n    };\n  }\n  return _createClass(CanvasPickerPlugin, [{\n    key: \"apply\",\n    value: function apply(context, runtime) {\n      var _renderingContext$roo,\n        _this2 = this;\n      var renderingService = context.renderingService,\n        renderingContext = context.renderingContext;\n      this.context = context;\n      this.runtime = runtime;\n      var document = (_renderingContext$roo = renderingContext.root) === null || _renderingContext$roo === void 0 ? void 0 : _renderingContext$roo.ownerDocument;\n      renderingService.hooks.pick.tapPromise(CanvasPickerPlugin.tag, /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(result) {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", _this2.pick(document, result));\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n      renderingService.hooks.pickSync.tap(CanvasPickerPlugin.tag, function (result) {\n        return _this2.pick(document, result);\n      });\n    }\n  }, {\n    key: \"pick\",\n    value: function pick(document, result) {\n      var topmost = result.topmost,\n        _result$position = result.position,\n        x = _result$position.x,\n        y = _result$position.y;\n\n      // position in world space\n      var position = vec3.set(tmpVec3a, x, y, 0);\n\n      // query by AABB first with spatial index(r-tree)\n      var hitTestList = document.elementsFromBBox(position[0], position[1], position[0], position[1]);\n\n      // test with clip path & origin shape\n      // @see https://github.com/antvis/g/issues/1064\n      var pickedDisplayObjects = [];\n      var _iterator = _createForOfIteratorHelper(hitTestList),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _displayObject = _step.value;\n          var worldTransform = _displayObject.getWorldTransform();\n          var isHitOriginShape = this.isHit(_displayObject, position, worldTransform, false);\n          if (isHitOriginShape) {\n            // should look up in the ancestor node\n            var clipped = findClosestClipPathTarget(_displayObject);\n            if (clipped) {\n              var _ref2 = clipped.parsedStyle,\n                clipPath = _ref2.clipPath;\n              var isHitClipPath = this.isHit(clipPath, position, clipPath.getWorldTransform(), true);\n              if (isHitClipPath) {\n                if (topmost) {\n                  result.picked = [_displayObject];\n                  return result;\n                }\n                pickedDisplayObjects.push(_displayObject);\n              }\n            } else {\n              if (topmost) {\n                result.picked = [_displayObject];\n                return result;\n              }\n              pickedDisplayObjects.push(_displayObject);\n            }\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      result.picked = pickedDisplayObjects;\n      return result;\n    }\n  }]);\n}();\nCanvasPickerPlugin.tag = 'CanvasPicker';\n\nfunction isPointInPath$8(displayObject, position, isClipPath) {\n  var _ref = displayObject.parsedStyle,\n    _ref$cx = _ref.cx,\n    cx = _ref$cx === void 0 ? 0 : _ref$cx,\n    _ref$cy = _ref.cy,\n    cy = _ref$cy === void 0 ? 0 : _ref$cy,\n    r = _ref.r,\n    fill = _ref.fill,\n    stroke = _ref.stroke,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents;\n  var halfLineWidth = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  var absDistance = distance(cx, cy, position.x, position.y);\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents, fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasFill = _isFillOrStrokeAffect2[0],\n    hasStroke = _isFillOrStrokeAffect2[1];\n  if (hasFill && hasStroke || isClipPath) {\n    return absDistance <= r + halfLineWidth;\n  }\n  if (hasFill) {\n    return absDistance <= r;\n  }\n  if (hasStroke) {\n    return absDistance >= r - halfLineWidth && absDistance <= r + halfLineWidth;\n  }\n  return false;\n}\n\nfunction ellipseDistance(squareX, squareY, rx, ry) {\n  return squareX / (rx * rx) + squareY / (ry * ry);\n}\nfunction isPointInPath$7(displayObject, position, isClipPath) {\n  var _ref = displayObject.parsedStyle,\n    _ref$cx = _ref.cx,\n    cx = _ref$cx === void 0 ? 0 : _ref$cx,\n    _ref$cy = _ref.cy,\n    cy = _ref$cy === void 0 ? 0 : _ref$cy,\n    rx = _ref.rx,\n    ry = _ref.ry,\n    fill = _ref.fill,\n    stroke = _ref.stroke,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents;\n  var x = position.x,\n    y = position.y;\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents, fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasFill = _isFillOrStrokeAffect2[0],\n    hasStroke = _isFillOrStrokeAffect2[1];\n  var halfLineWith = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  var squareX = (x - cx) * (x - cx);\n  var squareY = (y - cy) * (y - cy);\n  // 使用椭圆的公式： x*x/rx*rx + y*y/ry*ry = 1;\n  if (hasFill && hasStroke || isClipPath) {\n    return ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <= 1;\n  }\n  if (hasFill) {\n    return ellipseDistance(squareX, squareY, rx, ry) <= 1;\n  }\n  if (hasStroke) {\n    return ellipseDistance(squareX, squareY, rx - halfLineWith, ry - halfLineWith) >= 1 && ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <= 1;\n  }\n  return false;\n}\n\nfunction inBox(minX, minY, width, height, x, y) {\n  return x >= minX && x <= minX + width && y >= minY && y <= minY + height;\n}\nfunction inRect(minX, minY, width, height, lineWidth, x, y) {\n  var halfWidth = lineWidth / 2;\n  // 将四个边看做矩形来检测，比边的检测算法要快\n  return inBox(minX - halfWidth, minY - halfWidth, width, lineWidth, x, y) ||\n  // 上边\n  inBox(minX + width - halfWidth, minY - halfWidth, lineWidth, height, x, y) ||\n  // 右边\n  inBox(minX + halfWidth, minY + height - halfWidth, width, lineWidth, x, y) ||\n  // 下边\n  inBox(minX - halfWidth, minY + halfWidth, lineWidth, height, x, y); // 左边\n}\nfunction inArc(cx, cy, r, startAngle, endAngle, lineWidth, x, y) {\n  var angle = (Math.atan2(y - cy, x - cx) + Math.PI * 2) % (Math.PI * 2); // 转换到 0 - 2 * Math.PI 之间\n  // if (angle < startAngle || angle > endAngle) {\n  //   return false;\n  // }\n  var point = {\n    x: cx + r * Math.cos(angle),\n    y: cy + r * Math.sin(angle)\n  };\n  return distance(point.x, point.y, x, y) <= lineWidth / 2;\n}\nfunction inLine(x1, y1, x2, y2, lineWidth, x, y) {\n  var minX = Math.min(x1, x2);\n  var maxX = Math.max(x1, x2);\n  var minY = Math.min(y1, y2);\n  var maxY = Math.max(y1, y2);\n  var halfWidth = lineWidth / 2;\n  // 因为目前的方案是计算点到直线的距离，而有可能会在延长线上，所以要先判断是否在包围盒内\n  // 这种方案会在水平或者竖直的情况下载线的延长线上有半 lineWidth 的误差\n  if (!(x >= minX - halfWidth && x <= maxX + halfWidth && y >= minY - halfWidth && y <= maxY + halfWidth)) {\n    return false;\n  }\n  // 因为已经计算了包围盒，所以仅需要计算到直线的距离即可，可以显著提升性能\n  return linePointToLine(x1, y1, x2, y2, x, y) <= lineWidth / 2;\n}\nfunction inPolyline(points, lineWidth, x, y, isClose) {\n  var count = points.length;\n  if (count < 2) {\n    return false;\n  }\n  for (var i = 0; i < count - 1; i++) {\n    var x1 = points[i][0];\n    var y1 = points[i][1];\n    var x2 = points[i + 1][0];\n    var y2 = points[i + 1][1];\n    if (inLine(x1, y1, x2, y2, lineWidth, x, y)) {\n      return true;\n    }\n  }\n\n  // 如果封闭，则计算起始点和结束点的边\n  if (isClose) {\n    var first = points[0];\n    var last = points[count - 1];\n    if (inLine(first[0], first[1], last[0], last[1], lineWidth, x, y)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// 多边形的射线检测，参考：https://blog.csdn.net/WilliamSun0122/article/details/77994526\nvar tolerance = 1e-6;\n// 三态函数，判断两个double在eps精度下的大小关系\nfunction dcmp(x) {\n  if (Math.abs(x) < tolerance) {\n    return 0;\n  }\n  return x < 0 ? -1 : 1;\n}\n\n// 判断点Q是否在p1和p2的线段上\nfunction onSegment(p1, p2, q) {\n  if ((q[0] - p1[0]) * (p2[1] - p1[1]) === (p2[0] - p1[0]) * (q[1] - p1[1]) && Math.min(p1[0], p2[0]) <= q[0] && q[0] <= Math.max(p1[0], p2[0]) && Math.min(p1[1], p2[1]) <= q[1] && q[1] <= Math.max(p1[1], p2[1])) {\n    return true;\n  }\n  return false;\n}\n\n// 判断点P在多边形内-射线法\nfunction inPolygon(points, x, y) {\n  var isHit = false;\n  var n = points.length;\n  if (n <= 2) {\n    // svg 中点小于 3 个时，不显示，也无法被拾取\n    return false;\n  }\n  for (var i = 0; i < n; i++) {\n    var p1 = points[i];\n    var p2 = points[(i + 1) % n];\n    if (onSegment(p1, p2, [x, y])) {\n      // 点在多边形一条边上\n      return true;\n    }\n    // 前一个判断min(p1[1],p2[1])<P.y<=max(p1[1],p2[1])\n    // 后一个判断被测点 在 射线与边交点 的左边\n    if (dcmp(p1[1] - y) > 0 !== dcmp(p2[1] - y) > 0 && dcmp(x - (y - p1[1]) * (p1[0] - p2[0]) / (p1[1] - p2[1]) - p1[0]) < 0) {\n      isHit = !isHit;\n    }\n  }\n  return isHit;\n}\nfunction inPolygons(polygons, x, y) {\n  var isHit = false;\n  for (var i = 0; i < polygons.length; i++) {\n    var points = polygons[i];\n    isHit = inPolygon(points, x, y);\n    if (isHit) {\n      break;\n    }\n  }\n  return isHit;\n}\n\nfunction isPointInPath$6(displayObject, position, isClipPath) {\n  var _ref = displayObject.parsedStyle,\n    x1 = _ref.x1,\n    y1 = _ref.y1,\n    x2 = _ref.x2,\n    y2 = _ref.y2,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents,\n    fill = _ref.fill,\n    stroke = _ref.stroke;\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents, fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasStroke = _isFillOrStrokeAffect2[1];\n  if (!hasStroke && !isClipPath || !lineWidth) {\n    return false;\n  }\n  return inLine(x1, y1, x2, y2, lineWidth + increasedLineWidthForHitTesting, position.x, position.y);\n}\n\n// TODO: replace it with method in @antv/util\nfunction isPointInStroke(segments, lineWidth, px, py, length) {\n  var isHit = false;\n  var halfWidth = lineWidth / 2;\n  for (var i = 0; i < segments.length; i++) {\n    var segment = segments[i];\n    var currentPoint = segment.currentPoint,\n      params = segment.params,\n      prePoint = segment.prePoint,\n      box = segment.box;\n    // 如果在前面已经生成过包围盒，直接按照包围盒计算\n    if (box && !inBox(box.x - halfWidth, box.y - halfWidth, box.width + lineWidth, box.height + lineWidth, px, py)) {\n      continue;\n    }\n    switch (segment.command) {\n      // L 和 Z 都是直线， M 不进行拾取\n      case 'L':\n      case 'Z':\n        isHit = inLine(prePoint[0], prePoint[1], currentPoint[0], currentPoint[1], lineWidth, px, py);\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'Q':\n        var qDistance = quadPointDistance(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4], px, py);\n        isHit = qDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'C':\n        var cDistance = cubicPointDistance(prePoint[0],\n        // 上一段结束位置, 即 C 的起始点\n        prePoint[1], params[1],\n        // 'C' 的参数，1、2 为第一个控制点，3、4 为第二个控制点，5、6 为结束点\n        params[2], params[3], params[4], params[5], params[6], px, py, length);\n        isHit = cDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'A':\n        // cache conversion result\n        if (!segment.cubicParams) {\n          segment.cubicParams = arcToCubic(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4], params[5], params[6], params[7], undefined);\n        }\n        var args = segment.cubicParams;\n\n        // fixArc\n        var prePointInCubic = prePoint;\n        for (var _i = 0; _i < args.length; _i += 6) {\n          var _cDistance = cubicPointDistance(prePointInCubic[0],\n          // 上一段结束位置, 即 C 的起始点\n          prePointInCubic[1], args[_i], args[_i + 1], args[_i + 2], args[_i + 3], args[_i + 4], args[_i + 5], px, py, length);\n          prePointInCubic = [args[_i + 4], args[_i + 5]];\n          isHit = _cDistance <= lineWidth / 2;\n          if (isHit) {\n            return true;\n          }\n        }\n        break;\n    }\n  }\n  return isHit;\n}\nfunction isPointInPath$5(displayObject, position, isClipPath, isPointInPath, renderingPluginContext, runtime) {\n  var _ref = displayObject.parsedStyle,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    stroke = _ref.stroke,\n    fill = _ref.fill,\n    d = _ref.d,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents;\n  var segments = d.segments,\n    hasArc = d.hasArc,\n    polylines = d.polylines,\n    polygons = d.polygons;\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents,\n    // Only a closed path can be filled.\n    (polygons === null || polygons === void 0 ? void 0 : polygons.length) && fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasFill = _isFillOrStrokeAffect2[0],\n    hasStroke = _isFillOrStrokeAffect2[1];\n  var totalLength = getOrCalculatePathTotalLength(displayObject);\n  var isHit = false;\n  if (hasFill || isClipPath) {\n    if (hasArc) {\n      // 存在曲线时，暂时使用 canvas 的 api 计算，后续可以进行多边形切割\n      isHit = isPointInPath(displayObject, position);\n    } else {\n      // 提取出来的多边形包含闭合的和非闭合的，在这里统一按照多边形处理\n      isHit = inPolygons(polygons, position.x, position.y) || inPolygons(polylines, position.x, position.y);\n    }\n    return isHit;\n  }\n  if (hasStroke || isClipPath) {\n    isHit = isPointInStroke(segments, lineWidth + increasedLineWidthForHitTesting, position.x, position.y, totalLength);\n  }\n  return isHit;\n}\n\nfunction isPointInPath$4(displayObject, position, isClipPath) {\n  var _ref = displayObject.parsedStyle,\n    stroke = _ref.stroke,\n    fill = _ref.fill,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    points = _ref.points,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents;\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents, fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasFill = _isFillOrStrokeAffect2[0],\n    hasStroke = _isFillOrStrokeAffect2[1];\n  var isHit = false;\n  if (hasStroke || isClipPath) {\n    isHit = inPolyline(points.points, lineWidth + increasedLineWidthForHitTesting, position.x, position.y, true);\n  }\n  if (!isHit && (hasFill || isClipPath)) {\n    isHit = inPolygon(points.points, position.x, position.y);\n  }\n  return isHit;\n}\n\nfunction isPointInPath$3(displayObject, position, isClipPath) {\n  var _ref = displayObject.parsedStyle,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    points = _ref.points,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents,\n    fill = _ref.fill,\n    stroke = _ref.stroke;\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents, fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasStroke = _isFillOrStrokeAffect2[1];\n  if (!hasStroke && !isClipPath || !lineWidth) {\n    return false;\n  }\n  return inPolyline(points.points, lineWidth + increasedLineWidthForHitTesting, position.x, position.y, false);\n}\n\nfunction isPointInPath$2(displayObject, position, isClipPath, isPointInPath, runtime) {\n  var _ref = displayObject.parsedStyle,\n    radius = _ref.radius,\n    fill = _ref.fill,\n    stroke = _ref.stroke,\n    _ref$lineWidth = _ref.lineWidth,\n    lineWidth = _ref$lineWidth === void 0 ? 1 : _ref$lineWidth,\n    _ref$increasedLineWid = _ref.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _ref$increasedLineWid === void 0 ? 0 : _ref$increasedLineWid,\n    _ref$x = _ref.x,\n    x = _ref$x === void 0 ? 0 : _ref$x,\n    _ref$y = _ref.y,\n    y = _ref$y === void 0 ? 0 : _ref$y,\n    width = _ref.width,\n    height = _ref.height,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents;\n  var _isFillOrStrokeAffect = isFillOrStrokeAffected(pointerEvents, fill, stroke),\n    _isFillOrStrokeAffect2 = _slicedToArray(_isFillOrStrokeAffect, 2),\n    hasFill = _isFillOrStrokeAffect2[0],\n    hasStroke = _isFillOrStrokeAffect2[1];\n  var hasRadius = radius && radius.some(function (r) {\n    return r !== 0;\n  });\n  var lineWidthForHitTesting = lineWidth + increasedLineWidthForHitTesting;\n\n  // 无圆角时的策略\n  if (!hasRadius) {\n    var halfWidth = lineWidthForHitTesting / 2;\n    // 同时填充和带有边框\n    if (hasFill && hasStroke || isClipPath) {\n      return inBox(x - halfWidth, y - halfWidth, width + halfWidth, height + halfWidth, position.x, position.y);\n    }\n    // 仅填充\n    if (hasFill) {\n      return inBox(x, y, width, height, position.x, position.y);\n    }\n    if (hasStroke) {\n      return inRect(x, y, width, height, lineWidthForHitTesting, position.x, position.y);\n    }\n  } else {\n    var isHit = false;\n    if (hasStroke || isClipPath) {\n      isHit = inRectWithRadius(x, y, width, height, radius.map(function (r) {\n        return clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2));\n      }), lineWidthForHitTesting, position.x, position.y);\n    }\n    // 仅填充时带有圆角的矩形直接通过图形拾取\n    // 以后可以改成纯数学的近似拾取，将圆弧切割成多边形\n    if (!isHit && (hasFill || isClipPath)) {\n      isHit = isPointInPath(displayObject, position);\n    }\n    return isHit;\n  }\n  return false;\n}\nfunction inRectWithRadius(minX, minY, width, height, radiusArray, lineWidth, x, y) {\n  var _radiusArray = _slicedToArray(radiusArray, 4),\n    tlr = _radiusArray[0],\n    trr = _radiusArray[1],\n    brr = _radiusArray[2],\n    blr = _radiusArray[3];\n  return inLine(minX + tlr, minY, minX + width - trr, minY, lineWidth, x, y) || inLine(minX + width, minY + trr, minX + width, minY + height - brr, lineWidth, x, y) || inLine(minX + width - brr, minY + height, minX + blr, minY + height, lineWidth, x, y) || inLine(minX, minY + height - blr, minX, minY + tlr, lineWidth, x, y) || inArc(minX + width - trr, minY + trr, trr, 1.5 * Math.PI, 2 * Math.PI, lineWidth, x, y) || inArc(minX + width - brr, minY + height - brr, brr, 0, 0.5 * Math.PI, lineWidth, x, y) || inArc(minX + blr, minY + height - blr, blr, 0.5 * Math.PI, Math.PI, lineWidth, x, y) || inArc(minX + tlr, minY + tlr, tlr, Math.PI, 1.5 * Math.PI, lineWidth, x, y);\n}\n\nfunction isPointInPath$1(displayObject, position, isClipPath, isPointInPath, renderingPluginContext, runtime) {\n  var _ref = displayObject.parsedStyle,\n    _ref$pointerEvents = _ref.pointerEvents,\n    pointerEvents = _ref$pointerEvents === void 0 ? 'auto' : _ref$pointerEvents,\n    _ref$x = _ref.x,\n    x = _ref$x === void 0 ? 0 : _ref$x,\n    _ref$y = _ref.y,\n    y = _ref$y === void 0 ? 0 : _ref$y,\n    width = _ref.width,\n    height = _ref.height;\n  if (pointerEvents === 'non-transparent-pixel') {\n    var offscreenCanvas = renderingPluginContext.config.offscreenCanvas;\n    var canvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n    var context = runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas, {\n      willReadFrequently: true\n    });\n    canvas.width = width;\n    canvas.height = height;\n    renderingPluginContext.defaultStyleRendererFactory[Shape.IMAGE].render(context, _objectSpread(_objectSpread({}, displayObject.parsedStyle), {}, {\n      x: 0,\n      y: 0\n    }), displayObject, undefined, undefined, undefined);\n    var imagedata = context.getImageData(position.x - x, position.y - y, 1, 1).data;\n    return imagedata.every(function (component) {\n      return component !== 0;\n    });\n  }\n  return true;\n}\n\nfunction isPointInPath(displayObject, position, isClipPath, isPointInPath) {\n  var bounds = displayObject.getGeometryBounds();\n\n  // @see https://stackoverflow.com/questions/28706989/how-do-i-check-if-a-mouse-click-is-inside-a-rotated-text-on-the-html5-canvas-in\n  return position.x >= bounds.min[0] && position.y >= bounds.min[1] && position.x <= bounds.max[0] && position.y <= bounds.max[1];\n}\n\nvar Plugin = /*#__PURE__*/function (_AbstractRendererPlug) {\n  function Plugin() {\n    var _this;\n    _classCallCheck(this, Plugin);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Plugin, [].concat(args));\n    _this.name = 'canvas-picker';\n    return _this;\n  }\n  _inherits(Plugin, _AbstractRendererPlug);\n  return _createClass(Plugin, [{\n    key: \"init\",\n    value: function init() {\n      var _pointInPathPickerFac;\n      var pointInPathPickerFactory = (_pointInPathPickerFac = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_pointInPathPickerFac, Shape.CIRCLE, isPointInPath$8), Shape.ELLIPSE, isPointInPath$7), Shape.RECT, isPointInPath$2), Shape.LINE, isPointInPath$6), Shape.POLYLINE, isPointInPath$3), Shape.POLYGON, isPointInPath$4), Shape.PATH, isPointInPath$5), Shape.TEXT, isPointInPath), Shape.GROUP, null), Shape.IMAGE, isPointInPath$1), _defineProperty(_defineProperty(_pointInPathPickerFac, Shape.HTML, null), Shape.MESH, null));\n\n      // @ts-ignore\n      this.context.pointInPathPickerFactory = pointInPathPickerFactory;\n      this.addRenderingPlugin(new CanvasPickerPlugin());\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      // @ts-ignore\n      delete this.context.pointInPathPickerFactory;\n      this.removeAllRenderingPlugins();\n    }\n  }]);\n}(AbstractRendererPlugin);\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nfunction _createForOfIteratorHelper(r, e) {\n  var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (!t) {\n    if (Array.isArray(r) || (t = unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) {\n      t && (r = t);\n      var _n = 0,\n        F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          return _n >= r.length ? {\n            done: !0\n          } : {\n            done: !1,\n            value: r[_n++]\n          };\n        },\n        e: function e(r) {\n          throw r;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var o,\n    a = !0,\n    u = !1;\n  return {\n    s: function s() {\n      t = t.call(r);\n    },\n    n: function n() {\n      var r = t.next();\n      return a = r.done, r;\n    },\n    e: function e(r) {\n      u = !0, o = r;\n    },\n    f: function f() {\n      try {\n        a || null == t[\"return\"] || t[\"return\"]();\n      } finally {\n        if (u) throw o;\n      }\n    }\n  };\n}\nexport { _createForOfIteratorHelper as default };","function _classPrivateFieldBase(e, t) {\n  if (!{}.hasOwnProperty.call(e, t)) throw new TypeError(\"attempted to use private field on non-instance\");\n  return e;\n}\nexport { _classPrivateFieldBase as default };","var id = 0;\nfunction _classPrivateFieldKey(e) {\n  return \"__private_\" + id++ + \"_\" + e;\n}\nexport { _classPrivateFieldKey as default };","/*!\n * @antv/g-plugin-image-loader\n * @description A G plugin for loading image\n * @version 2.0.13\n * @date 10/23/2024, 11:14:57 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport { OffscreenCanvasCreator, isBrowser, parsedTransformToMat4, parseTransform, DisplayObject, GradientType, computeLinearGradient, computeRadialGradient, UnitType, ElementEvent, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport _regeneratorRuntime from '@babel/runtime/helpers/regeneratorRuntime';\nimport _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport { isString } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport _classPrivateFieldLooseBase from '@babel/runtime/helpers/classPrivateFieldLooseBase';\nimport _classPrivateFieldLooseKey from '@babel/runtime/helpers/classPrivateFieldLooseKey';\n\nvar _cacheStore = /*#__PURE__*/_classPrivateFieldLooseKey(\"cacheStore\");\nvar RefCountCache = /*#__PURE__*/function () {\n  function RefCountCache() {\n    _classCallCheck(this, RefCountCache);\n    Object.defineProperty(this, _cacheStore, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  return _createClass(RefCountCache, [{\n    key: \"has\",\n    value: function has(key) {\n      return _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].has(key);\n    }\n  }, {\n    key: \"put\",\n    value: function put(key, item, ref) {\n      if (_classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].has(key)) {\n        return false;\n      }\n      _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].set(key, {\n        value: item,\n        counter: new Set([ref])\n      });\n      return true;\n    }\n  }, {\n    key: \"get\",\n    value: function get(key, ref) {\n      var cacheItem = _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].get(key);\n      if (!cacheItem) {\n        return null;\n      }\n      cacheItem.counter.add(ref);\n      return cacheItem.value;\n    }\n  }, {\n    key: \"update\",\n    value: function update(key, value, ref) {\n      var cacheItem = _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].get(key);\n      if (!cacheItem) {\n        return false;\n      }\n      cacheItem.value = _objectSpread(_objectSpread({}, cacheItem.value), value);\n      cacheItem.counter.add(ref);\n      return true;\n    }\n  }, {\n    key: \"release\",\n    value: function release(key, ref) {\n      var cacheItem = _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].get(key);\n      if (!cacheItem) {\n        return false;\n      }\n      cacheItem.counter[\"delete\"](ref);\n      if (cacheItem.counter.size <= 0) {\n        _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore][\"delete\"](key);\n      }\n      return true;\n    }\n  }, {\n    key: \"releaseRef\",\n    value: function releaseRef(ref) {\n      var _this = this;\n      _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].keys().forEach(function (key) {\n        _this.release(key, ref);\n      });\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize() {\n      return _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].size;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      _classPrivateFieldLooseBase(this, _cacheStore)[_cacheStore].clear();\n    }\n  }]);\n}();\n\nvar tasks = [];\nvar nextFrameTasks = [];\nvar ImageSlicer = /*#__PURE__*/function () {\n  function ImageSlicer() {\n    _classCallCheck(this, ImageSlicer);\n  }\n  return _createClass(ImageSlicer, null, [{\n    key: \"stop\",\n    value: function stop() {\n      var api = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ImageSlicer.api;\n      if (ImageSlicer.rafId) {\n        api.cancelAnimationFrame(ImageSlicer.rafId);\n        ImageSlicer.rafId = null;\n      }\n    }\n  }, {\n    key: \"executeTask\",\n    value: function executeTask() {\n      var api = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ImageSlicer.api;\n      if (tasks.length <= 0 && nextFrameTasks.length <= 0) {\n        return;\n      }\n      nextFrameTasks.forEach(function (task) {\n        return task();\n      });\n      nextFrameTasks = tasks.splice(0, ImageSlicer.TASK_NUM_PER_FRAME);\n      ImageSlicer.rafId = api.requestAnimationFrame(function () {\n        ImageSlicer.executeTask(api);\n      });\n    }\n  }, {\n    key: \"sliceImage\",\n    value: function sliceImage(image, sliceWidth, sliceHeight) {\n      var overlap = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var api = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : ImageSlicer.api;\n      var imageWidth = image.naturalWidth || image.width;\n      var imageHeight = image.naturalHeight || image.height;\n\n      // 计算步长(考虑重叠区域)\n      var strideW = sliceWidth - overlap;\n      var strideH = sliceHeight - overlap;\n\n      // 计算网格尺寸\n      var gridCols = Math.ceil(imageWidth / strideW);\n      var gridRows = Math.ceil(imageHeight / strideH);\n      var result = {\n        tileSize: [sliceWidth, sliceHeight],\n        gridSize: [gridRows, gridCols],\n        tiles: Array(gridRows).fill(null).map(function () {\n          return Array(gridCols).fill(null);\n        })\n      };\n\n      // 遍历网格创建切片\n      var _loop = function _loop(row) {\n        var _loop2 = function _loop2(col) {\n          tasks.push(function () {\n            // 计算当前切片的坐标\n            var startX = col * strideW;\n            var startY = row * strideH;\n\n            // 处理最后一列/行的特殊情况\n            var _ref = [Math.min(sliceWidth, imageWidth - startX), Math.min(sliceHeight, imageHeight - startY)],\n              tempSliceWidth = _ref[0],\n              tempSliceHeight = _ref[1];\n\n            // 创建切片canvas\n            var sliceCanvas = api.createCanvas();\n            sliceCanvas.width = sliceWidth;\n            sliceCanvas.height = sliceHeight;\n            var sliceCtx = sliceCanvas.getContext('2d');\n\n            // 将图像部分绘制到切片canvas上\n            sliceCtx.drawImage(image, startX, startY, tempSliceWidth, tempSliceHeight, 0, 0, tempSliceWidth, tempSliceHeight);\n\n            // 存储切片信息\n            result.tiles[row][col] = {\n              x: startX,\n              y: startY,\n              tileX: col,\n              tileY: row,\n              data: sliceCanvas\n            };\n          });\n        };\n        for (var col = 0; col < gridCols; col++) {\n          _loop2(col);\n        }\n      };\n      for (var row = 0; row < gridRows; row++) {\n        _loop(row);\n      }\n      ImageSlicer.stop();\n      ImageSlicer.executeTask();\n      return result;\n    }\n  }]);\n}();\nImageSlicer.TASK_NUM_PER_FRAME = 10;\n\nvar IMAGE_CACHE = new RefCountCache();\nvar ImagePool = /*#__PURE__*/function () {\n  function ImagePool(context, runtime) {\n    _classCallCheck(this, ImagePool);\n    this.imageCache = {};\n    this.gradientCache = {};\n    this.patternCache = {};\n    this.context = context;\n    this.runtime = runtime;\n  }\n  return _createClass(ImagePool, [{\n    key: \"getImageSync\",\n    value: function getImageSync(src, ref, callback) {\n      var imageSource = isString(src) ? src : src.src;\n      if (IMAGE_CACHE.has(imageSource)) {\n        var imageCache = IMAGE_CACHE.get(imageSource, ref);\n        if (imageCache.img.complete) {\n          callback === null || callback === void 0 || callback(imageCache);\n          return imageCache;\n        }\n      }\n      this.getOrCreateImage(src, ref).then(function (cache) {\n        callback === null || callback === void 0 || callback(cache);\n      })[\"catch\"](function () {\n        //\n      });\n      return null;\n    }\n  }, {\n    key: \"getOrCreateImage\",\n    value: function getOrCreateImage(src, ref) {\n      var imageSource = isString(src) ? src : src.src;\n      if (!isString(src) && !IMAGE_CACHE.has(imageSource)) {\n        var imageCache = {\n          img: src,\n          size: [src.naturalWidth || src.width, src.naturalHeight || src.height],\n          tileSize: calculateImageTileSize(src)\n        };\n        IMAGE_CACHE.put(imageSource, imageCache, ref);\n      }\n      if (IMAGE_CACHE.has(imageSource)) {\n        var _imageCache = IMAGE_CACHE.get(imageSource, ref);\n        if (_imageCache.img.complete) {\n          return Promise.resolve(_imageCache);\n        }\n        return new Promise(function (resolve, reject) {\n          _imageCache.img.addEventListener('load', function () {\n            _imageCache.tileSize = calculateImageTileSize(_imageCache.img);\n            resolve(_imageCache);\n          });\n          _imageCache.img.addEventListener('error', function (ev) {\n            reject(ev);\n          });\n        });\n      }\n\n      // @see https://github.com/antvis/g/issues/938\n      var createImage = this.context.config.createImage;\n      return new Promise(function (resolve, reject) {\n        var image;\n        if (createImage) {\n          image = createImage(imageSource);\n        } else if (isBrowser) {\n          image = new window.Image();\n        }\n        if (image) {\n          var _imageCache2 = {\n            img: image,\n            size: [0, 0],\n            tileSize: calculateImageTileSize(image)\n          };\n          IMAGE_CACHE.put(imageSource, _imageCache2, ref);\n          image.onload = function () {\n            _imageCache2.size = [image.naturalWidth || image.width, image.naturalHeight || image.height];\n            _imageCache2.tileSize = calculateImageTileSize(_imageCache2.img);\n            resolve(_imageCache2);\n          };\n          image.onerror = function (ev) {\n            reject(ev);\n          };\n          image.crossOrigin = 'Anonymous';\n          image.src = imageSource;\n        }\n      });\n    }\n  }, {\n    key: \"createDownSampledImage\",\n    value: function () {\n      var _createDownSampledImage = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(src, ref) {\n        var imageCache, enableLargeImageOptimization, _ref, _ref$maxDownSampledIm, maxDownSampledImageSize, _ref$downSamplingRate, downSamplingRateThreshold, createImageBitmapFunc, _imageCache$size, originWidth, originHeight, resizedImage, downSamplingRate, updateCache;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this.getOrCreateImage(src, ref);\n            case 2:\n              imageCache = _context.sent;\n              if (!(typeof imageCache.downSamplingRate !== 'undefined')) {\n                _context.next = 5;\n                break;\n              }\n              return _context.abrupt(\"return\", imageCache);\n            case 5:\n              enableLargeImageOptimization = this.context.config.enableLargeImageOptimization;\n              _ref = typeof enableLargeImageOptimization === 'boolean' ? {} : enableLargeImageOptimization, _ref$maxDownSampledIm = _ref.maxDownSampledImageSize, maxDownSampledImageSize = _ref$maxDownSampledIm === void 0 ? 2048 : _ref$maxDownSampledIm, _ref$downSamplingRate = _ref.downSamplingRateThreshold, downSamplingRateThreshold = _ref$downSamplingRate === void 0 ? 0.5 : _ref$downSamplingRate;\n              createImageBitmapFunc = this.runtime.globalThis.createImageBitmap;\n              _imageCache$size = _slicedToArray(imageCache.size, 2), originWidth = _imageCache$size[0], originHeight = _imageCache$size[1];\n              resizedImage = imageCache.img;\n              downSamplingRate = Math.min((maxDownSampledImageSize + maxDownSampledImageSize) / (originWidth + originHeight), Math.max(0.01, Math.min(downSamplingRateThreshold, 0.5)));\n              updateCache = _objectSpread(_objectSpread({}, imageCache), {}, {\n                downSamplingRate: downSamplingRate\n              });\n              IMAGE_CACHE.update(imageCache.img.src, updateCache, ref);\n              if (!createImageBitmapFunc) {\n                _context.next = 25;\n                break;\n              }\n              _context.prev = 14;\n              _context.next = 17;\n              return createImageBitmapFunc(imageCache.img, {\n                resizeWidth: originWidth * downSamplingRate,\n                resizeHeight: originHeight * downSamplingRate\n              });\n            case 17:\n              resizedImage = _context.sent;\n              _context.next = 23;\n              break;\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](14);\n              downSamplingRate = 1;\n            case 23:\n              _context.next = 26;\n              break;\n            case 25:\n              downSamplingRate = 1;\n            case 26:\n              updateCache = _objectSpread(_objectSpread({}, this.getImageSync(src, ref)), {}, {\n                downSampled: resizedImage,\n                downSamplingRate: downSamplingRate\n              });\n              IMAGE_CACHE.update(imageCache.img.src, updateCache, ref);\n              return _context.abrupt(\"return\", updateCache);\n            case 29:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[14, 20]]);\n      }));\n      function createDownSampledImage(_x, _x2) {\n        return _createDownSampledImage.apply(this, arguments);\n      }\n      return createDownSampledImage;\n    }()\n  }, {\n    key: \"createImageTiles\",\n    value: function () {\n      var _createImageTiles = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(src, tiles, ref) {\n        var imageCache, _ref$ownerDocument$de, requestAnimationFrame, cancelAnimationFrame, updateCache;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this.getOrCreateImage(src, ref);\n            case 2:\n              imageCache = _context2.sent;\n              _ref$ownerDocument$de = ref.ownerDocument.defaultView, requestAnimationFrame = _ref$ownerDocument$de.requestAnimationFrame, cancelAnimationFrame = _ref$ownerDocument$de.cancelAnimationFrame;\n              ImageSlicer.api = {\n                requestAnimationFrame: requestAnimationFrame,\n                cancelAnimationFrame: cancelAnimationFrame,\n                createCanvas: function createCanvas() {\n                  return OffscreenCanvasCreator.createCanvas();\n                }\n              };\n              updateCache = _objectSpread(_objectSpread({}, imageCache), ImageSlicer.sliceImage(imageCache.img, imageCache.tileSize[0], imageCache.tileSize[0]));\n              IMAGE_CACHE.update(imageCache.img.src, updateCache, ref);\n              return _context2.abrupt(\"return\", updateCache);\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function createImageTiles(_x3, _x4, _x5) {\n        return _createImageTiles.apply(this, arguments);\n      }\n      return createImageTiles;\n    }()\n  }, {\n    key: \"releaseImage\",\n    value: function releaseImage(src, ref) {\n      IMAGE_CACHE.release(isString(src) ? src : src.src, ref);\n    }\n  }, {\n    key: \"releaseImageRef\",\n    value: function releaseImageRef(ref) {\n      IMAGE_CACHE.releaseRef(ref);\n    }\n  }, {\n    key: \"getOrCreatePatternSync\",\n    value: function getOrCreatePatternSync(object, pattern, context, $offscreenCanvas, dpr, min, callback) {\n      var patternKey = this.generatePatternKey(pattern);\n      if (patternKey && this.patternCache[patternKey]) {\n        return this.patternCache[patternKey];\n      }\n      var image = pattern.image,\n        repetition = pattern.repetition,\n        transform = pattern.transform;\n      var src;\n      var needScaleWithDPR = false;\n      // Image URL\n      if (isString(image)) {\n        var imageCache = this.getImageSync(image, object, callback);\n        src = imageCache === null || imageCache === void 0 ? void 0 : imageCache.img;\n      } else if ($offscreenCanvas) {\n        src = $offscreenCanvas;\n        needScaleWithDPR = true;\n      } else {\n        src = image;\n      }\n\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createPattern\n      var canvasPattern = src && context.createPattern(src, repetition);\n      if (canvasPattern) {\n        var mat;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasPattern/setTransform\n        if (transform) {\n          mat = parsedTransformToMat4(parseTransform(transform), new DisplayObject({}));\n        } else {\n          mat = mat4.identity(mat4.create());\n        }\n        if (needScaleWithDPR) {\n          mat4.scale(mat, mat, [1 / dpr, 1 / dpr, 1]);\n        }\n        canvasPattern.setTransform({\n          a: mat[0],\n          b: mat[1],\n          c: mat[4],\n          d: mat[5],\n          e: mat[12] + min[0],\n          f: mat[13] + min[1]\n        });\n      }\n      if (patternKey && canvasPattern) {\n        this.patternCache[patternKey] = canvasPattern;\n      }\n      return canvasPattern;\n    }\n  }, {\n    key: \"getOrCreateGradient\",\n    value: function getOrCreateGradient(params, context) {\n      var key = this.generateGradientKey(params);\n      var type = params.type,\n        steps = params.steps,\n        min = params.min,\n        width = params.width,\n        height = params.height,\n        angle = params.angle,\n        cx = params.cx,\n        cy = params.cy,\n        size = params.size;\n      if (this.gradientCache[key]) {\n        return this.gradientCache[key];\n      }\n      var gradient = null;\n      if (type === GradientType.LinearGradient) {\n        var _computeLinearGradien = computeLinearGradient(min, width, height, angle),\n          x1 = _computeLinearGradien.x1,\n          y1 = _computeLinearGradien.y1,\n          x2 = _computeLinearGradien.x2,\n          y2 = _computeLinearGradien.y2;\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n        gradient = context.createLinearGradient(x1, y1, x2, y2);\n      } else if (type === GradientType.RadialGradient) {\n        var _computeRadialGradien = computeRadialGradient(min, width, height, cx, cy, size),\n          x = _computeRadialGradien.x,\n          y = _computeRadialGradien.y,\n          r = _computeRadialGradien.r;\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n        gradient = context.createRadialGradient(x, y, 0, x, y, r);\n      }\n      if (gradient) {\n        steps.forEach(function (_ref2) {\n          var offset = _ref2.offset,\n            color = _ref2.color;\n          if (offset.unit === UnitType.kPercentage) {\n            var _gradient;\n            (_gradient = gradient) === null || _gradient === void 0 || _gradient.addColorStop(offset.value / 100, color.toString());\n          }\n        });\n        this.gradientCache[key] = gradient;\n      }\n      return this.gradientCache[key];\n    }\n  }, {\n    key: \"generateGradientKey\",\n    value: function generateGradientKey(params) {\n      var type = params.type,\n        min = params.min,\n        width = params.width,\n        height = params.height,\n        steps = params.steps,\n        angle = params.angle,\n        cx = params.cx,\n        cy = params.cy,\n        size = params.size;\n      return \"gradient-\".concat(type, \"-\").concat((angle === null || angle === void 0 ? void 0 : angle.toString()) || 0, \"-\").concat((cx === null || cx === void 0 ? void 0 : cx.toString()) || 0, \"-\").concat((cy === null || cy === void 0 ? void 0 : cy.toString()) || 0, \"-\").concat((size === null || size === void 0 ? void 0 : size.toString()) || 0, \"-\").concat(min[0], \"-\").concat(min[1], \"-\").concat(width, \"-\").concat(height, \"-\").concat(steps.map(function (_ref3) {\n        var offset = _ref3.offset,\n          color = _ref3.color;\n        return \"\".concat(offset).concat(color);\n      }).join('-'));\n    }\n  }, {\n    key: \"generatePatternKey\",\n    value: function generatePatternKey(pattern) {\n      var image = pattern.image,\n        repetition = pattern.repetition;\n      // only generate cache for Image\n      if (isString(image)) {\n        return \"pattern-\".concat(image, \"-\").concat(repetition);\n      }\n      if (image.nodeName === 'rect') {\n        return \"pattern-\".concat(image.entity, \"-\").concat(repetition);\n      }\n    }\n  }]);\n}();\nImagePool.isSupportTile = !!OffscreenCanvasCreator.createCanvas();\nfunction calculateImageTileSize(img) {\n  if (!img.complete) {\n    return [0, 0];\n  }\n  var width = img.naturalWidth || img.width,\n    height = img.naturalHeight || img.height;\n  var tileSize = 256;\n  [256, 512].forEach(function (size) {\n    var rows = Math.ceil(height / size);\n    var cols = Math.ceil(width / size);\n    if (rows * cols < 1e3) {\n      tileSize = size;\n    }\n  });\n  return [tileSize, tileSize];\n}\n\nvar LoadImagePlugin = /*#__PURE__*/function () {\n  function LoadImagePlugin() {\n    _classCallCheck(this, LoadImagePlugin);\n  }\n  return _createClass(LoadImagePlugin, [{\n    key: \"apply\",\n    value: function apply(context) {\n      var renderingService = context.renderingService,\n        renderingContext = context.renderingContext,\n        imagePool = context.imagePool;\n      var canvas = renderingContext.root.ownerDocument.defaultView;\n      var calculateWithAspectRatio = function calculateWithAspectRatio(object, imageWidth, imageHeight) {\n        var _object$parsedStyle = object.parsedStyle,\n          width = _object$parsedStyle.width,\n          height = _object$parsedStyle.height;\n        if (width && !height) {\n          object.setAttribute('height', imageHeight / imageWidth * width);\n        } else if (!width && height) {\n          object.setAttribute('width', imageWidth / imageHeight * height);\n        }\n      };\n      var handleMounted = function handleMounted(e) {\n        var object = e.target;\n        var nodeName = object.nodeName,\n          attributes = object.attributes;\n        if (nodeName === Shape.IMAGE) {\n          var src = attributes.src,\n            keepAspectRatio = attributes.keepAspectRatio;\n          if (isString(src)) {\n            imagePool.getImageSync(src, object, function (_ref) {\n              var _ref$img = _ref.img,\n                width = _ref$img.width,\n                height = _ref$img.height;\n              if (keepAspectRatio) {\n                calculateWithAspectRatio(object, width, height);\n              }\n\n              // set dirty rectangle flag\n              object.renderable.dirty = true;\n              renderingService.dirtify();\n            });\n          }\n        }\n      };\n      var handleAttributeChanged = function handleAttributeChanged(e) {\n        var object = e.target;\n        var attrName = e.attrName,\n          prevValue = e.prevValue,\n          newValue = e.newValue;\n        if (object.nodeName !== Shape.IMAGE || attrName !== 'src') {\n          return;\n        }\n        if (prevValue !== newValue) {\n          imagePool.releaseImage(prevValue, object);\n        }\n        if (isString(newValue)) {\n          imagePool.getOrCreateImage(newValue, object).then(function (_ref2) {\n            var _ref2$img = _ref2.img,\n              width = _ref2$img.width,\n              height = _ref2$img.height;\n            if (object.attributes.keepAspectRatio) {\n              calculateWithAspectRatio(object, width, height);\n            }\n\n            // set dirty rectangle flag\n            object.renderable.dirty = true;\n            renderingService.dirtify();\n          })[\"catch\"](function () {\n            //\n          });\n        }\n      };\n      function handleDestroy(e) {\n        var object = e.target;\n        if (object.nodeName !== Shape.IMAGE) {\n          return;\n        }\n        imagePool.releaseImageRef(object);\n      }\n      renderingService.hooks.init.tap(LoadImagePlugin.tag, function () {\n        canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n        canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        canvas.addEventListener(ElementEvent.DESTROY, handleDestroy);\n      });\n      renderingService.hooks.destroy.tap(LoadImagePlugin.tag, function () {\n        canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n        canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        canvas.removeEventListener(ElementEvent.DESTROY, handleDestroy);\n      });\n    }\n  }]);\n}();\nLoadImagePlugin.tag = 'LoadImage';\n\nvar Plugin = /*#__PURE__*/function (_AbstractRendererPlug) {\n  function Plugin() {\n    var _this;\n    _classCallCheck(this, Plugin);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Plugin, [].concat(args));\n    _this.name = 'image-loader';\n    return _this;\n  }\n  _inherits(Plugin, _AbstractRendererPlug);\n  return _createClass(Plugin, [{\n    key: \"init\",\n    value: function init(runtime) {\n      // @ts-ignore\n      this.context.imagePool = new ImagePool(this.context, runtime);\n      this.addRenderingPlugin(new LoadImagePlugin());\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.removeAllRenderingPlugins();\n    }\n  }]);\n}(AbstractRendererPlugin);\n\nexport { ImagePool, Plugin };\n//# sourceMappingURL=index.esm.js.map\n","/*!\n * @antv/g-plugin-canvas-renderer\n * @description A G plugin of renderer implementation with Canvas2D API\n * @version 2.1.2\n * @date 10/23/2024, 11:15:42 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _objectSpread from '@babel/runtime/helpers/objectSpread2';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport { ElementEvent, AABB, CustomEvent, CanvasEvent, Node, Shape, isPattern, GradientType, AbstractRendererPlugin } from '@antv/g-lite';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport { isNil } from '@antv/util';\nimport { mat4, vec3 } from 'gl-matrix';\nimport _classPrivateFieldLooseBase from '@babel/runtime/helpers/classPrivateFieldLooseBase';\nimport _classPrivateFieldLooseKey from '@babel/runtime/helpers/classPrivateFieldLooseKey';\nimport { ImagePool } from '@antv/g-plugin-image-loader';\n\n/**\n * support 2 modes in rendering:\n * * immediate\n * * delayed: render at the end of frame with dirty-rectangle\n */\nvar CanvasRendererPlugin = /*#__PURE__*/function () {\n  /**\n   * RBush used in dirty rectangle rendering\n   */\n\n  function CanvasRendererPlugin(canvasRendererPluginOptions // private styleRendererFactory: Record<Shape, StyleRenderer>,\n  ) {\n    _classCallCheck(this, CanvasRendererPlugin);\n    this.removedRBushNodeAABBs = [];\n    this.renderQueue = [];\n    /**\n     * This stack is only used by clipPath for now.\n     */\n    this.restoreStack = [];\n    this.clearFullScreenLastFrame = false;\n    this.clearFullScreen = false;\n    /**\n     * view projection matrix\n     */\n    this.vpMatrix = mat4.create();\n    this.dprMatrix = mat4.create();\n    this.tmpMat4 = mat4.create();\n    this.vec3a = vec3.create();\n    this.vec3b = vec3.create();\n    this.vec3c = vec3.create();\n    this.vec3d = vec3.create();\n    this.canvasRendererPluginOptions = canvasRendererPluginOptions;\n  }\n  return _createClass(CanvasRendererPlugin, [{\n    key: \"apply\",\n    value: function apply(context, runtime) {\n      var _this = this;\n      this.context = context;\n      var config = context.config,\n        camera = context.camera,\n        renderingService = context.renderingService,\n        renderingContext = context.renderingContext,\n        rBushRoot = context.rBushRoot,\n        pathGeneratorFactory = context.pathGeneratorFactory;\n      this.rBush = rBushRoot;\n      this.pathGeneratorFactory = pathGeneratorFactory;\n      var contextService = context.contextService;\n      var canvas = renderingContext.root.ownerDocument.defaultView;\n      var handleUnmounted = function handleUnmounted(e) {\n        var object = e.target;\n\n        // remove r-bush node\n        // @ts-ignore\n        var rBushNode = object.rBushNode;\n        if (rBushNode.aabb) {\n          // save removed aabbs for dirty-rectangle rendering later\n          _this.removedRBushNodeAABBs.push(rBushNode.aabb);\n        }\n      };\n      var handleCulled = function handleCulled(e) {\n        var object = e.target;\n        // @ts-ignore\n        var rBushNode = object.rBushNode;\n        if (rBushNode.aabb) {\n          // save removed aabbs for dirty-rectangle rendering later\n          _this.removedRBushNodeAABBs.push(rBushNode.aabb);\n        }\n      };\n      renderingService.hooks.init.tap(CanvasRendererPlugin.tag, function () {\n        canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        canvas.addEventListener(ElementEvent.CULLED, handleCulled);\n\n        // clear fullscreen\n        var dpr = contextService.getDPR();\n        var width = config.width,\n          height = config.height;\n        var context = contextService.getContext();\n        _this.clearRect(context, 0, 0, width * dpr, height * dpr, config.background);\n      });\n      renderingService.hooks.destroy.tap(CanvasRendererPlugin.tag, function () {\n        canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        canvas.removeEventListener(ElementEvent.CULLED, handleCulled);\n        _this.renderQueue = [];\n        _this.removedRBushNodeAABBs = [];\n        _this.restoreStack = [];\n      });\n      renderingService.hooks.beginFrame.tap(CanvasRendererPlugin.tag, function () {\n        var _canvas$context$rende;\n        var context = contextService.getContext();\n        var dpr = contextService.getDPR();\n        var width = config.width,\n          height = config.height;\n        var _this$canvasRendererP = _this.canvasRendererPluginOptions,\n          dirtyObjectNumThreshold = _this$canvasRendererP.dirtyObjectNumThreshold,\n          dirtyObjectRatioThreshold = _this$canvasRendererP.dirtyObjectRatioThreshold;\n\n        // some heuristic conditions such as 80% object changed\n        var _renderingService$get = renderingService.getStats(),\n          total = _renderingService$get.total,\n          rendered = _renderingService$get.rendered;\n        var ratio = rendered / total;\n        _this.clearFullScreen = _this.clearFullScreenLastFrame ||\n        // @ts-ignore\n        !((_canvas$context$rende = canvas.context.renderingPlugins[1]) !== null && _canvas$context$rende !== void 0 && _canvas$context$rende.isFirstTimeRenderingFinished) || renderingService.disableDirtyRectangleRendering() || rendered > dirtyObjectNumThreshold && ratio > dirtyObjectRatioThreshold;\n        if (context) {\n          context.resetTransform ? context.resetTransform() : context.setTransform(1, 0, 0, 1, 0, 0);\n          if (_this.clearFullScreen) {\n            _this.clearRect(context, 0, 0, width * dpr, height * dpr, config.background);\n          }\n        }\n      });\n      var _renderByZIndex = function renderByZIndex(object, context) {\n        if (object.isVisible() && !object.isCulled()) {\n          _this.renderDisplayObject(object, context, _this.context, _this.restoreStack, runtime);\n        }\n        var sorted = object.sortable.sorted || object.childNodes;\n\n        // should account for z-index\n        sorted.forEach(function (child) {\n          _renderByZIndex(child, context);\n        });\n      };\n\n      // render at the end of frame\n      renderingService.hooks.endFrame.tap(CanvasRendererPlugin.tag, function () {\n        // Skip rendering.\n        if (renderingContext.root.childNodes.length === 0) {\n          _this.clearFullScreenLastFrame = true;\n          return;\n        }\n        _this.clearFullScreenLastFrame = false;\n        var context = contextService.getContext();\n        // clear & clip dirty rectangle\n        var dpr = contextService.getDPR();\n        mat4.fromScaling(_this.dprMatrix, [dpr, dpr, 1]);\n        mat4.multiply(_this.vpMatrix, _this.dprMatrix, camera.getOrthoMatrix());\n        if (_this.clearFullScreen) {\n          // console.log('canvas renderer fcp...', renderingContext.root.childNodes);\n          _renderByZIndex(renderingContext.root, context);\n        } else {\n          // console.log('canvas renderer next...', this.renderQueue);\n          // merge removed AABB\n          var dirtyRenderBounds = _this.safeMergeAABB.apply(_this, [_this.mergeDirtyAABBs(_this.renderQueue)].concat(_toConsumableArray(_this.removedRBushNodeAABBs.map(function (_ref) {\n            var minX = _ref.minX,\n              minY = _ref.minY,\n              maxX = _ref.maxX,\n              maxY = _ref.maxY;\n            var aabb = new AABB();\n            aabb.setMinMax(\n            // vec3.fromValues(minX, minY, 0),\n            // vec3.fromValues(maxX, maxY, 0),\n            [minX, minY, 0], [maxX, maxY, 0]);\n            return aabb;\n          }))));\n          _this.removedRBushNodeAABBs = [];\n          if (AABB.isEmpty(dirtyRenderBounds)) {\n            _this.renderQueue = [];\n            return;\n          }\n          var dirtyRect = _this.convertAABB2Rect(dirtyRenderBounds);\n          var x = dirtyRect.x,\n            y = dirtyRect.y,\n            width = dirtyRect.width,\n            height = dirtyRect.height;\n          var tl = vec3.transformMat4(_this.vec3a, [x, y, 0], _this.vpMatrix);\n          var tr = vec3.transformMat4(_this.vec3b, [x + width, y, 0], _this.vpMatrix);\n          var bl = vec3.transformMat4(_this.vec3c, [x, y + height, 0], _this.vpMatrix);\n          var br = vec3.transformMat4(_this.vec3d, [x + width, y + height, 0], _this.vpMatrix);\n          var minx = Math.min(tl[0], tr[0], br[0], bl[0]);\n          var miny = Math.min(tl[1], tr[1], br[1], bl[1]);\n          var maxx = Math.max(tl[0], tr[0], br[0], bl[0]);\n          var maxy = Math.max(tl[1], tr[1], br[1], bl[1]);\n          var ix = Math.floor(minx);\n          var iy = Math.floor(miny);\n          var iwidth = Math.ceil(maxx - minx);\n          var iheight = Math.ceil(maxy - miny);\n          context.save();\n          _this.clearRect(context, ix, iy, iwidth, iheight, config.background);\n          context.beginPath();\n          context.rect(ix, iy, iwidth, iheight);\n          context.clip();\n\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n          context.setTransform(_this.vpMatrix[0], _this.vpMatrix[1], _this.vpMatrix[4], _this.vpMatrix[5], _this.vpMatrix[12], _this.vpMatrix[13]);\n\n          // draw dirty rectangle\n          var _config$renderer$getC = config.renderer.getConfig(),\n            enableDirtyRectangleRenderingDebug = _config$renderer$getC.enableDirtyRectangleRenderingDebug;\n          if (enableDirtyRectangleRenderingDebug) {\n            canvas.dispatchEvent(new CustomEvent(CanvasEvent.DIRTY_RECTANGLE, {\n              dirtyRect: {\n                x: ix,\n                y: iy,\n                width: iwidth,\n                height: iheight\n              }\n            }));\n          }\n\n          // search objects intersect with dirty rectangle\n          var dirtyObjects = _this.searchDirtyObjects(dirtyRenderBounds);\n\n          // do rendering\n          dirtyObjects\n          // sort by z-index\n          .sort(function (a, b) {\n            return a.sortable.renderOrder - b.sortable.renderOrder;\n          }).forEach(function (object) {\n            // culled object should not be rendered\n            if (object && object.isVisible() && !object.isCulled()) {\n              _this.renderDisplayObject(object, context, _this.context, _this.restoreStack, runtime);\n            }\n          });\n          context.restore();\n\n          // save dirty AABBs in last frame\n          _this.renderQueue.forEach(function (object) {\n            _this.saveDirtyAABB(object);\n          });\n\n          // clear queue\n          _this.renderQueue = [];\n        }\n\n        // pop restore stack, eg. root -> parent -> child\n        _this.restoreStack.forEach(function () {\n          context.restore();\n        });\n        // clear restore stack\n        _this.restoreStack = [];\n      });\n      renderingService.hooks.render.tap(CanvasRendererPlugin.tag, function (object) {\n        if (!_this.clearFullScreen) {\n          // render at the end of frame\n          _this.renderQueue.push(object);\n        }\n      });\n    }\n  }, {\n    key: \"clearRect\",\n    value: function clearRect(context, x, y, width, height, background) {\n      // clearRect is faster than fillRect @see https://stackoverflow.com/a/30830253\n      context.clearRect(x, y, width, height);\n      if (background) {\n        context.fillStyle = background;\n        context.fillRect(x, y, width, height);\n      }\n    }\n  }, {\n    key: \"renderDisplayObject\",\n    value: function renderDisplayObject(object, context, canvasContext, restoreStack, runtime) {\n      var nodeName = object.nodeName;\n\n      // console.log('canvas render:', object);\n\n      // restore to its ancestor\n\n      var parent = restoreStack[restoreStack.length - 1];\n      if (parent && !(object.compareDocumentPosition(parent) & Node.DOCUMENT_POSITION_CONTAINS)) {\n        context.restore();\n        restoreStack.pop();\n      }\n\n      // @ts-ignore\n      var styleRenderer = this.context.styleRendererFactory[nodeName];\n      var generatePath = this.pathGeneratorFactory[nodeName];\n\n      // clip path\n      var _ref2 = object.parsedStyle,\n        clipPath = _ref2.clipPath;\n      if (clipPath) {\n        this.applyWorldTransform(context, clipPath);\n\n        // generate path in local space\n        var _generatePath = this.pathGeneratorFactory[clipPath.nodeName];\n        if (_generatePath) {\n          context.save();\n\n          // save clip\n          restoreStack.push(object);\n          context.beginPath();\n          _generatePath(context, clipPath.parsedStyle);\n          context.closePath();\n          context.clip();\n        }\n      }\n\n      // fill & stroke\n\n      if (styleRenderer) {\n        this.applyWorldTransform(context, object);\n        context.save();\n\n        // apply attributes to context\n        this.applyAttributesToContext(context, object);\n      }\n      if (generatePath) {\n        context.beginPath();\n        generatePath(context, object.parsedStyle);\n        if (object.nodeName !== Shape.LINE && object.nodeName !== Shape.PATH && object.nodeName !== Shape.POLYLINE) {\n          context.closePath();\n        }\n      }\n\n      // fill & stroke\n      if (styleRenderer) {\n        styleRenderer.render(context, object.parsedStyle, object, canvasContext, this, runtime);\n\n        // restore applied attributes, eg. shadowBlur shadowColor...\n        context.restore();\n      }\n\n      // finish rendering, clear dirty flag\n      object.renderable.dirty = false;\n    }\n  }, {\n    key: \"convertAABB2Rect\",\n    value: function convertAABB2Rect(aabb) {\n      var min = aabb.getMin();\n      var max = aabb.getMax();\n      // expand the rectangle a bit to avoid artifacts\n      // @see https://www.yuque.com/antv/ou292n/bi8nix#ExvCu\n      var minX = Math.floor(min[0]);\n      var minY = Math.floor(min[1]);\n      var maxX = Math.ceil(max[0]);\n      var maxY = Math.ceil(max[1]);\n      var width = maxX - minX;\n      var height = maxY - minY;\n      return {\n        x: minX,\n        y: minY,\n        width: width,\n        height: height\n      };\n    }\n\n    /**\n     * TODO: merge dirty rectangles with some strategies.\n     * For now, we just simply merge all the rectangles into one.\n     * @see https://idom.me/articles/841.html\n     */\n  }, {\n    key: \"mergeDirtyAABBs\",\n    value: function mergeDirtyAABBs(dirtyObjects) {\n      // merge into a big AABB\n      // TODO: skip descendant if ancestor is caculated, but compareNodePosition is really slow\n      var aabb = new AABB();\n      dirtyObjects.forEach(function (object) {\n        var renderBounds = object.getRenderBounds();\n        aabb.add(renderBounds);\n        var dirtyRenderBounds = object.renderable.dirtyRenderBounds;\n        if (dirtyRenderBounds) {\n          aabb.add(dirtyRenderBounds);\n        }\n      });\n      return aabb;\n    }\n  }, {\n    key: \"searchDirtyObjects\",\n    value: function searchDirtyObjects(dirtyRectangle) {\n      // search in r-tree, get all affected nodes\n      var _dirtyRectangle$getMi = dirtyRectangle.getMin(),\n        _dirtyRectangle$getMi2 = _slicedToArray(_dirtyRectangle$getMi, 2),\n        minX = _dirtyRectangle$getMi2[0],\n        minY = _dirtyRectangle$getMi2[1];\n      var _dirtyRectangle$getMa = dirtyRectangle.getMax(),\n        _dirtyRectangle$getMa2 = _slicedToArray(_dirtyRectangle$getMa, 2),\n        maxX = _dirtyRectangle$getMa2[0],\n        maxY = _dirtyRectangle$getMa2[1];\n      var rBushNodes = this.rBush.search({\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY\n      });\n      return rBushNodes.map(function (_ref3) {\n        var displayObject = _ref3.displayObject;\n        return displayObject;\n      });\n    }\n  }, {\n    key: \"saveDirtyAABB\",\n    value: function saveDirtyAABB(object) {\n      var renderable = object.renderable;\n      if (!renderable.dirtyRenderBounds) {\n        renderable.dirtyRenderBounds = new AABB();\n      }\n      var renderBounds = object.getRenderBounds();\n      if (renderBounds) {\n        // save last dirty aabb\n        renderable.dirtyRenderBounds.update(renderBounds.center, renderBounds.halfExtents);\n      }\n    }\n\n    /**\n     * TODO: batch the same global attributes\n     */\n  }, {\n    key: \"applyAttributesToContext\",\n    value: function applyAttributesToContext(context, object) {\n      var _ref4 = object.parsedStyle,\n        stroke = _ref4.stroke,\n        fill = _ref4.fill,\n        opacity = _ref4.opacity,\n        lineDash = _ref4.lineDash,\n        lineDashOffset = _ref4.lineDashOffset;\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setLineDash\n      if (lineDash) {\n        context.setLineDash(lineDash);\n      }\n\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineDashOffset\n      if (!isNil(lineDashOffset)) {\n        context.lineDashOffset = lineDashOffset;\n      }\n      if (!isNil(opacity)) {\n        context.globalAlpha *= opacity;\n      }\n      if (!isNil(stroke) && !Array.isArray(stroke) && !stroke.isNone) {\n        context.strokeStyle = object.attributes.stroke;\n      }\n      if (!isNil(fill) && !Array.isArray(fill) && !fill.isNone) {\n        context.fillStyle = object.attributes.fill;\n      }\n    }\n  }, {\n    key: \"applyWorldTransform\",\n    value: function applyWorldTransform(context, object, matrix) {\n      // apply clip shape's RTS\n      if (matrix) {\n        mat4.copy(this.tmpMat4, object.getLocalTransform());\n        mat4.multiply(this.tmpMat4, matrix, this.tmpMat4);\n        mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n      } else {\n        // apply RTS transformation in world space\n        mat4.copy(this.tmpMat4, object.getWorldTransform());\n        mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n      context.setTransform(this.tmpMat4[0], this.tmpMat4[1], this.tmpMat4[4], this.tmpMat4[5], this.tmpMat4[12], this.tmpMat4[13]);\n    }\n  }, {\n    key: \"safeMergeAABB\",\n    value: function safeMergeAABB() {\n      var merged = new AABB();\n      for (var _len = arguments.length, aabbs = new Array(_len), _key = 0; _key < _len; _key++) {\n        aabbs[_key] = arguments[_key];\n      }\n      aabbs.forEach(function (aabb) {\n        merged.add(aabb);\n      });\n      return merged;\n    }\n  }]);\n}();\nCanvasRendererPlugin.tag = 'CanvasRenderer';\n\nvar DefaultRenderer = /*#__PURE__*/function () {\n  function DefaultRenderer(imagePool) {\n    _classCallCheck(this, DefaultRenderer);\n    this.imagePool = imagePool;\n  }\n  return _createClass(DefaultRenderer, [{\n    key: \"render\",\n    value: function render(context, parsedStyle, object, canvasContext, plugin, runtime) {\n      var fill = parsedStyle.fill,\n        fillRule = parsedStyle.fillRule,\n        _parsedStyle$opacity = parsedStyle.opacity,\n        opacity = _parsedStyle$opacity === void 0 ? 1 : _parsedStyle$opacity,\n        _parsedStyle$fillOpac = parsedStyle.fillOpacity,\n        fillOpacity = _parsedStyle$fillOpac === void 0 ? 1 : _parsedStyle$fillOpac,\n        stroke = parsedStyle.stroke,\n        _parsedStyle$strokeOp = parsedStyle.strokeOpacity,\n        strokeOpacity = _parsedStyle$strokeOp === void 0 ? 1 : _parsedStyle$strokeOp,\n        _parsedStyle$lineWidt = parsedStyle.lineWidth,\n        lineWidth = _parsedStyle$lineWidt === void 0 ? 1 : _parsedStyle$lineWidt,\n        lineCap = parsedStyle.lineCap,\n        lineJoin = parsedStyle.lineJoin,\n        shadowType = parsedStyle.shadowType,\n        shadowColor = parsedStyle.shadowColor,\n        shadowBlur = parsedStyle.shadowBlur,\n        filter = parsedStyle.filter,\n        miterLimit = parsedStyle.miterLimit;\n      var hasFill = fill && !fill.isNone;\n      var hasStroke = stroke && !stroke.isNone && lineWidth > 0;\n      var isFillTransparent = (fill === null || fill === void 0 ? void 0 : fill.alpha) === 0;\n      var hasFilter = !!(filter && filter.length);\n      var hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n      var nodeName = object.nodeName;\n      var isInnerShadow = shadowType === 'inner';\n      var shouldDrawShadowWithStroke = hasStroke && hasShadow && (nodeName === Shape.PATH || nodeName === Shape.LINE || nodeName === Shape.POLYLINE || isFillTransparent || isInnerShadow);\n      if (hasFill) {\n        context.globalAlpha = opacity * fillOpacity;\n        if (!shouldDrawShadowWithStroke) {\n          setShadowAndFilter(object, context, hasShadow);\n        }\n        applyFill(context, object, fill, fillRule, canvasContext, plugin, runtime, this.imagePool);\n        if (!shouldDrawShadowWithStroke) {\n          this.clearShadowAndFilter(context, hasFilter, hasShadow);\n        }\n      }\n      if (hasStroke) {\n        context.globalAlpha = opacity * strokeOpacity;\n        context.lineWidth = lineWidth;\n        if (!isNil(miterLimit)) {\n          context.miterLimit = miterLimit;\n        }\n        if (!isNil(lineCap)) {\n          context.lineCap = lineCap;\n        }\n        if (!isNil(lineJoin)) {\n          context.lineJoin = lineJoin;\n        }\n        if (shouldDrawShadowWithStroke) {\n          if (isInnerShadow) {\n            context.globalCompositeOperation = 'source-atop';\n          }\n          setShadowAndFilter(object, context, true);\n          if (isInnerShadow) {\n            applyStroke(context, object, stroke, canvasContext, plugin, runtime, this.imagePool);\n            context.globalCompositeOperation = 'source-over';\n            this.clearShadowAndFilter(context, hasFilter, true);\n          }\n        }\n        applyStroke(context, object, stroke, canvasContext, plugin, runtime, this.imagePool);\n      }\n    }\n  }, {\n    key: \"clearShadowAndFilter\",\n    value: function clearShadowAndFilter(context, hasFilter, hasShadow) {\n      if (hasShadow) {\n        context.shadowColor = 'transparent';\n        context.shadowBlur = 0;\n      }\n      if (hasFilter) {\n        // save drop-shadow filter\n        var oldFilter = context.filter;\n        if (!isNil(oldFilter) && oldFilter.indexOf('drop-shadow') > -1) {\n          context.filter = oldFilter.replace(/drop-shadow\\([^)]*\\)/, '').trim() || 'none';\n        }\n      }\n    }\n  }]);\n}();\n\n/**\n * apply before fill and stroke but only once\n */\nfunction setShadowAndFilter(object, context, hasShadow) {\n  var _ref = object.parsedStyle,\n    filter = _ref.filter,\n    shadowColor = _ref.shadowColor,\n    shadowBlur = _ref.shadowBlur,\n    shadowOffsetX = _ref.shadowOffsetX,\n    shadowOffsetY = _ref.shadowOffsetY;\n  if (filter && filter.length) {\n    // use raw filter string\n    context.filter = object.style.filter;\n  }\n  if (hasShadow) {\n    context.shadowColor = shadowColor.toString();\n    context.shadowBlur = shadowBlur || 0;\n    context.shadowOffsetX = shadowOffsetX || 0;\n    context.shadowOffsetY = shadowOffsetY || 0;\n  }\n}\nfunction getPattern(pattern, object, context, canvasContext, plugin, runtime, imagePool) {\n  var $offscreenCanvas;\n  var dpr;\n  if (pattern.image.nodeName === 'rect') {\n    var _parsedStyle = pattern.image.parsedStyle,\n      width = _parsedStyle.width,\n      height = _parsedStyle.height;\n    dpr = canvasContext.contextService.getDPR();\n    var offscreenCanvas = canvasContext.config.offscreenCanvas;\n    $offscreenCanvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n    $offscreenCanvas.width = width * dpr;\n    $offscreenCanvas.height = height * dpr;\n    var offscreenCanvasContext = runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n    var restoreStack = [];\n\n    // offscreenCanvasContext.scale(1 / dpr, 1 / dpr);\n\n    pattern.image.forEach(function (object) {\n      plugin.renderDisplayObject(object, offscreenCanvasContext, canvasContext, restoreStack, runtime);\n    });\n    restoreStack.forEach(function () {\n      offscreenCanvasContext.restore();\n    });\n  }\n  var canvasPattern = imagePool.getOrCreatePatternSync(object, pattern, context, $offscreenCanvas, dpr, object.getGeometryBounds().min, function () {\n    // set dirty rectangle flag\n    object.renderable.dirty = true;\n    canvasContext.renderingService.dirtify();\n  });\n  return canvasPattern;\n}\nfunction getColor(parsedColor, object, context, imagePool) {\n  var color;\n  if (parsedColor.type === GradientType.LinearGradient || parsedColor.type === GradientType.RadialGradient) {\n    var bounds = object.getGeometryBounds();\n    var width = bounds && bounds.halfExtents[0] * 2 || 1;\n    var height = bounds && bounds.halfExtents[1] * 2 || 1;\n    var min = bounds && bounds.min || [0, 0];\n    color = imagePool.getOrCreateGradient(_objectSpread(_objectSpread({\n      type: parsedColor.type\n    }, parsedColor.value), {}, {\n      min: min,\n      width: width,\n      height: height\n    }), context);\n  }\n  return color;\n}\nfunction applyFill(context, object, fill, fillRule, canvasContext, plugin, runtime, imagePool) {\n  var skipFill = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : false;\n  if (Array.isArray(fill)) {\n    fill.forEach(function (gradient) {\n      context.fillStyle = getColor(gradient, object, context, imagePool);\n      if (!skipFill) {\n        fillRule ? context.fill(fillRule) : context.fill();\n      }\n    });\n  } else {\n    if (isPattern(fill)) {\n      context.fillStyle = getPattern(fill, object, context, canvasContext, plugin, runtime, imagePool);\n    }\n    if (!skipFill) {\n      fillRule ? context.fill(fillRule) : context.fill();\n    }\n  }\n}\nfunction applyStroke(context, object, stroke, canvasContext, plugin, runtime, imagePool) {\n  var skipStroke = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : false;\n  if (Array.isArray(stroke)) {\n    stroke.forEach(function (gradient) {\n      context.strokeStyle = getColor(gradient, object, context, imagePool);\n      if (!skipStroke) {\n        context.stroke();\n      }\n    });\n  } else {\n    if (isPattern(stroke)) {\n      context.strokeStyle = getPattern(stroke, object, context, canvasContext, plugin, runtime, imagePool);\n    }\n    if (!skipStroke) {\n      context.stroke();\n    }\n  }\n}\n\nfunction calculateOverlapRect(rect1, rect2) {\n  var _rect = _slicedToArray(rect1, 4),\n    x1 = _rect[0],\n    y1 = _rect[1],\n    w1 = _rect[2],\n    h1 = _rect[3];\n  var _rect2 = _slicedToArray(rect2, 4),\n    x2 = _rect2[0],\n    y2 = _rect2[1],\n    w2 = _rect2[2],\n    h2 = _rect2[3];\n\n  // 计算重叠区域的左上角和右下角\n  var overlapLeft = Math.max(x1, x2);\n  var overlapTop = Math.max(y1, y2);\n  var overlapRight = Math.min(x1 + w1, x2 + w2);\n  var overlapBottom = Math.min(y1 + h1, y2 + h2);\n  if (overlapRight <= overlapLeft || overlapBottom <= overlapTop) {\n    return null;\n  }\n  return [overlapLeft, overlapTop, overlapRight - overlapLeft, overlapBottom - overlapTop];\n}\nfunction transformRect(rect, matrix) {\n  var tl = vec3.transformMat4(vec3.create(), [rect[0], rect[1], 0], matrix);\n  var tr = vec3.transformMat4(vec3.create(), [rect[0] + rect[2], rect[1], 0], matrix);\n  var bl = vec3.transformMat4(vec3.create(), [rect[0], rect[1] + rect[3], 0], matrix);\n  var br = vec3.transformMat4(vec3.create(), [rect[0] + rect[2], rect[1] + rect[3], 0], matrix);\n  return [Math.min(tl[0], tr[0], bl[0], br[0]), Math.min(tl[1], tr[1], bl[1], br[1]), Math.max(tl[0], tr[0], bl[0], br[0]) - Math.min(tl[0], tr[0], bl[0], br[0]), Math.max(tl[1], tr[1], bl[1], br[1]) - Math.min(tl[1], tr[1], bl[1], br[1])];\n}\n\nvar _renderDownSampled = /*#__PURE__*/_classPrivateFieldLooseKey(\"renderDownSampled\");\nvar _renderTile = /*#__PURE__*/_classPrivateFieldLooseKey(\"renderTile\");\nvar ImageRenderer = /*#__PURE__*/function () {\n  function ImageRenderer(imagePool) {\n    _classCallCheck(this, ImageRenderer);\n    Object.defineProperty(this, _renderTile, {\n      value: _renderTile2\n    });\n    Object.defineProperty(this, _renderDownSampled, {\n      value: _renderDownSampled2\n    });\n    this.imagePool = imagePool;\n  }\n  return _createClass(ImageRenderer, [{\n    key: \"render\",\n    value: function render(context, parsedStyle, object) {\n      var _parsedStyle$x = parsedStyle.x,\n        x = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n        _parsedStyle$y = parsedStyle.y,\n        y = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y,\n        width = parsedStyle.width,\n        height = parsedStyle.height,\n        src = parsedStyle.src,\n        shadowColor = parsedStyle.shadowColor,\n        shadowBlur = parsedStyle.shadowBlur;\n      var imageCache = this.imagePool.getImageSync(src, object);\n      var image = imageCache === null || imageCache === void 0 ? void 0 : imageCache.img;\n      var iw = width;\n      var ih = height;\n      if (!image) {\n        return;\n      }\n      iw || (iw = image.width);\n      ih || (ih = image.height);\n      var hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n      setShadowAndFilter(object, context, hasShadow);\n\n      // node-canvas will throw the following err:\n      // Error: Image given has not completed loading\n      try {\n        var _object$ownerDocument = object.ownerDocument.defaultView.getContextService().getDomElement(),\n          viewWidth = _object$ownerDocument.width,\n          viewHeight = _object$ownerDocument.height;\n        var currentTransform = context.getTransform();\n        var a = currentTransform.a,\n          b = currentTransform.b,\n          c = currentTransform.c,\n          d = currentTransform.d,\n          e = currentTransform.e,\n          f = currentTransform.f;\n        // 构建 mat4 矩阵\n        // prettier-ignore\n        var transformMatrix = mat4.fromValues(a, c, 0, 0, b, d, 0, 0, 0, 0, 1, 0, e, f, 0, 1);\n        var imageRect = transformRect([x, y, iw, ih], transformMatrix);\n        var drawRect = calculateOverlapRect([0, 0, viewWidth, viewHeight], imageRect);\n        if (!drawRect) {\n          return;\n        }\n        if (!object.ownerDocument.defaultView.getConfig().enableLargeImageOptimization) {\n          ImageRenderer.renderFull(context, parsedStyle, object, {\n            image: image,\n            drawRect: [x, y, iw, ih]\n          });\n          return;\n        }\n        var sizeOfOrigin = imageRect[2] / imageCache.size[0];\n        if (sizeOfOrigin < (imageCache.downSamplingRate || 0.5)) {\n          _classPrivateFieldLooseBase(this, _renderDownSampled)[_renderDownSampled](context, parsedStyle, object, {\n            src: src,\n            imageCache: imageCache,\n            drawRect: [x, y, iw, ih]\n          });\n          return;\n        }\n        if (!ImagePool.isSupportTile) {\n          ImageRenderer.renderFull(context, parsedStyle, object, {\n            image: image,\n            drawRect: [x, y, iw, ih]\n          });\n          return;\n        }\n        _classPrivateFieldLooseBase(this, _renderTile)[_renderTile](context, parsedStyle, object, {\n          src: src,\n          imageCache: imageCache,\n          imageRect: imageRect,\n          drawRect: drawRect\n        });\n      } catch (_unused) {}\n    }\n  }], [{\n    key: \"renderFull\",\n    value: function renderFull(context, parsedStyle, object, data) {\n      context.drawImage(data.image, Math.floor(data.drawRect[0]), Math.floor(data.drawRect[1]), Math.ceil(data.drawRect[2]), Math.ceil(data.drawRect[3]));\n    }\n  }]);\n}();\nfunction _renderDownSampled2(context, parsedStyle, object, data) {\n  var src = data.src,\n    imageCache = data.imageCache;\n  if (!imageCache.downSampled) {\n    this.imagePool.createDownSampledImage(src, object).then(function (res) {\n      // rerender\n      object.renderable.dirty = true;\n      object.ownerDocument.defaultView.context.renderingService.dirtify();\n    })[\"catch\"](function () {\n      //\n    });\n    return;\n  }\n  context.drawImage(imageCache.downSampled, Math.floor(data.drawRect[0]), Math.floor(data.drawRect[1]), Math.ceil(data.drawRect[2]), Math.ceil(data.drawRect[3]));\n}\nfunction _renderTile2(context, parsedStyle, object, data) {\n  var src = data.src,\n    imageCache = data.imageCache,\n    imageRect = data.imageRect,\n    drawRect = data.drawRect;\n  var originalSize = imageCache.size;\n  var _context$getTransform = context.getTransform(),\n    a = _context$getTransform.a,\n    b = _context$getTransform.b,\n    c = _context$getTransform.c,\n    d = _context$getTransform.d,\n    e = _context$getTransform.e,\n    f = _context$getTransform.f;\n  context.resetTransform();\n  if (!(imageCache !== null && imageCache !== void 0 && imageCache.gridSize)) {\n    this.imagePool.createImageTiles(src, [], object).then(function () {\n      // rerender\n      object.renderable.dirty = true;\n      object.ownerDocument.defaultView.context.renderingService.dirtify();\n    })[\"catch\"](function () {\n      //\n    });\n    return;\n  }\n  var scaleToOrigin = [originalSize[0] / imageRect[2], originalSize[1] / imageRect[3]];\n  var scaledTileSize = [imageCache.tileSize[0] / scaleToOrigin[0], imageCache.tileSize[1] / scaleToOrigin[1]];\n  var _ref = [Math.floor((drawRect[0] - imageRect[0]) / scaledTileSize[0]), Math.ceil((drawRect[0] + drawRect[2] - imageRect[0]) / scaledTileSize[0])],\n    startTileX = _ref[0],\n    endTileX = _ref[1];\n  var _ref2 = [Math.floor((drawRect[1] - imageRect[1]) / scaledTileSize[1]), Math.ceil((drawRect[1] + drawRect[3] - imageRect[1]) / scaledTileSize[1])],\n    startTileY = _ref2[0],\n    endTileY = _ref2[1];\n  for (var tileY = startTileY; tileY <= endTileY; tileY++) {\n    for (var tileX = startTileX; tileX <= endTileX; tileX++) {\n      var item = imageCache.tiles[tileY][tileX];\n      if (item) {\n        var tileRect = [Math.floor(imageRect[0] + item.tileX * scaledTileSize[0]), Math.floor(imageRect[1] + item.tileY * scaledTileSize[1]), Math.ceil(scaledTileSize[0]), Math.ceil(scaledTileSize[1])];\n        context.drawImage(item.data, tileRect[0], tileRect[1], tileRect[2], tileRect[3]);\n      }\n    }\n  }\n  context.setTransform(a, b, c, d, e, f);\n}\n\nvar TextRenderer = /*#__PURE__*/function () {\n  function TextRenderer(imagePool) {\n    _classCallCheck(this, TextRenderer);\n    this.imagePool = imagePool;\n  }\n  return _createClass(TextRenderer, [{\n    key: \"render\",\n    value: function render(context, parsedStyle, object, canvasContext, plugin, runtime) {\n      // Trigger text geometry calculation.\n      object.getBounds();\n      var _parsedStyle$lineWidt = parsedStyle.lineWidth,\n        lineWidth = _parsedStyle$lineWidt === void 0 ? 1 : _parsedStyle$lineWidt,\n        _parsedStyle$textAlig = parsedStyle.textAlign,\n        textAlign = _parsedStyle$textAlig === void 0 ? 'start' : _parsedStyle$textAlig,\n        _parsedStyle$textBase = parsedStyle.textBaseline,\n        textBaseline = _parsedStyle$textBase === void 0 ? 'alphabetic' : _parsedStyle$textBase,\n        _parsedStyle$lineJoin = parsedStyle.lineJoin,\n        lineJoin = _parsedStyle$lineJoin === void 0 ? 'miter' : _parsedStyle$lineJoin,\n        _parsedStyle$miterLim = parsedStyle.miterLimit,\n        miterLimit = _parsedStyle$miterLim === void 0 ? 10 : _parsedStyle$miterLim,\n        _parsedStyle$letterSp = parsedStyle.letterSpacing,\n        letterSpacing = _parsedStyle$letterSp === void 0 ? 0 : _parsedStyle$letterSp,\n        stroke = parsedStyle.stroke,\n        fill = parsedStyle.fill,\n        fillRule = parsedStyle.fillRule,\n        _parsedStyle$fillOpac = parsedStyle.fillOpacity,\n        fillOpacity = _parsedStyle$fillOpac === void 0 ? 1 : _parsedStyle$fillOpac,\n        _parsedStyle$strokeOp = parsedStyle.strokeOpacity,\n        strokeOpacity = _parsedStyle$strokeOp === void 0 ? 1 : _parsedStyle$strokeOp,\n        _parsedStyle$opacity = parsedStyle.opacity,\n        opacity = _parsedStyle$opacity === void 0 ? 1 : _parsedStyle$opacity,\n        metrics = parsedStyle.metrics,\n        _parsedStyle$x = parsedStyle.x,\n        x = _parsedStyle$x === void 0 ? 0 : _parsedStyle$x,\n        _parsedStyle$y = parsedStyle.y,\n        y = _parsedStyle$y === void 0 ? 0 : _parsedStyle$y,\n        dx = parsedStyle.dx,\n        dy = parsedStyle.dy,\n        shadowColor = parsedStyle.shadowColor,\n        shadowBlur = parsedStyle.shadowBlur;\n      var font = metrics.font,\n        lines = metrics.lines,\n        height = metrics.height,\n        lineHeight = metrics.lineHeight,\n        lineMetrics = metrics.lineMetrics;\n      context.font = font;\n      context.lineWidth = lineWidth;\n      context.textAlign = textAlign === 'middle' ? 'center' : textAlign;\n      var formattedTextBaseline = textBaseline;\n      if (formattedTextBaseline === 'alphabetic') {\n        formattedTextBaseline = 'bottom';\n      }\n      context.lineJoin = lineJoin;\n      if (!isNil(miterLimit)) {\n        context.miterLimit = miterLimit;\n      }\n      var linePositionY = y;\n      // handle vertical text baseline\n      if (textBaseline === 'middle') {\n        linePositionY += -height / 2 - lineHeight / 2;\n      } else if (textBaseline === 'bottom' || textBaseline === 'alphabetic' || textBaseline === 'ideographic') {\n        linePositionY += -height;\n      } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n        linePositionY += -lineHeight;\n      }\n\n      // account for dx & dy\n      var offsetX = x + (dx || 0);\n      linePositionY += dy || 0;\n      if (lines.length === 1) {\n        if (formattedTextBaseline === 'bottom') {\n          formattedTextBaseline = 'middle';\n          linePositionY -= 0.5 * height;\n        } else if (formattedTextBaseline === 'top') {\n          formattedTextBaseline = 'middle';\n          linePositionY += 0.5 * height;\n        }\n      }\n      context.textBaseline = formattedTextBaseline;\n      var hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n      setShadowAndFilter(object, context, hasShadow);\n\n      // draw lines line by line\n      for (var i = 0; i < lines.length; i++) {\n        var linePositionX = lineWidth / 2 + offsetX;\n        linePositionY += lineHeight;\n\n        // no need to re-position X, cause we already set text align\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textAlign\n        if (!isNil(stroke) && !stroke.isNone && lineWidth) {\n          this.drawLetterSpacing(context, object, lines[i], lineMetrics[i], textAlign, linePositionX, linePositionY, letterSpacing, fill, fillRule, fillOpacity, stroke, strokeOpacity, opacity, true, canvasContext, plugin, runtime);\n        }\n        if (!isNil(fill)) {\n          this.drawLetterSpacing(context, object, lines[i], lineMetrics[i], textAlign, linePositionX, linePositionY, letterSpacing, fill, fillRule, fillOpacity, stroke, strokeOpacity, opacity, false, canvasContext, plugin, runtime);\n        }\n      }\n    }\n  }, {\n    key: \"drawLetterSpacing\",\n    value: function drawLetterSpacing(context, object, text, lineMetrics, textAlign, x, y, letterSpacing, fill, fillRule, fillOpacity, stroke, strokeOpacity, opacity, isStroke, canvasContext, plugin, runtime) {\n      // letterSpacing of 0 means normal, render all texts directly\n      if (letterSpacing === 0) {\n        if (isStroke) {\n          this.strokeText(context, object, text, x, y, stroke, strokeOpacity, canvasContext, plugin, runtime);\n        } else {\n          this.fillText(context, object, text, x, y, fill, fillRule, fillOpacity, opacity, canvasContext, plugin, runtime);\n        }\n        return;\n      }\n\n      // draw text using left align\n      var currentTextAlign = context.textAlign;\n      context.textAlign = 'left';\n      var currentPosition = x;\n      if (textAlign === 'center' || textAlign === 'middle') {\n        currentPosition = x - lineMetrics.width / 2;\n      } else if (textAlign === 'right' || textAlign === 'end') {\n        currentPosition = x - lineMetrics.width;\n      }\n      var stringArray = Array.from(text);\n      var previousWidth = context.measureText(text).width;\n      var currentWidth = 0;\n      for (var i = 0; i < stringArray.length; ++i) {\n        var currentChar = stringArray[i];\n        if (isStroke) {\n          this.strokeText(context, object, currentChar, currentPosition, y, stroke, strokeOpacity, canvasContext, plugin, runtime);\n        } else {\n          this.fillText(context, object, currentChar, currentPosition, y, fill, fillRule, fillOpacity, opacity, canvasContext, plugin, runtime);\n        }\n        currentWidth = context.measureText(text.substring(i + 1)).width;\n        currentPosition += previousWidth - currentWidth + letterSpacing;\n        previousWidth = currentWidth;\n      }\n      context.textAlign = currentTextAlign;\n    }\n  }, {\n    key: \"fillText\",\n    value: function fillText(context, object, text, x, y, fill, fillRule, fillOpacity, opacity, canvasContext, plugin, runtime) {\n      applyFill(context, object, fill, fillRule, canvasContext, plugin, runtime, this.imagePool, true);\n      var currentGlobalAlpha;\n      var applyOpacity = !isNil(fillOpacity) && fillOpacity !== 1;\n      if (applyOpacity) {\n        currentGlobalAlpha = context.globalAlpha;\n        context.globalAlpha = fillOpacity * opacity;\n      }\n      context.fillText(text, x, y);\n      if (applyOpacity) {\n        context.globalAlpha = currentGlobalAlpha;\n      }\n    }\n  }, {\n    key: \"strokeText\",\n    value: function strokeText(context, object, text, x, y, stroke, strokeOpacity, canvasContext, plugin, runtime) {\n      applyStroke(context, object, stroke, canvasContext, plugin, runtime, this.imagePool, true);\n      var currentGlobalAlpha;\n      var applyOpacity = !isNil(strokeOpacity) && strokeOpacity !== 1;\n      if (applyOpacity) {\n        currentGlobalAlpha = context.globalAlpha;\n        context.globalAlpha = strokeOpacity;\n      }\n      context.strokeText(text, x, y);\n      if (applyOpacity) {\n        context.globalAlpha = currentGlobalAlpha;\n      }\n    }\n  }]);\n}();\n\nvar RectRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function RectRenderer() {\n    _classCallCheck(this, RectRenderer);\n    return _callSuper(this, RectRenderer, arguments);\n  }\n  _inherits(RectRenderer, _DefaultRenderer);\n  return _createClass(RectRenderer);\n}(DefaultRenderer);\n\nvar CircleRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function CircleRenderer() {\n    _classCallCheck(this, CircleRenderer);\n    return _callSuper(this, CircleRenderer, arguments);\n  }\n  _inherits(CircleRenderer, _DefaultRenderer);\n  return _createClass(CircleRenderer);\n}(DefaultRenderer);\n\nvar EllipseRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function EllipseRenderer() {\n    _classCallCheck(this, EllipseRenderer);\n    return _callSuper(this, EllipseRenderer, arguments);\n  }\n  _inherits(EllipseRenderer, _DefaultRenderer);\n  return _createClass(EllipseRenderer);\n}(DefaultRenderer);\n\nvar LineRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function LineRenderer() {\n    _classCallCheck(this, LineRenderer);\n    return _callSuper(this, LineRenderer, arguments);\n  }\n  _inherits(LineRenderer, _DefaultRenderer);\n  return _createClass(LineRenderer);\n}(DefaultRenderer);\n\nvar PolylineRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function PolylineRenderer() {\n    _classCallCheck(this, PolylineRenderer);\n    return _callSuper(this, PolylineRenderer, arguments);\n  }\n  _inherits(PolylineRenderer, _DefaultRenderer);\n  return _createClass(PolylineRenderer);\n}(DefaultRenderer);\n\nvar PolygonRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function PolygonRenderer() {\n    _classCallCheck(this, PolygonRenderer);\n    return _callSuper(this, PolygonRenderer, arguments);\n  }\n  _inherits(PolygonRenderer, _DefaultRenderer);\n  return _createClass(PolygonRenderer);\n}(DefaultRenderer);\n\nvar PathRenderer = /*#__PURE__*/function (_DefaultRenderer) {\n  function PathRenderer() {\n    _classCallCheck(this, PathRenderer);\n    return _callSuper(this, PathRenderer, arguments);\n  }\n  _inherits(PathRenderer, _DefaultRenderer);\n  return _createClass(PathRenderer);\n}(DefaultRenderer);\n\nvar Plugin = /*#__PURE__*/function (_AbstractRendererPlug) {\n  function Plugin() {\n    var _this;\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, Plugin);\n    _this = _callSuper(this, Plugin);\n    _this.name = 'canvas-renderer';\n    _this.options = options;\n    return _this;\n  }\n  _inherits(Plugin, _AbstractRendererPlug);\n  return _createClass(Plugin, [{\n    key: \"init\",\n    value: function init() {\n      var _defaultStyleRenderer;\n      var canvasRendererPluginOptions = _objectSpread({\n        dirtyObjectNumThreshold: 500,\n        dirtyObjectRatioThreshold: 0.8\n      }, this.options);\n\n      // @ts-ignore\n      var imagePool = this.context.imagePool;\n      var defaultRenderer = new DefaultRenderer(imagePool);\n      var defaultStyleRendererFactory = (_defaultStyleRenderer = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defaultStyleRenderer, Shape.CIRCLE, defaultRenderer), Shape.ELLIPSE, defaultRenderer), Shape.RECT, defaultRenderer), Shape.IMAGE, new ImageRenderer(imagePool)), Shape.TEXT, new TextRenderer(imagePool)), Shape.LINE, defaultRenderer), Shape.POLYLINE, defaultRenderer), Shape.POLYGON, defaultRenderer), Shape.PATH, defaultRenderer), Shape.GROUP, undefined), _defineProperty(_defineProperty(_defaultStyleRenderer, Shape.HTML, undefined), Shape.MESH, undefined));\n      this.context.defaultStyleRendererFactory = defaultStyleRendererFactory;\n      this.context.styleRendererFactory = defaultStyleRendererFactory;\n      this.addRenderingPlugin(new CanvasRendererPlugin(canvasRendererPluginOptions));\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.removeAllRenderingPlugins();\n      delete this.context.defaultStyleRendererFactory;\n      delete this.context.styleRendererFactory;\n    }\n  }]);\n}(AbstractRendererPlugin);\n\nexport { CircleRenderer, EllipseRenderer, ImageRenderer, LineRenderer, PathRenderer, Plugin, PolygonRenderer, PolylineRenderer, RectRenderer, TextRenderer };\n//# sourceMappingURL=index.esm.js.map\n","/*!\n * @antv/g-plugin-dom-interaction\n * @description A G plugin\n * @version 2.1.2\n * @date 10/23/2024, 11:14:44 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport { AbstractRendererPlugin } from '@antv/g-lite';\n\n// const MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\n/**\n * listen to mouse/touch/pointer events on DOM wrapper, trigger pointer events\n */\nvar DOMInteractionPlugin = /*#__PURE__*/function () {\n  function DOMInteractionPlugin() {\n    _classCallCheck(this, DOMInteractionPlugin);\n  }\n  return _createClass(DOMInteractionPlugin, [{\n    key: \"apply\",\n    value: function apply(context, runtime) {\n      var _this = this;\n      var renderingService = context.renderingService,\n        renderingContext = context.renderingContext,\n        config = context.config;\n      this.context = context;\n      var canvas = renderingContext.root.ownerDocument.defaultView;\n      // const SUPPORT_ONLY_TOUCH = canvas.supportsTouchEvents && MOBILE_REGEX.test(navigator.userAgent);\n\n      var onPointerMove = function onPointerMove(ev) {\n        renderingService.hooks.pointerMove.call(ev);\n      };\n      var onPointerUp = function onPointerUp(ev) {\n        renderingService.hooks.pointerUp.call(ev);\n      };\n      var onPointerDown = function onPointerDown(ev) {\n        renderingService.hooks.pointerDown.call(ev);\n      };\n      var onPointerOver = function onPointerOver(ev) {\n        renderingService.hooks.pointerOver.call(ev);\n      };\n      var onPointerOut = function onPointerOut(ev) {\n        renderingService.hooks.pointerOut.call(ev);\n      };\n      var onPointerCancel = function onPointerCancel(ev) {\n        renderingService.hooks.pointerCancel.call(ev);\n      };\n      var onPointerWheel = function onPointerWheel(ev) {\n        renderingService.hooks.pointerWheel.call(ev);\n      };\n      var onClick = function onClick(ev) {\n        renderingService.hooks.click.call(ev);\n      };\n      var addPointerEventListener = function addPointerEventListener($el) {\n        runtime.globalThis.document.addEventListener('pointermove', onPointerMove, true);\n        $el.addEventListener('pointerdown', onPointerDown, true);\n        $el.addEventListener('pointerleave', onPointerOut, true);\n        $el.addEventListener('pointerover', onPointerOver, true);\n        runtime.globalThis.addEventListener('pointerup', onPointerUp, true);\n        runtime.globalThis.addEventListener('pointercancel', onPointerCancel, true);\n      };\n      var addTouchEventListener = function addTouchEventListener($el) {\n        $el.addEventListener('touchstart', onPointerDown, true);\n        $el.addEventListener('touchend', onPointerUp, true);\n        $el.addEventListener('touchmove', onPointerMove, true);\n        $el.addEventListener('touchcancel', onPointerCancel, true);\n      };\n      var addMouseEventListener = function addMouseEventListener($el) {\n        runtime.globalThis.document.addEventListener('mousemove', onPointerMove, true);\n        $el.addEventListener('mousedown', onPointerDown, true);\n        $el.addEventListener('mouseout', onPointerOut, true);\n        $el.addEventListener('mouseover', onPointerOver, true);\n        runtime.globalThis.addEventListener('mouseup', onPointerUp, true);\n      };\n      var removePointerEventListener = function removePointerEventListener($el) {\n        runtime.globalThis.document.removeEventListener('pointermove', onPointerMove, true);\n        $el.removeEventListener('pointerdown', onPointerDown, true);\n        $el.removeEventListener('pointerleave', onPointerOut, true);\n        $el.removeEventListener('pointerover', onPointerOver, true);\n        runtime.globalThis.removeEventListener('pointerup', onPointerUp, true);\n        runtime.globalThis.removeEventListener('pointercancel', onPointerCancel, true);\n      };\n      var removeTouchEventListener = function removeTouchEventListener($el) {\n        $el.removeEventListener('touchstart', onPointerDown, true);\n        $el.removeEventListener('touchend', onPointerUp, true);\n        $el.removeEventListener('touchmove', onPointerMove, true);\n        $el.removeEventListener('touchcancel', onPointerCancel, true);\n      };\n      var removeMouseEventListener = function removeMouseEventListener($el) {\n        runtime.globalThis.document.removeEventListener('mousemove', onPointerMove, true);\n        $el.removeEventListener('mousedown', onPointerDown, true);\n        $el.removeEventListener('mouseout', onPointerOut, true);\n        $el.removeEventListener('mouseover', onPointerOver, true);\n        runtime.globalThis.removeEventListener('mouseup', onPointerUp, true);\n      };\n      renderingService.hooks.init.tap(DOMInteractionPlugin.tag, function () {\n        var $el = _this.context.contextService.getDomElement();\n\n        // @ts-ignore\n        if (runtime.globalThis.navigator.msPointerEnabled) {\n          // @ts-ignore\n          $el.style.msContentZooming = 'none';\n          // @ts-ignore\n          $el.style.msTouchAction = 'none';\n        } else if (canvas.supportsPointerEvents) {\n          $el.style.touchAction = 'none';\n        }\n        if (canvas.supportsPointerEvents) {\n          addPointerEventListener($el);\n        } else {\n          addMouseEventListener($el);\n        }\n        if (canvas.supportsTouchEvents) {\n          addTouchEventListener($el);\n        }\n        if (config.useNativeClickEvent) {\n          $el.addEventListener('click', onClick, true);\n        }\n\n        // use passive event listeners\n        // @see https://zhuanlan.zhihu.com/p/24555031\n        $el.addEventListener('wheel', onPointerWheel, {\n          passive: true,\n          capture: true\n        });\n      });\n      renderingService.hooks.destroy.tap(DOMInteractionPlugin.tag, function () {\n        var $el = _this.context.contextService.getDomElement();\n\n        // @ts-ignore\n        if (runtime.globalThis.navigator.msPointerEnabled) {\n          // @ts-ignore\n          $el.style.msContentZooming = '';\n          // @ts-ignore\n          $el.style.msTouchAction = '';\n        } else if (canvas.supportsPointerEvents) {\n          $el.style.touchAction = '';\n        }\n        if (canvas.supportsPointerEvents) {\n          removePointerEventListener($el);\n        } else {\n          removeMouseEventListener($el);\n        }\n        if (canvas.supportsTouchEvents) {\n          removeTouchEventListener($el);\n        }\n        if (config.useNativeClickEvent) {\n          $el.removeEventListener('click', onClick, true);\n        }\n        $el.removeEventListener('wheel', onPointerWheel, true);\n      });\n    }\n  }]);\n}();\nDOMInteractionPlugin.tag = 'DOMInteraction';\n\nvar Plugin = /*#__PURE__*/function (_AbstractRendererPlug) {\n  function Plugin() {\n    var _this;\n    _classCallCheck(this, Plugin);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Plugin, [].concat(args));\n    _this.name = 'dom-interaction';\n    return _this;\n  }\n  _inherits(Plugin, _AbstractRendererPlug);\n  return _createClass(Plugin, [{\n    key: \"init\",\n    value: function init() {\n      this.addRenderingPlugin(new DOMInteractionPlugin());\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.removeAllRenderingPlugins();\n    }\n  }]);\n}(AbstractRendererPlugin);\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","/*!\n * @antv/g-plugin-html-renderer\n * @description A G plugin for rendering HTML\n * @version 2.1.2\n * @date 10/23/2024, 11:14:53 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _callSuper from '@babel/runtime/helpers/callSuper';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport { CanvasEvent, ElementEvent, RenderReason, isCSSRGB, isPattern, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport { isNil, isNumber, isString } from '@antv/util';\n\nvar CANVAS_CAMERA_ID = 'g-canvas-camera';\nvar HTMLRenderingPlugin = /*#__PURE__*/function () {\n  function HTMLRenderingPlugin() {\n    _classCallCheck(this, HTMLRenderingPlugin);\n    this.displayObjectHTMLElementMap = new WeakMap();\n  }\n  return _createClass(HTMLRenderingPlugin, [{\n    key: \"joinTransformMatrix\",\n    value:\n    /**\n     * ! The reason for adding `offset` is that the `transform-origin` coordinate system of DOM is the local coordinate system of the element, while the `transform-origin` coordinate system of canvas drawing is the local coordinate system of the element's parent element. At the same time, the `transform` attribute value of the DOM element does not include `transform-origin`.\n     */\n    function joinTransformMatrix(matrix) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [0, 0, 0];\n      return \"matrix(\".concat([matrix[0], matrix[1], matrix[4], matrix[5], matrix[12] + offset[0], matrix[13] + offset[1]].join(','), \")\");\n    }\n  }, {\n    key: \"apply\",\n    value: function apply(context, runtime) {\n      var _this = this;\n      var camera = context.camera,\n        renderingContext = context.renderingContext,\n        renderingService = context.renderingService;\n      this.context = context;\n      var canvas = renderingContext.root.ownerDocument.defaultView;\n      var nativeHTMLMap = canvas.context.eventService.nativeHTMLMap;\n      var setTransform = function setTransform(object, $el) {\n        $el.style.transform = _this.joinTransformMatrix(object.getWorldTransform(), object.getOrigin());\n      };\n      var handleMounted = function handleMounted(e) {\n        var object = e.target;\n        if (object.nodeName === Shape.HTML) {\n          if (!_this.$camera) {\n            _this.$camera = _this.createCamera(camera);\n          }\n\n          // create DOM element\n          var $el = _this.getOrCreateEl(object);\n          _this.$camera.appendChild($el);\n          Object.keys(object.attributes).forEach(function (name) {\n            _this.updateAttribute(name, object);\n          });\n          setTransform(object, $el);\n          nativeHTMLMap.set($el, object);\n        }\n      };\n      var handleUnmounted = function handleUnmounted(e) {\n        var object = e.target;\n        if (object.nodeName === Shape.HTML && _this.$camera) {\n          var $el = _this.getOrCreateEl(object);\n          if ($el) {\n            $el.remove();\n            nativeHTMLMap[\"delete\"]($el);\n          }\n        }\n      };\n      var handleAttributeChanged = function handleAttributeChanged(e) {\n        var object = e.target;\n        if (object.nodeName === Shape.HTML) {\n          var attrName = e.attrName;\n          _this.updateAttribute(attrName, object);\n        }\n      };\n      var handleBoundsChanged = function handleBoundsChanged(e) {\n        var object = e.target;\n        var nodes = object.nodeName === Shape.FRAGMENT ? object.childNodes : [object];\n        nodes.forEach(function (node) {\n          if (node.nodeName === Shape.HTML) {\n            var $el = _this.getOrCreateEl(node);\n            setTransform(node, $el);\n          }\n        });\n      };\n      var handleCanvasResize = function handleCanvasResize() {\n        if (_this.$camera) {\n          var _this$context$config = _this.context.config,\n            width = _this$context$config.width,\n            height = _this$context$config.height;\n          _this.$camera.parentElement.style.width = \"\".concat(width || 0, \"px\");\n          _this.$camera.parentElement.style.height = \"\".concat(height || 0, \"px\");\n        }\n      };\n      renderingService.hooks.init.tap(HTMLRenderingPlugin.tag, function () {\n        canvas.addEventListener(CanvasEvent.RESIZE, handleCanvasResize);\n        canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n        canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        canvas.addEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n      });\n      renderingService.hooks.endFrame.tap(HTMLRenderingPlugin.tag, function () {\n        if (_this.$camera && renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)) {\n          _this.$camera.style.transform = _this.joinTransformMatrix(camera.getOrthoMatrix());\n        }\n      });\n      renderingService.hooks.destroy.tap(HTMLRenderingPlugin.tag, function () {\n        // remove camera\n        if (_this.$camera) {\n          _this.$camera.remove();\n        }\n        canvas.removeEventListener(CanvasEvent.RESIZE, handleCanvasResize);\n        canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n        canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        canvas.removeEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n      });\n    }\n  }, {\n    key: \"createCamera\",\n    value: function createCamera(camera) {\n      var _this$context$config2 = this.context.config,\n        doc = _this$context$config2.document,\n        width = _this$context$config2.width,\n        height = _this$context$config2.height;\n      var $canvas = this.context.contextService.getDomElement();\n      var $container = $canvas.parentNode;\n      if ($container) {\n        var cameraId = CANVAS_CAMERA_ID;\n        var $existedCamera = $container.querySelector(\"#\".concat(cameraId));\n        if (!$existedCamera) {\n          // fix @see https://github.com/antvis/G/issues/1702\n          var $cameraContainer = (doc || document).createElement('div');\n          // HTML elements should not overflow with canvas @see https://github.com/antvis/G/issues/1163\n          $cameraContainer.style.overflow = 'hidden';\n          $cameraContainer.style.pointerEvents = 'none';\n          $cameraContainer.style.position = 'absolute';\n          $cameraContainer.style.left = \"0px\";\n          $cameraContainer.style.top = \"0px\";\n          $cameraContainer.style.width = \"\".concat(width || 0, \"px\");\n          $cameraContainer.style.height = \"\".concat(height || 0, \"px\");\n          var $camera = (doc || document).createElement('div');\n          $existedCamera = $camera;\n          $camera.id = cameraId;\n          // use absolute position\n          $camera.style.position = 'absolute';\n          // account for DOM element's offset @see https://github.com/antvis/G/issues/1150\n          $camera.style.left = \"\".concat($canvas.offsetLeft || 0, \"px\");\n          $camera.style.top = \"\".concat($canvas.offsetTop || 0, \"px\");\n          $camera.style.transformOrigin = 'left top';\n          $camera.style.transform = this.joinTransformMatrix(camera.getOrthoMatrix());\n          $camera.style.pointerEvents = 'none';\n          $camera.style.width = \"100%\";\n          $camera.style.height = \"100%\";\n          $cameraContainer.appendChild($camera);\n          $container.appendChild($cameraContainer);\n        }\n        return $existedCamera;\n      }\n      return null;\n    }\n  }, {\n    key: \"getOrCreateEl\",\n    value: function getOrCreateEl(object) {\n      var doc = this.context.config.document;\n      var $existedElement = this.displayObjectHTMLElementMap.get(object);\n      if (!$existedElement) {\n        $existedElement = (doc || document).createElement('div');\n        object.parsedStyle.$el = $existedElement;\n        this.displayObjectHTMLElementMap.set(object, $existedElement);\n        if (object.id) {\n          $existedElement.id = object.id;\n        }\n        if (object.name) {\n          $existedElement.setAttribute('name', object.name);\n        }\n        if (object.className) {\n          $existedElement.className = object.className;\n        }\n\n        // use absolute position\n        $existedElement.style.position = 'absolute';\n        // @see https://github.com/antvis/G/issues/1150\n        $existedElement.style['will-change'] = 'transform';\n        $existedElement.style.transform = this.joinTransformMatrix(object.getWorldTransform(), object.getOrigin());\n      }\n      return $existedElement;\n    }\n  }, {\n    key: \"updateAttribute\",\n    value: function updateAttribute(name, object) {\n      var $el = this.getOrCreateEl(object);\n      switch (name) {\n        case 'innerHTML':\n          var innerHTML = object.parsedStyle.innerHTML;\n          if (isString(innerHTML)) {\n            $el.innerHTML = innerHTML;\n          } else {\n            $el.innerHTML = '';\n            $el.appendChild(innerHTML);\n          }\n          break;\n        case 'x':\n          $el.style.left = \"\".concat(object.parsedStyle.x, \"px\");\n          break;\n        case 'y':\n          $el.style.top = \"\".concat(object.parsedStyle.y, \"px\");\n          break;\n        case 'transformOrigin':\n          var transformOrigin = object.parsedStyle.transformOrigin;\n          $el.style['transform-origin'] = \"\".concat(transformOrigin[0].buildCSSText(null, null, ''), \" \").concat(transformOrigin[1].buildCSSText(null, null, ''));\n          break;\n        case 'width':\n          var width = object.parsedStyle.width;\n          $el.style.width = isNumber(width) ? \"\".concat(width, \"px\") : width.toString();\n          break;\n        case 'height':\n          var height = object.parsedStyle.height;\n          $el.style.height = isNumber(height) ? \"\".concat(height, \"px\") : height.toString();\n          break;\n        case 'zIndex':\n          var zIndex = object.parsedStyle.zIndex;\n          $el.style['z-index'] = \"\".concat(zIndex);\n          break;\n        case 'visibility':\n          var visibility = object.parsedStyle.visibility;\n          $el.style.visibility = visibility;\n          break;\n        case 'pointerEvents':\n          var _object$parsedStyle$p = object.parsedStyle.pointerEvents,\n            pointerEvents = _object$parsedStyle$p === void 0 ? 'auto' : _object$parsedStyle$p;\n          $el.style.pointerEvents = pointerEvents;\n          break;\n        case 'opacity':\n          var opacity = object.parsedStyle.opacity;\n          $el.style.opacity = \"\".concat(opacity);\n          break;\n        case 'fill':\n          var fill = object.parsedStyle.fill;\n          var color = '';\n          if (isCSSRGB(fill)) {\n            if (fill.isNone) {\n              color = 'transparent';\n            } else {\n              color = object.getAttribute('fill');\n            }\n          } else if (Array.isArray(fill)) {\n            color = object.getAttribute('fill');\n          } else if (isPattern(fill)) ;\n          $el.style.background = color;\n          break;\n        case 'stroke':\n          var stroke = object.parsedStyle.stroke;\n          var borderColor = '';\n          if (isCSSRGB(stroke)) {\n            if (stroke.isNone) {\n              borderColor = 'transparent';\n            } else {\n              borderColor = object.getAttribute('stroke');\n            }\n          } else if (Array.isArray(stroke)) {\n            borderColor = object.getAttribute('stroke');\n          } else if (isPattern(stroke)) ;\n          $el.style['border-color'] = borderColor;\n          $el.style['border-style'] = 'solid';\n          break;\n        case 'lineWidth':\n          var lineWidth = object.parsedStyle.lineWidth;\n          $el.style['border-width'] = \"\".concat(lineWidth || 0, \"px\");\n          break;\n        case 'lineDash':\n          $el.style['border-style'] = 'dashed';\n          break;\n        case 'filter':\n          var filter = object.style.filter;\n          $el.style.filter = filter;\n          break;\n        default:\n          if (!isNil(object.style[name]) && object.style[name] !== '') {\n            $el.style[name] = object.style[name];\n          }\n      }\n    }\n  }]);\n}();\nHTMLRenderingPlugin.tag = 'HTMLRendering';\n\nvar Plugin = /*#__PURE__*/function (_AbstractRendererPlug) {\n  function Plugin() {\n    var _this;\n    _classCallCheck(this, Plugin);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Plugin, [].concat(args));\n    _this.name = 'html-renderer';\n    return _this;\n  }\n  _inherits(Plugin, _AbstractRendererPlug);\n  return _createClass(Plugin, [{\n    key: \"init\",\n    value: function init() {\n      this.addRenderingPlugin(new HTMLRenderingPlugin());\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.removeAllRenderingPlugins();\n    }\n  }]);\n}(AbstractRendererPlugin);\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import type {\n  RenderingContext,\n  CanvasContext,\n  CanvasLike,\n  DataURLOptions,\n  GlobalRuntime,\n  CanvasConfig,\n  ContextService,\n} from '@antv/g-lite';\nimport { RenderReason, isBrowser, setDOMSize } from '@antv/g-lite';\nimport { isString } from '@antv/util';\n\nexport class Canvas2DContextService\n  implements ContextService<CanvasRenderingContext2D>\n{\n  private $container: HTMLElement | null;\n  private $canvas: CanvasLike | null;\n  private dpr: number;\n  private context:\n    | CanvasRenderingContext2D\n    | OffscreenCanvasRenderingContext2D\n    | null;\n  private canvasConfig: Partial<CanvasConfig>;\n  private renderingContext: RenderingContext;\n\n  constructor(context: GlobalRuntime & CanvasContext) {\n    this.renderingContext = context.renderingContext;\n    this.canvasConfig = context.config;\n  }\n\n  init() {\n    const { container, canvas } = this.canvasConfig;\n\n    if (canvas) {\n      this.$canvas = canvas;\n\n      if (\n        container &&\n        (canvas as HTMLCanvasElement).parentElement !== container\n      ) {\n        (container as HTMLElement).appendChild(canvas as HTMLCanvasElement);\n      }\n\n      this.$container = (canvas as HTMLCanvasElement).parentElement;\n      this.canvasConfig.container = this.$container;\n    } else if (container) {\n      // create container\n      this.$container = isString(container)\n        ? document.getElementById(container)\n        : container;\n      if (this.$container) {\n        // create canvas\n        const $canvas = document.createElement('canvas');\n\n        this.$container.appendChild($canvas);\n        if (!this.$container.style.position) {\n          this.$container.style.position = 'relative';\n        }\n        this.$canvas = $canvas;\n      }\n    }\n\n    this.context = this.$canvas.getContext('2d');\n    this.resize(this.canvasConfig.width, this.canvasConfig.height);\n  }\n\n  getContext() {\n    return this.context as CanvasRenderingContext2D;\n  }\n\n  getDomElement() {\n    return this.$canvas;\n  }\n\n  getDPR() {\n    return this.dpr;\n  }\n\n  getBoundingClientRect() {\n    if ((this.$canvas as HTMLCanvasElement).getBoundingClientRect) {\n      return (this.$canvas as HTMLCanvasElement).getBoundingClientRect();\n    }\n  }\n\n  destroy() {\n    // @ts-ignore\n    if (this.$container && this.$canvas && this.$canvas.parentNode) {\n      // destroy context\n      // @ts-ignore\n      this.$container.removeChild(this.$canvas);\n    }\n  }\n\n  resize(width: number, height: number) {\n    const { devicePixelRatio } = this.canvasConfig;\n\n    // use user-defined dpr first\n    let dpr = devicePixelRatio || (isBrowser && window.devicePixelRatio) || 1;\n    dpr = dpr >= 1 ? Math.ceil(dpr) : 1;\n    this.dpr = dpr;\n\n    if (this.$canvas) {\n      // set canvas width & height\n      this.$canvas.width = this.dpr * width;\n      this.$canvas.height = this.dpr * height;\n\n      // set CSS style width & height\n      setDOMSize(this.$canvas, width, height);\n\n      // const dpr = this.getDPR();\n      // scale all drawing operations by the dpr\n      // @see https://www.html5rocks.com/en/tutorials/canvas/hidpi/\n      // this.context.scale(dpr, dpr);\n    }\n\n    this.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED);\n  }\n\n  applyCursorStyle(cursor: string) {\n    if (this.$container && this.$container.style) {\n      this.$container.style.cursor = cursor;\n    }\n  }\n\n  async toDataURL(options: Partial<DataURLOptions> = {}) {\n    const { type, encoderOptions } = options;\n    return (this.context.canvas as HTMLCanvasElement).toDataURL(\n      type,\n      encoderOptions,\n    );\n  }\n}\n","import { AbstractRendererPlugin } from '@antv/g-lite';\nimport { Canvas2DContextService } from './Canvas2DContextService';\n\nexport class ContextRegisterPlugin extends AbstractRendererPlugin {\n  name = 'canvas-context-register';\n  init(): void {\n    this.context.ContextService = Canvas2DContextService;\n  }\n  destroy(): void {\n    delete this.context.ContextService;\n  }\n}\n","import type { RendererConfig } from '@antv/g-lite';\nimport { AbstractRenderer } from '@antv/g-lite';\nimport * as CanvasPathGenerator from '@antv/g-plugin-canvas-path-generator';\nimport * as CanvasPicker from '@antv/g-plugin-canvas-picker';\nimport * as CanvasRenderer from '@antv/g-plugin-canvas-renderer';\nimport * as DomInteraction from '@antv/g-plugin-dom-interaction';\nimport * as HTMLRenderer from '@antv/g-plugin-html-renderer';\nimport * as ImageLoader from '@antv/g-plugin-image-loader';\nimport { ContextRegisterPlugin } from './ContextRegisterPlugin';\n\nexport {\n  CanvasPathGenerator,\n  CanvasPicker,\n  CanvasRenderer,\n  DomInteraction,\n  HTMLRenderer,\n  ImageLoader,\n};\n\nexport class Renderer extends AbstractRenderer {\n  constructor(config?: Partial<RendererConfig>) {\n    super(config);\n\n    // register Canvas2DContext\n    this.registerPlugin(new ContextRegisterPlugin());\n    this.registerPlugin(new ImageLoader.Plugin());\n    this.registerPlugin(new CanvasPathGenerator.Plugin());\n    // enable rendering with Canvas2D API\n    this.registerPlugin(new CanvasRenderer.Plugin());\n    this.registerPlugin(new DomInteraction.Plugin());\n    // enable picking with Canvas2D API\n    this.registerPlugin(new CanvasPicker.Plugin());\n\n    // render HTML component\n    this.registerPlugin(new HTMLRenderer.Plugin());\n  }\n}\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","_classCallCheck","a","n","_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_isNativeReflectConstruct","Boolean","valueOf","Reflect","construct","_possibleConstructorReturn","ReferenceError","assertThisInitialized","_callSuper","possibleConstructorReturn","isNativeReflectConstruct","apply","_setPrototypeOf","_inherits","create","value","_defineProperty","_arrayLikeToArray","Array","_unsupportedIterableToArray","arrayLikeToArray","toString","slice","name","from","test","_slicedToArray","isArray","arrayWithHoles","l","u","f","next","done","push","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","isNil$1","isType$1","type","isString","str","isType","clamp$1","min","max","isNumber$1","ARRAY_TYPE","Float32Array","out","glMatrix.ARRAY_TYPE","copy","multiply","b","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b0","b1","b2","b3","set","x","y","z","transformMat4","m","w","rotateVector","rad","Math","cos","sin","arcToCubic","X1","Y1","RX","RY","angle","LAF","SF","X2","Y2","recursive","xy","f1","f2","cx","cy","x1","y1","rx","ry","x2","y2","d120","PI","res","h","sqrt","rx2","ry2","k","abs","asin","df","f2old","x2old","y2old","c1","s1","c2","s2","tan","hx","hy","m1","m2","m3","m4","concat","newres","ii","generatePath$6","context","parsedStyle","_parsedStyle$cx","_parsedStyle$cy","arc","hypot","arguments","vec","_regeneratorRuntime","hasOwnProperty","c","asyncIterator","toStringTag","define","wrap","Generator","Context","makeInvokeMethod","tryCatch","arg","s","GeneratorFunction","GeneratorFunctionPrototype","p","this","d","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","resolve","__await","then","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","mark","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","_next","_throw","_toConsumableArray","arrayWithoutHoles","iterableToArray","nonIterableSpread","distance","dx","dy","len","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","_objectSpread2","getOwnPropertyDescriptors","defineProperties","tmpVec3a","vec3","tmpVec3b","tmpVec3c","tmpMat4","mat4","CanvasPickerPlugin","_this","isHit","displayObject","position","worldTransform","isClipPath","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","pick","pointInPathPickerFactory","nodeName","invertWorldMat","localPosition","Point","isPointInPath","runtime","offscreenCanvasCreator","getOrCreateContext","config","offscreenCanvas","generatePath","pathGeneratorFactory","beginPath","closePath","_renderingContext$roo","_this2","renderingService","renderingContext","document","root","ownerDocument","hooks","tapPromise","tag","_ref","_callee","result","_context","_x","pickSync","tap","_step","topmost","_result$position","pickedDisplayObjects","_iterator","_n","F","_createForOfIteratorHelper","elementsFromBBox","_displayObject","getWorldTransform","clipped","findClosestClipPathTarget","clipPath","picked","err","_classPrivateFieldBase","id","_classPrivateFieldKey","RefCountCache","_cacheStore","Map","_classPrivateFieldLooseBase","has","item","ref","counter","Set","cacheItem","get","add","_objectSpread","size","release","clear","CanvasRendererPlugin","canvasRendererPluginOptions","removedRBushNodeAABBs","renderQueue","restoreStack","clearFullScreenLastFrame","clearFullScreen","vpMatrix","dprMatrix","vec3a","vec3b","vec3c","vec3d","camera","rBush","rBushRoot","contextService","canvas","defaultView","handleUnmounted","rBushNode","target","aabb","handleCulled","init","addEventListener","ElementEvent","UNMOUNTED","CULLED","dpr","getDPR","width","height","getContext","clearRect","background","destroy","removeEventListener","beginFrame","_canvas$context$rende","_this$canvasRendererP","dirtyObjectNumThreshold","dirtyObjectRatioThreshold","_renderingService$get","getStats","rendered","ratio","total","renderingPlugins","isFirstTimeRenderingFinished","disableDirtyRectangleRendering","resetTransform","setTransform","_renderByZIndex","object","isVisible","isCulled","renderDisplayObject","sortable","sorted","childNodes","child","endFrame","getOrthoMatrix","dirtyRenderBounds","safeMergeAABB","mergeDirtyAABBs","map","minX","minY","maxX","maxY","AABB","setMinMax","isEmpty","dirtyRect","convertAABB2Rect","tl","tr","bl","br","minx","miny","maxx","maxy","ix","floor","iy","iwidth","ceil","iheight","save","rect","clip","renderer","getConfig","enableDirtyRectangleRenderingDebug","dispatchEvent","CustomEvent","CanvasEvent","DIRTY_RECTANGLE","searchDirtyObjects","sort","renderOrder","restore","saveDirtyAABB","render","fillStyle","fillRect","canvasContext","parent","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINS","styleRenderer","styleRendererFactory","applyWorldTransform","_generatePath","applyAttributesToContext","Shape","LINE","PATH","POLYLINE","renderable","dirty","getMin","getMax","dirtyObjects","renderBounds","getRenderBounds","dirtyRectangle","_dirtyRectangle$getMi2","_dirtyRectangle$getMa2","search","_ref3","update","center","halfExtents","_ref4","stroke","fill","opacity","lineDash","lineDashOffset","setLineDash","isNil","globalAlpha","isNone","strokeStyle","attributes","matrix","getLocalTransform","merged","_len","aabbs","_key","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","DOMInteractionPlugin","onPointerMove","ev","pointerMove","onPointerUp","pointerUp","onPointerDown","pointerDown","onPointerOver","pointerOver","onPointerOut","pointerOut","onPointerCancel","pointerCancel","onPointerWheel","pointerWheel","onClick","click","$el","getDomElement","globalThis","navigator","msPointerEnabled","style","msContentZooming","msTouchAction","supportsPointerEvents","touchAction","addPointerEventListener","addMouseEventListener","supportsTouchEvents","addTouchEventListener","useNativeClickEvent","passive","capture","removePointerEventListener","removeMouseEventListener","removeTouchEventListener","HTMLRenderingPlugin","displayObjectHTMLElementMap","WeakMap","offset","undefined","join","nativeHTMLMap","eventService","transform","joinTransformMatrix","getOrigin","handleMounted","HTML","$camera","createCamera","getOrCreateEl","appendChild","updateAttribute","remove","handleAttributeChanged","attrName","handleBoundsChanged","FRAGMENT","node","handleCanvasResize","_this$context$config","parentElement","RESIZE","MOUNTED","ATTR_MODIFIED","BOUNDS_CHANGED","renderReasons","RenderReason","CAMERA_CHANGED","_this$context$config2","doc","$canvas","$container","parentNode","cameraId","$existedCamera","querySelector","$cameraContainer","createElement","overflow","pointerEvents","left","top","offsetLeft","offsetTop","transformOrigin","$existedElement","setAttribute","className","innerHTML","buildCSSText","isNumber","zIndex","visibility","_object$parsedStyle$p","color","isCSSRGB","getAttribute","isPattern","borderColor","lineWidth","Canvas2DContextService","canvasConfig","_this$canvasConfig","container","getElementById","resize","getBoundingClientRect","removeChild","devicePixelRatio","isBrowser","window","setDOMSize","cursor","_toDataURL","options","_args","toDataURL","encoderOptions","ContextRegisterPlugin","_AbstractRendererPlug","args","ContextService","AbstractRendererPlugin","Renderer","_AbstractRenderer","registerPlugin","ImageLoader","CanvasPathGenerator","CanvasRenderer","DomInteraction","CanvasPicker","HTMLRenderer","AbstractRenderer"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,38,40,41,42]}