/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.0.15
 * @date 10/23/2024, 11:16:32 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@antv/g-lite")):"function"==typeof define&&define.amd?define(["exports","@antv/g-lite"],r):r(((t="undefined"!=typeof globalThis?globalThis:t||self).G=t.G||{},t.G.CanvasPicker={}),t.window.G)}(this,(function(t,r){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}function o(t,r,e){return(r=n(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function i(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function a(t,r){for(var e=0;r.length>e;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function u(t,r,e){return r&&a(t.prototype,r),e&&a(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function l(t,r){if(r&&("object"==e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t,r){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},s(t,r)}function h(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);r>e;e++)n[e]=t[e];return n}function v(t,r){if(t){if("string"==typeof t)return h(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?h(t,r):void 0}}function y(){y=function(){return r};var t,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,r,e){t[r]=e.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function l(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{l({},"")}catch(t){l=function(t,r,e){return t[r]=e}}function s(t,r,e,n){var o=Object.create((r&&r.prototype instanceof b?r:b).prototype),a=new F(n||[]);return i(o,"_invoke",{value:j(t,e,a)}),o}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var v="suspendedStart",p="suspendedYield",d="executing",g="completed",m={};function b(){}function w(){}function x(){}var P={};l(P,u,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(T([])));S&&S!==n&&o.call(S,u)&&(P=S);var M=x.prototype=b.prototype=Object.create(P);function E(t){["next","throw","return"].forEach((function(r){l(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function n(i,a,u,c){var f=h(t[i],t,a);if("throw"!==f.type){var l=f.arg,s=l.value;return s&&"object"==e(s)&&o.call(s,"__await")?r.resolve(s.__await).then((function(t){n("next",t,u,c)}),(function(t){n("throw",t,u,c)})):r.resolve(s).then((function(t){l.value=t,u(l)}),(function(t){return n("throw",t,u,c)}))}c(f.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return a=a?a.then(o,o):o()}})}function j(r,e,n){var o=v;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=L(u,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===v)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var f=h(r,e,n);if("normal"===f.type){if(o=n.done?g:p,f.arg===m)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=g,n.method="throw",n.arg=f.arg)}}}function L(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,L(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,m):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function A(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function I(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function T(r){if(r||""===r){var n=r[u];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var i=-1,a=function e(){for(;++i<r.length;)if(o.call(r,i))return e.value=r[i],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(r)+" is not iterable")}return w.prototype=x,i(M,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,f,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,f,"GeneratorFunction")),t.prototype=Object.create(M),t},r.awrap=function(t){return{__await:t}},E(k.prototype),l(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(M),l(M,f,"Generator"),l(M,u,(function(){return this})),l(M,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,F.prototype={constructor:F,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!r)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(n,o){return u.type="throw",u.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(this.prev>=a.tryLoc){var c=o.call(a,"catchLoc"),f=o.call(a,"finallyLoc");if(c&&f){if(a.catchLoc>this.prev)return n(a.catchLoc,!0);if(a.finallyLoc>this.prev)return n(a.finallyLoc)}else if(c){if(a.catchLoc>this.prev)return n(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(a.finallyLoc>this.prev)return n(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(this.prev>=n.tryLoc&&o.call(n,"finallyLoc")&&n.finallyLoc>this.prev){var i=n;break}}i&&("break"===t||"continue"===t)&&r>=i.tryLoc&&i.finallyLoc>=r&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),m},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),I(e),m}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;I(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),m}},r}function p(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var d="undefined"!=typeof Float32Array?Float32Array:Array;function g(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function m(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)}),g(),function(){var t,r=(t=new d(2),d!=Float32Array&&(t[0]=0,t[1]=0),t)}();var b,w=g(),x=g(),P=g(),O=(b=new d(16),d!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0),b[0]=1,b[5]=1,b[10]=1,b[15]=1,b),S=function(){function t(){var e=this;i(this,t),this.isHit=function(t,n,o,i){var a=e.context.pointInPathPickerFactory[t.nodeName];if(a){var u=function(t,r){var e=r[0],n=r[1],o=r[2],i=r[3],a=r[4],u=r[5],c=r[6],f=r[7],l=r[8],s=r[9],h=r[10],v=r[11],y=r[12],p=r[13],d=r[14],g=r[15],m=e*u-n*a,b=e*c-o*a,w=e*f-i*a,x=n*c-o*u,P=n*f-i*u,O=o*f-i*c,S=l*p-s*y,M=l*d-h*y,E=l*g-v*y,k=s*d-h*p,j=s*g-v*p,L=h*g-v*d,A=m*L-b*j+w*k+x*E-P*M+O*S;return A?(t[0]=(u*L-c*j+f*k)*(A=1/A),t[1]=(o*j-n*L-i*k)*A,t[2]=(p*O-d*P+g*x)*A,t[3]=(h*P-s*O-v*x)*A,t[4]=(c*E-a*L-f*M)*A,t[5]=(e*L-o*E+i*M)*A,t[6]=(d*w-y*O-g*b)*A,t[7]=(l*O-h*w+v*b)*A,t[8]=(a*j-u*E+f*S)*A,t[9]=(n*E-e*j-i*S)*A,t[10]=(y*P-p*w+g*m)*A,t[11]=(s*w-l*P-v*m)*A,t[12]=(u*M-a*k-c*S)*A,t[13]=(e*k-n*M+o*S)*A,t[14]=(p*b-y*x-d*m)*A,t[15]=(l*x-s*b+h*m)*A,t):null}(O,o),c=function(t,r,e){var n=r[0],o=r[1],i=r[2],a=e[3]*n+e[7]*o+e[11]*i+e[15];return t[0]=(e[0]*n+e[4]*o+e[8]*i+e[12])/(a=a||1),t[1]=(e[1]*n+e[5]*o+e[9]*i+e[13])/a,t[2]=(e[2]*n+e[6]*o+e[10]*i+e[14])/a,t}(x,m(P,n[0],n[1],0),u);if(a(t,new r.Point(c[0],c[1]),i,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,r){var n=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),o=e.context.pathGeneratorFactory[t.nodeName];return o&&(n.beginPath(),o(n,t.parsedStyle),n.closePath()),n.isPointInPath(r.x,r.y)}}return u(t,[{key:"apply",value:function(r,e){var n,o=this,i=r.renderingService,a=r.renderingContext;this.context=r,this.runtime=e;var u=null===(n=a.root)||void 0===n?void 0:n.ownerDocument;i.hooks.pick.tapPromise(t.tag,function(){var t,r=(t=y().mark((function t(r){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",o.pick(u,r));case 1:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){p(i,n,o,a,u,"next",t)}function u(t){p(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()),i.hooks.pickSync.tap(t.tag,(function(t){return o.pick(u,t)}))}},{key:"pick",value:function(t,e){var n,o=e.topmost,i=e.position,a=m(w,i.x,i.y,0),u=[],c=function(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=v(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return t.length>n?{done:!1,value:t[n++]}:{done:!0}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}(t.elementsFromBBox(a[0],a[1],a[0],a[1]));try{for(c.s();!(n=c.n()).done;){var f=n.value,l=f.getWorldTransform();if(this.isHit(f,a,l,!1)){var s=r.findClosestClipPathTarget(f);if(s){var h=s.parsedStyle.clipPath;if(this.isHit(h,a,h.getWorldTransform(),!0)){if(o)return e.picked=[f],e;u.push(f)}}else{if(o)return e.picked=[f],e;u.push(f)}}}}catch(t){c.e(t)}finally{c.f()}return e.picked=u,e}}])}();function M(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i,a,u=[],c=!0,f=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;c=!1}else for(;!(c=(n=i.call(e)).done)&&(u.push(n.value),u.length!==r);c=!0);}catch(t){f=!0,o=t}finally{try{if(!c&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(f)throw o}}return u}}(t,r)||v(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}S.tag="CanvasPicker";var k=function(t,r,e){return r>t?r:t>e?e:t};function j(t,r,e){return{x:t*Math.cos(e)-r*Math.sin(e),y:t*Math.sin(e)+r*Math.cos(e)}}function L(t,r,e,n,o,i,a,u,c,f){var l,s,h,v,y,p=t,d=r,g=e,m=n,b=u,w=c,x=120*Math.PI/180,P=Math.PI/180*(+o||0),O=[];if(f)s=f[0],h=f[1],v=f[2],y=f[3];else{d=(l=j(p,d,-P)).y;var S=((p=l.x)-(b=(l=j(b,w,-P)).x))/2,M=(d-(w=l.y))/2,E=S*S/(g*g)+M*M/(m*m);E>1&&(g*=E=Math.sqrt(E),m*=E);var k=g*g,A=m*m,I=(i===a?-1:1)*Math.sqrt(Math.abs((k*A-k*M*M-A*S*S)/(k*M*M+A*S*S)));v=I*g*M/m+(p+b)/2,s=Math.asin(((d-(y=I*-m*S/g+(d+w)/2))/m*1e9>>0)/1e9),h=Math.asin(((w-y)/m*1e9>>0)/1e9),0>(s=v>p?Math.PI-s:s)&&(s=2*Math.PI+s),0>(h=v>b?Math.PI-h:h)&&(h=2*Math.PI+h),a&&s>h&&(s-=2*Math.PI),!a&&h>s&&(h-=2*Math.PI)}var F=h-s;if(Math.abs(F)>x){var T=h,C=b,_=w;O=L(b=v+g*Math.cos(h=s+x*(a&&h>s?1:-1)),w=y+m*Math.sin(h),g,m,o,0,a,C,_,[h,T,v,y])}F=h-s;var G=Math.cos(s),W=Math.sin(s),N=Math.cos(h),H=Math.sin(h),R=Math.tan(F/4),q=4/3*g*R,D=4/3*m*R,B=[p,d],Y=[p+q*W,d-D*G],U=[b+q*H,w-D*N],Q=[b,w];if(Y[0]=2*B[0]-Y[0],Y[1]=2*B[1]-Y[1],f)return Y.concat(U,Q,O);for(var X=[],Z=0,$=(O=Y.concat(U,Q,O)).length;$>Z;Z+=1)X[Z]=Z%2?j(O[Z-1],O[Z],P).y:j(O[Z],O[Z+1],P).x;return X}
/*!
   * @antv/g-math
   * @description Geometry util
   * @version 3.0.0
   * @date 10/23/2024, 11:13:25 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */function A(t,r,e,n){var o=t-e,i=r-n;return Math.sqrt(o*o+i*i)}var I=1e-4;function F(t,r,e,n,o,i){var a=-1,u=1/0,c=[e,n],f=20;i&&i>200&&(f=i/10);for(var l=1/f,s=l/10,h=0;f>=h;h++){var v=h*l,y=[o.apply(void 0,E(t.concat([v]))),o.apply(void 0,E(r.concat([v])))],p=A(c[0],c[1],y[0],y[1]);u>p&&(a=v,u=p)}if(0===a)return{x:t[0],y:r[0]};if(1===a){var d=t.length;return{x:t[d-1],y:r[d-1]}}u=1/0;for(var g=0;32>g&&I<=s;g++){var m=a-s,b=a+s,w=[o.apply(void 0,E(t.concat([m]))),o.apply(void 0,E(r.concat([m])))],x=A(c[0],c[1],w[0],w[1]);if(m>=0&&u>x)a=m,u=x;else{var P=[o.apply(void 0,E(t.concat([b]))),o.apply(void 0,E(r.concat([b])))],O=A(c[0],c[1],P[0],P[1]);1>=b&&u>O?(a=b,u=O):s*=.5}}return{x:o.apply(void 0,E(t.concat([a]))),y:o.apply(void 0,E(r.concat([a])))}}function T(t,r,e,n,o,i){var a=[e-t,n-r];if(function(t,r){return t[0]===r[0]&&t[1]===r[1]}(a,[0,0]))return Math.sqrt((o-t)*(o-t)+(i-r)*(i-r));var u=[-a[1],a[0]];return function(t,r){var e=r[0],n=r[1],o=e*e+n*n;o>0&&(o=1/Math.sqrt(o)),t[0]=r[0]*o,t[1]=r[1]*o}(u,u),Math.abs(function(t,r){return t[0]*r[0]+t[1]*r[1]}([o-t,i-r],u))}function C(t,r,e,n,o){var i=1-o;return i*i*i*t+3*r*o*i*i+3*e*o*o*i+n*o*o*o}function _(t,r,e,n,o,i,a,u,c,f,l){var s=function(t,r,e,n,o,i,a,u,c,f,l){return F([t,e,o,a],[r,n,i,u],c,f,C,l)}(t,r,e,n,o,i,a,u,c,f,l);return A(s.x,s.y,c,f)}function G(t,r,e,n){var o=1-n;return o*o*t+2*n*o*r+n*n*e}function W(t,r,e,n,o,i,a,u){var c=function(t,r,e,n,o,i,a,u){return F([t,e,o],[r,n,i],a,u,G)}(t,r,e,n,o,i,a,u);return A(c.x,c.y,a,u)}function N(t,e,n){var o=t.parsedStyle,i=o.cx,a=o.cy,u=o.r,c=o.fill,f=o.stroke,l=o.lineWidth,s=o.increasedLineWidthForHitTesting,h=o.pointerEvents,v=void 0===h?"auto":h,y=((void 0===l?1:l)+(void 0===s?0:s))/2,p=A(void 0===i?0:i,void 0===a?0:a,e.x,e.y),d=M(r.isFillOrStrokeAffected(v,c,f),2),g=d[0],m=d[1];return g&&m||n?u+y>=p:g?u>=p:!!m&&(p>=u-y&&u+y>=p)}function H(t,r,e,n){return t/(e*e)+r/(n*n)}function R(t,e,n){var o=t.parsedStyle,i=o.cx,a=void 0===i?0:i,u=o.cy,c=void 0===u?0:u,f=o.rx,l=o.ry,s=o.lineWidth,h=void 0===s?1:s,v=o.increasedLineWidthForHitTesting,y=void 0===v?0:v,p=o.pointerEvents,d=e.x,g=e.y,m=M(r.isFillOrStrokeAffected(void 0===p?"auto":p,o.fill,o.stroke),2),b=m[0],w=m[1],x=(h+y)/2,P=(d-a)*(d-a),O=(g-c)*(g-c);return b&&w||n?1>=H(P,O,f+x,l+x):b?1>=H(P,O,f,l):!!w&&(H(P,O,f-x,l-x)>=1&&1>=H(P,O,f+x,l+x))}function q(t,r,e,n,o,i){return!(t>o||o>t+e||r>i||i>r+n)}function D(t,r,e,n,o,i,a,u){var c=(Math.atan2(u-r,a-t)+2*Math.PI)%(2*Math.PI),f={x:t+e*Math.cos(c),y:r+e*Math.sin(c)};return A(f.x,f.y,a,u)<=i/2}function B(t,r,e,n,o,i,a){var u=o/2;return!(Math.min(t,e)-u>i||i>Math.max(t,e)+u||Math.min(r,n)-u>a||a>Math.max(r,n)+u)&&T(t,r,e,n,i,a)<=o/2}function Y(t,r,e,n,o){var i=t.length;if(2>i)return!1;for(var a=0;i-1>a;a++){if(B(t[a][0],t[a][1],t[a+1][0],t[a+1][1],r,e,n))return!0}if(o){var u=t[0],c=t[i-1];if(B(u[0],u[1],c[0],c[1],r,e,n))return!0}return!1}var U=1e-6;function Q(t){return U>Math.abs(t)?0:0>t?-1:1}function X(t,r,e){return!((e[0]-t[0])*(r[1]-t[1])!=(r[0]-t[0])*(e[1]-t[1])||Math.min(t[0],r[0])>e[0]||e[0]>Math.max(t[0],r[0])||Math.min(t[1],r[1])>e[1]||e[1]>Math.max(t[1],r[1]))}function Z(t,r,e){var n=!1,o=t.length;if(2>=o)return!1;for(var i=0;o>i;i++){var a=t[i],u=t[(i+1)%o];if(X(a,u,[r,e]))return!0;Q(a[1]-e)>0!=Q(u[1]-e)>0&&0>Q(r-(e-a[1])*(a[0]-u[0])/(a[1]-u[1])-a[0])&&(n=!n)}return n}function $(t,r,e){for(var n=!1,o=0;t.length>o;o++){if(n=Z(t[o],r,e))break}return n}function z(t,e,n){var o=t.parsedStyle,i=o.x1,a=o.y1,u=o.x2,c=o.y2,f=o.lineWidth,l=void 0===f?1:f,s=o.increasedLineWidthForHitTesting,h=void 0===s?0:s,v=o.pointerEvents;return!(!M(r.isFillOrStrokeAffected(void 0===v?"auto":v,o.fill,o.stroke),2)[1]&&!n||!l)&&B(i,a,u,c,l+h,e.x,e.y)}function J(t,e,n,o,i,a){var u=t.parsedStyle,c=u.lineWidth,f=void 0===c?1:c,l=u.increasedLineWidthForHitTesting,s=void 0===l?0:l,h=u.d,v=u.pointerEvents,y=h.segments,p=h.hasArc,d=h.polylines,g=h.polygons,m=M(r.isFillOrStrokeAffected(void 0===v?"auto":v,(null==g?void 0:g.length)&&u.fill,u.stroke),2),b=m[0],w=m[1],x=r.getOrCalculatePathTotalLength(t),P=!1;return b||n?P=p?o(t,e):$(g,e.x,e.y)||$(d,e.x,e.y):((w||n)&&(P=function(t,r,e,n,o){for(var i=!1,a=r/2,u=0;t.length>u;u++){var c=t[u],f=c.currentPoint,l=c.params,s=c.prePoint,h=c.box;if(!h||q(h.x-a,h.y-a,h.width+r,h.height+r,e,n))switch(c.command){case"L":case"Z":if(i=B(s[0],s[1],f[0],f[1],r,e,n))return!0;break;case"Q":if(i=r/2>=W(s[0],s[1],l[1],l[2],l[3],l[4],e,n))return!0;break;case"C":if(i=r/2>=_(s[0],s[1],l[1],l[2],l[3],l[4],l[5],l[6],e,n,o))return!0;break;case"A":c.cubicParams||(c.cubicParams=L(s[0],s[1],l[1],l[2],l[3],l[4],l[5],l[6],l[7],void 0));for(var v=c.cubicParams,y=s,p=0;v.length>p;p+=6){var d=_(y[0],y[1],v[p],v[p+1],v[p+2],v[p+3],v[p+4],v[p+5],e,n,o);if(y=[v[p+4],v[p+5]],i=r/2>=d)return!0}}}return i}(y,f+s,e.x,e.y,x)),P)}function K(t,e,n){var o=t.parsedStyle,i=o.lineWidth,a=void 0===i?1:i,u=o.increasedLineWidthForHitTesting,c=void 0===u?0:u,f=o.points,l=o.pointerEvents,s=M(r.isFillOrStrokeAffected(void 0===l?"auto":l,o.fill,o.stroke),2),h=s[0],v=!1;return(s[1]||n)&&(v=Y(f.points,a+c,e.x,e.y,!0)),v||!h&&!n||(v=Z(f.points,e.x,e.y)),v}function V(t,e,n){var o=t.parsedStyle,i=o.lineWidth,a=void 0===i?1:i,u=o.increasedLineWidthForHitTesting,c=void 0===u?0:u,f=o.points,l=o.pointerEvents;return!(!M(r.isFillOrStrokeAffected(void 0===l?"auto":l,o.fill,o.stroke),2)[1]&&!n||!a)&&Y(f.points,a+c,e.x,e.y,!1)}function tt(t,e,n,o,i){var a=t.parsedStyle,u=a.radius,c=a.lineWidth,f=void 0===c?1:c,l=a.increasedLineWidthForHitTesting,s=void 0===l?0:l,h=a.x,v=void 0===h?0:h,y=a.y,p=void 0===y?0:y,d=a.width,g=a.height,m=a.pointerEvents,b=M(r.isFillOrStrokeAffected(void 0===m?"auto":m,a.fill,a.stroke),2),w=b[0],x=b[1],P=f+s;if(u&&u.some((function(t){return 0!==t}))){var O=!1;return(x||n)&&(O=function(t,r,e,n,o,i,a,u){var c=M(o,4),f=c[0],l=c[1],s=c[2],h=c[3];return B(t+f,r,t+e-l,r,i,a,u)||B(t+e,r+l,t+e,r+n-s,i,a,u)||B(t+e-s,r+n,t+h,r+n,i,a,u)||B(t,r+n-h,t,r+f,i,a,u)||D(t+e-l,r+l,l,0,0,i,a,u)||D(t+e-s,r+n-s,s,0,0,i,a,u)||D(t+h,r+n-h,h,0,0,i,a,u)||D(t+f,r+f,f,0,0,i,a,u)}(v,p,d,g,u.map((function(t){return k(t,0,Math.min(Math.abs(d)/2,Math.abs(g)/2))})),P,e.x,e.y)),O||!w&&!n||(O=o(t,e)),O}var S=P/2;return w&&x||n?q(v-S,p-S,d+S,g+S,e.x,e.y):w?q(v,p,d,g,e.x,e.y):!!x&&function(t,r,e,n,o,i,a){var u=o/2;return q(t-u,r-u,e,o,i,a)||q(t+e-u,r-u,o,n,i,a)||q(t+u,r+n-u,e,o,i,a)||q(t-u,r+u,o,n,i,a)}(v,p,d,g,P,e.x,e.y)}function rt(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function et(t){for(var r=1;arguments.length>r;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?rt(Object(e),!0).forEach((function(r){o(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):rt(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function nt(t,e,n,o,i,a){var u=t.parsedStyle,c=u.pointerEvents,f=u.x,l=void 0===f?0:f,s=u.y,h=void 0===s?0:s,v=u.width,y=u.height;if("non-transparent-pixel"===(void 0===c?"auto":c)){var p=i.config.offscreenCanvas,d=a.offscreenCanvasCreator.getOrCreateCanvas(p),g=a.offscreenCanvasCreator.getOrCreateContext(p,{willReadFrequently:!0});return d.width=v,d.height=y,i.defaultStyleRendererFactory[r.Shape.IMAGE].render(g,et(et({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),g.getImageData(e.x-l,e.y-h,1,1).data.every((function(t){return 0!==t}))}return!0}function ot(t,r,e,n){var o=t.getGeometryBounds();return!(o.min[0]>r.x||o.min[1]>r.y||r.x>o.max[0]||r.y>o.max[1])}var it=function(t){function e(){var t,r,n,o;i(this,e);for(var a=arguments.length,u=Array(a),s=0;a>s;s++)u[s]=arguments[s];return r=this,n=e,o=[].concat(u),n=c(n),(t=l(r,f()?Reflect.construct(n,o||[],c(r).constructor):n.apply(r,o))).name="canvas-picker",t}return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&s(t,r)}(e,t),u(e,[{key:"init",value:function(){var t,e=(o(o(o(o(o(o(o(o(o(o(t={},r.Shape.CIRCLE,N),r.Shape.ELLIPSE,R),r.Shape.RECT,tt),r.Shape.LINE,z),r.Shape.POLYLINE,V),r.Shape.POLYGON,K),r.Shape.PATH,J),r.Shape.TEXT,ot),r.Shape.GROUP,null),r.Shape.IMAGE,nt),o(o(t,r.Shape.HTML,null),r.Shape.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new S)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(r.AbstractRendererPlugin);t.Plugin=it}));
//# sourceMappingURL=index.umd.min.js.map
