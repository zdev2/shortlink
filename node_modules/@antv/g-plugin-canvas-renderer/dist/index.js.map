{"version":3,"file":"index.js","sources":["../src/CanvasRendererPlugin.ts","../src/shapes/styles/Default.ts","../src/utils/math.ts","../src/shapes/styles/Image.ts","../src/shapes/styles/Text.ts","../src/shapes/styles/Rect.ts","../src/shapes/styles/Circle.ts","../src/shapes/styles/Ellipse.ts","../src/shapes/styles/Line.ts","../src/shapes/styles/Polyline.ts","../src/shapes/styles/Polygon.ts","../src/shapes/styles/Path.ts","../src/index.ts"],"sourcesContent":["import type {\n  CSSRGB,\n  DisplayObject,\n  FederatedEvent,\n  ParsedBaseStyleProps,\n  RBushNodeAABB,\n  RenderingPlugin,\n  RBush,\n  RenderingPluginContext,\n  ContextService,\n  CanvasContext,\n  GlobalRuntime,\n} from '@antv/g-lite';\nimport {\n  AABB,\n  CanvasEvent,\n  CustomEvent,\n  ElementEvent,\n  Shape,\n  Node,\n} from '@antv/g-lite';\nimport type { PathGenerator } from '@antv/g-plugin-canvas-path-generator';\nimport { isNil } from '@antv/util';\nimport { mat4, vec3 } from 'gl-matrix';\nimport type { CanvasRendererPluginOptions } from './interfaces';\n\ninterface Rect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/**\n * support 2 modes in rendering:\n * * immediate\n * * delayed: render at the end of frame with dirty-rectangle\n */\nexport class CanvasRendererPlugin implements RenderingPlugin {\n  static tag = 'CanvasRenderer';\n\n  private context: RenderingPluginContext;\n\n  private pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n\n  /**\n   * RBush used in dirty rectangle rendering\n   */\n  private rBush: RBush<RBushNodeAABB>;\n\n  constructor(\n    private canvasRendererPluginOptions: CanvasRendererPluginOptions, // private styleRendererFactory: Record<Shape, StyleRenderer>,\n  ) {}\n\n  private removedRBushNodeAABBs: RBushNodeAABB[] = [];\n\n  private renderQueue: DisplayObject[] = [];\n\n  /**\n   * This stack is only used by clipPath for now.\n   */\n  private restoreStack: DisplayObject[] = [];\n\n  private clearFullScreenLastFrame = false;\n  private clearFullScreen = false;\n\n  /**\n   * view projection matrix\n   */\n  private vpMatrix = mat4.create();\n  private dprMatrix = mat4.create();\n  private tmpMat4 = mat4.create();\n  private vec3a = vec3.create();\n  private vec3b = vec3.create();\n  private vec3c = vec3.create();\n  private vec3d = vec3.create();\n\n  apply(context: RenderingPluginContext, runtime: GlobalRuntime) {\n    this.context = context;\n\n    const {\n      config,\n      camera,\n      renderingService,\n      renderingContext,\n      rBushRoot,\n      // @ts-ignore\n      pathGeneratorFactory,\n    } = context;\n    this.rBush = rBushRoot;\n    this.pathGeneratorFactory = pathGeneratorFactory;\n    const contextService =\n      context.contextService as ContextService<CanvasRenderingContext2D>;\n\n    const canvas = renderingContext.root.ownerDocument.defaultView;\n\n    const handleUnmounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n\n      // remove r-bush node\n      // @ts-ignore\n      const { rBushNode } = object;\n\n      if (rBushNode.aabb) {\n        // save removed aabbs for dirty-rectangle rendering later\n        this.removedRBushNodeAABBs.push(rBushNode.aabb);\n      }\n    };\n\n    const handleCulled = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      // @ts-ignore\n      const { rBushNode } = object;\n\n      if (rBushNode.aabb) {\n        // save removed aabbs for dirty-rectangle rendering later\n        this.removedRBushNodeAABBs.push(rBushNode.aabb);\n      }\n    };\n\n    renderingService.hooks.init.tap(CanvasRendererPlugin.tag, () => {\n      canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.addEventListener(ElementEvent.CULLED, handleCulled);\n\n      // clear fullscreen\n      const dpr = contextService.getDPR();\n      const { width, height } = config;\n      const context = contextService.getContext();\n      this.clearRect(\n        context,\n        0,\n        0,\n        width * dpr,\n        height * dpr,\n        config.background,\n      );\n    });\n\n    renderingService.hooks.destroy.tap(CanvasRendererPlugin.tag, () => {\n      canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.removeEventListener(ElementEvent.CULLED, handleCulled);\n      this.renderQueue = [];\n      this.removedRBushNodeAABBs = [];\n      this.restoreStack = [];\n    });\n\n    renderingService.hooks.beginFrame.tap(CanvasRendererPlugin.tag, () => {\n      const context = contextService.getContext();\n      const dpr = contextService.getDPR();\n      const { width, height } = config;\n      const { dirtyObjectNumThreshold, dirtyObjectRatioThreshold } =\n        this.canvasRendererPluginOptions;\n\n      // some heuristic conditions such as 80% object changed\n      const { total, rendered } = renderingService.getStats();\n      const ratio = rendered / total;\n\n      this.clearFullScreen =\n        this.clearFullScreenLastFrame ||\n        // @ts-ignore\n        !canvas.context.renderingPlugins[1]?.isFirstTimeRenderingFinished ||\n        renderingService.disableDirtyRectangleRendering() ||\n        (rendered > dirtyObjectNumThreshold &&\n          ratio > dirtyObjectRatioThreshold);\n\n      if (context) {\n        context.resetTransform\n          ? context.resetTransform()\n          : context.setTransform(1, 0, 0, 1, 0, 0);\n        if (this.clearFullScreen) {\n          this.clearRect(\n            context,\n            0,\n            0,\n            width * dpr,\n            height * dpr,\n            config.background,\n          );\n        }\n      }\n    });\n\n    const renderByZIndex = (\n      object: DisplayObject,\n      context: CanvasRenderingContext2D,\n    ) => {\n      if (object.isVisible() && !object.isCulled()) {\n        this.renderDisplayObject(\n          object,\n          context,\n          this.context,\n          this.restoreStack,\n          runtime,\n        );\n      }\n\n      const sorted = object.sortable.sorted || object.childNodes;\n\n      // should account for z-index\n      sorted.forEach((child: DisplayObject) => {\n        renderByZIndex(child, context);\n      });\n    };\n\n    // render at the end of frame\n    renderingService.hooks.endFrame.tap(CanvasRendererPlugin.tag, () => {\n      // Skip rendering.\n      if (renderingContext.root.childNodes.length === 0) {\n        this.clearFullScreenLastFrame = true;\n        return;\n      }\n\n      this.clearFullScreenLastFrame = false;\n\n      const context = contextService.getContext();\n      // clear & clip dirty rectangle\n      const dpr = contextService.getDPR();\n      mat4.fromScaling(this.dprMatrix, [dpr, dpr, 1]);\n      mat4.multiply(this.vpMatrix, this.dprMatrix, camera.getOrthoMatrix());\n\n      if (this.clearFullScreen) {\n        // console.log('canvas renderer fcp...', renderingContext.root.childNodes);\n        renderByZIndex(renderingContext.root, context);\n      } else {\n        // console.log('canvas renderer next...', this.renderQueue);\n        // merge removed AABB\n        const dirtyRenderBounds = this.safeMergeAABB(\n          this.mergeDirtyAABBs(this.renderQueue),\n          ...this.removedRBushNodeAABBs.map(({ minX, minY, maxX, maxY }) => {\n            const aabb = new AABB();\n            aabb.setMinMax(\n              // vec3.fromValues(minX, minY, 0),\n              // vec3.fromValues(maxX, maxY, 0),\n              [minX, minY, 0],\n              [maxX, maxY, 0],\n            );\n            return aabb;\n          }),\n        );\n        this.removedRBushNodeAABBs = [];\n\n        if (AABB.isEmpty(dirtyRenderBounds)) {\n          this.renderQueue = [];\n          return;\n        }\n\n        const dirtyRect = this.convertAABB2Rect(dirtyRenderBounds);\n        const { x, y, width, height } = dirtyRect;\n\n        const tl = vec3.transformMat4(this.vec3a, [x, y, 0], this.vpMatrix);\n        const tr = vec3.transformMat4(\n          this.vec3b,\n          [x + width, y, 0],\n          this.vpMatrix,\n        );\n        const bl = vec3.transformMat4(\n          this.vec3c,\n          [x, y + height, 0],\n          this.vpMatrix,\n        );\n        const br = vec3.transformMat4(\n          this.vec3d,\n          [x + width, y + height, 0],\n          this.vpMatrix,\n        );\n\n        const minx = Math.min(tl[0], tr[0], br[0], bl[0]);\n        const miny = Math.min(tl[1], tr[1], br[1], bl[1]);\n        const maxx = Math.max(tl[0], tr[0], br[0], bl[0]);\n        const maxy = Math.max(tl[1], tr[1], br[1], bl[1]);\n\n        const ix = Math.floor(minx);\n        const iy = Math.floor(miny);\n        const iwidth = Math.ceil(maxx - minx);\n        const iheight = Math.ceil(maxy - miny);\n\n        context.save();\n        this.clearRect(context, ix, iy, iwidth, iheight, config.background);\n        context.beginPath();\n        context.rect(ix, iy, iwidth, iheight);\n        context.clip();\n\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n        context.setTransform(\n          this.vpMatrix[0],\n          this.vpMatrix[1],\n          this.vpMatrix[4],\n          this.vpMatrix[5],\n          this.vpMatrix[12],\n          this.vpMatrix[13],\n        );\n\n        // draw dirty rectangle\n        const { enableDirtyRectangleRenderingDebug } =\n          config.renderer.getConfig();\n        if (enableDirtyRectangleRenderingDebug) {\n          canvas.dispatchEvent(\n            new CustomEvent(CanvasEvent.DIRTY_RECTANGLE, {\n              dirtyRect: {\n                x: ix,\n                y: iy,\n                width: iwidth,\n                height: iheight,\n              },\n            }),\n          );\n        }\n\n        // search objects intersect with dirty rectangle\n        const dirtyObjects = this.searchDirtyObjects(dirtyRenderBounds);\n\n        // do rendering\n        dirtyObjects\n          // sort by z-index\n          .sort((a, b) => a.sortable.renderOrder - b.sortable.renderOrder)\n          .forEach((object) => {\n            // culled object should not be rendered\n            if (object && object.isVisible() && !object.isCulled()) {\n              this.renderDisplayObject(\n                object,\n                context,\n                this.context,\n                this.restoreStack,\n                runtime,\n              );\n            }\n          });\n\n        context.restore();\n\n        // save dirty AABBs in last frame\n        this.renderQueue.forEach((object) => {\n          this.saveDirtyAABB(object);\n        });\n\n        // clear queue\n        this.renderQueue = [];\n      }\n\n      // pop restore stack, eg. root -> parent -> child\n      this.restoreStack.forEach(() => {\n        context.restore();\n      });\n      // clear restore stack\n      this.restoreStack = [];\n    });\n\n    renderingService.hooks.render.tap(\n      CanvasRendererPlugin.tag,\n      (object: DisplayObject) => {\n        if (!this.clearFullScreen) {\n          // render at the end of frame\n          this.renderQueue.push(object);\n        }\n      },\n    );\n  }\n\n  private clearRect(\n    context: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    background: string,\n  ) {\n    // clearRect is faster than fillRect @see https://stackoverflow.com/a/30830253\n    context.clearRect(x, y, width, height);\n    if (background) {\n      context.fillStyle = background;\n      context.fillRect(x, y, width, height);\n    }\n  }\n\n  renderDisplayObject(\n    object: DisplayObject,\n    context: CanvasRenderingContext2D,\n    canvasContext: CanvasContext,\n    restoreStack: DisplayObject[],\n    runtime: GlobalRuntime,\n  ) {\n    const { nodeName } = object;\n\n    // console.log('canvas render:', object);\n\n    // restore to its ancestor\n\n    const parent = restoreStack[restoreStack.length - 1];\n    if (\n      parent &&\n      !(\n        object.compareDocumentPosition(parent) & Node.DOCUMENT_POSITION_CONTAINS\n      )\n    ) {\n      context.restore();\n      restoreStack.pop();\n    }\n\n    // @ts-ignore\n    const styleRenderer = this.context.styleRendererFactory[nodeName];\n    const generatePath = this.pathGeneratorFactory[nodeName];\n\n    // clip path\n    const { clipPath } = object.parsedStyle as ParsedBaseStyleProps;\n    if (clipPath) {\n      this.applyWorldTransform(context, clipPath);\n\n      // generate path in local space\n      const generatePath = this.pathGeneratorFactory[clipPath.nodeName];\n      if (generatePath) {\n        context.save();\n\n        // save clip\n        restoreStack.push(object);\n\n        context.beginPath();\n        generatePath(context, clipPath.parsedStyle);\n        context.closePath();\n        context.clip();\n      }\n    }\n\n    // fill & stroke\n\n    if (styleRenderer) {\n      this.applyWorldTransform(context, object);\n\n      context.save();\n\n      // apply attributes to context\n      this.applyAttributesToContext(context, object);\n    }\n\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, object.parsedStyle);\n      if (\n        object.nodeName !== Shape.LINE &&\n        object.nodeName !== Shape.PATH &&\n        object.nodeName !== Shape.POLYLINE\n      ) {\n        context.closePath();\n      }\n    }\n\n    // fill & stroke\n    if (styleRenderer) {\n      styleRenderer.render(\n        context,\n        object.parsedStyle,\n        object,\n        canvasContext,\n        this,\n        runtime,\n      );\n\n      // restore applied attributes, eg. shadowBlur shadowColor...\n      context.restore();\n    }\n\n    // finish rendering, clear dirty flag\n    object.renderable.dirty = false;\n  }\n\n  private convertAABB2Rect(aabb: AABB): Rect {\n    const min = aabb.getMin();\n    const max = aabb.getMax();\n    // expand the rectangle a bit to avoid artifacts\n    // @see https://www.yuque.com/antv/ou292n/bi8nix#ExvCu\n    const minX = Math.floor(min[0]);\n    const minY = Math.floor(min[1]);\n    const maxX = Math.ceil(max[0]);\n    const maxY = Math.ceil(max[1]);\n    const width = maxX - minX;\n    const height = maxY - minY;\n\n    return { x: minX, y: minY, width, height };\n  }\n\n  /**\n   * TODO: merge dirty rectangles with some strategies.\n   * For now, we just simply merge all the rectangles into one.\n   * @see https://idom.me/articles/841.html\n   */\n  private mergeDirtyAABBs(dirtyObjects: DisplayObject[]): AABB {\n    // merge into a big AABB\n    // TODO: skip descendant if ancestor is caculated, but compareNodePosition is really slow\n    const aabb = new AABB();\n    dirtyObjects.forEach((object) => {\n      const renderBounds = object.getRenderBounds();\n      aabb.add(renderBounds);\n\n      const { dirtyRenderBounds } = object.renderable;\n      if (dirtyRenderBounds) {\n        aabb.add(dirtyRenderBounds);\n      }\n    });\n\n    return aabb;\n  }\n\n  private searchDirtyObjects(dirtyRectangle: AABB): DisplayObject[] {\n    // search in r-tree, get all affected nodes\n    const [minX, minY] = dirtyRectangle.getMin();\n    const [maxX, maxY] = dirtyRectangle.getMax();\n    const rBushNodes = this.rBush.search({\n      minX,\n      minY,\n      maxX,\n      maxY,\n    });\n\n    return rBushNodes.map(({ displayObject }) => displayObject);\n  }\n\n  private saveDirtyAABB(object: DisplayObject) {\n    const { renderable } = object;\n    if (!renderable.dirtyRenderBounds) {\n      renderable.dirtyRenderBounds = new AABB();\n    }\n    const renderBounds = object.getRenderBounds();\n    if (renderBounds) {\n      // save last dirty aabb\n      renderable.dirtyRenderBounds.update(\n        renderBounds.center,\n        renderBounds.halfExtents,\n      );\n    }\n  }\n\n  /**\n   * TODO: batch the same global attributes\n   */\n  private applyAttributesToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n  ) {\n    const { stroke, fill, opacity, lineDash, lineDashOffset } =\n      object.parsedStyle as ParsedBaseStyleProps;\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setLineDash\n    if (lineDash) {\n      context.setLineDash(lineDash);\n    }\n\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineDashOffset\n    if (!isNil(lineDashOffset)) {\n      context.lineDashOffset = lineDashOffset;\n    }\n\n    if (!isNil(opacity)) {\n      context.globalAlpha *= opacity;\n    }\n\n    if (\n      !isNil(stroke) &&\n      !Array.isArray(stroke) &&\n      !(stroke as CSSRGB).isNone\n    ) {\n      context.strokeStyle = object.attributes.stroke;\n    }\n\n    if (!isNil(fill) && !Array.isArray(fill) && !(fill as CSSRGB).isNone) {\n      context.fillStyle = object.attributes.fill;\n    }\n  }\n\n  private applyWorldTransform(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    matrix?: mat4,\n  ) {\n    // apply clip shape's RTS\n    if (matrix) {\n      mat4.copy(this.tmpMat4, object.getLocalTransform());\n      mat4.multiply(this.tmpMat4, matrix, this.tmpMat4);\n      mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n    } else {\n      // apply RTS transformation in world space\n      mat4.copy(this.tmpMat4, object.getWorldTransform());\n      mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n    }\n\n    // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n    context.setTransform(\n      this.tmpMat4[0],\n      this.tmpMat4[1],\n      this.tmpMat4[4],\n      this.tmpMat4[5],\n      this.tmpMat4[12],\n      this.tmpMat4[13],\n    );\n  }\n\n  private safeMergeAABB(...aabbs: AABB[]): AABB {\n    const merged = new AABB();\n    aabbs.forEach((aabb) => {\n      merged.add(aabb);\n    });\n    return merged;\n  }\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  CSSRGB,\n  DisplayObject,\n  GlobalRuntime,\n  LinearGradient,\n  ParsedBaseStyleProps,\n  Pattern,\n  RadialGradient,\n  Rect,\n  GradientType,\n  isPattern,\n  Shape,\n} from '@antv/g-lite';\nimport type { ImagePool } from '@antv/g-plugin-image-loader';\nimport { isNil } from '@antv/util';\nimport { CanvasRendererPlugin } from '../../CanvasRendererPlugin';\nimport type { StyleRenderer } from './interfaces';\n\nexport class DefaultRenderer implements StyleRenderer {\n  constructor(private imagePool: ImagePool) {}\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedBaseStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const {\n      fill,\n      fillRule,\n      opacity = 1,\n      fillOpacity = 1,\n      stroke,\n      strokeOpacity = 1,\n      lineWidth = 1,\n      lineCap,\n      lineJoin,\n      shadowType,\n      shadowColor,\n      shadowBlur,\n      filter,\n      miterLimit,\n    } = parsedStyle;\n    const hasFill = fill && !(fill as CSSRGB).isNone;\n    const hasStroke = stroke && !(stroke as CSSRGB).isNone && lineWidth > 0;\n\n    const isFillTransparent = (fill as CSSRGB)?.alpha === 0;\n    const hasFilter = !!(filter && filter.length);\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    const { nodeName } = object;\n    const isInnerShadow = shadowType === 'inner';\n    const shouldDrawShadowWithStroke =\n      hasStroke &&\n      hasShadow &&\n      (nodeName === Shape.PATH ||\n        nodeName === Shape.LINE ||\n        nodeName === Shape.POLYLINE ||\n        isFillTransparent ||\n        isInnerShadow);\n\n    if (hasFill) {\n      context.globalAlpha = opacity * fillOpacity;\n\n      if (!shouldDrawShadowWithStroke) {\n        setShadowAndFilter(object, context, hasShadow);\n      }\n\n      applyFill(\n        context,\n        object,\n        fill,\n        fillRule,\n        canvasContext,\n        plugin,\n        runtime,\n        this.imagePool,\n      );\n\n      if (!shouldDrawShadowWithStroke) {\n        this.clearShadowAndFilter(context, hasFilter, hasShadow);\n      }\n    }\n\n    if (hasStroke) {\n      context.globalAlpha = opacity * strokeOpacity;\n      context.lineWidth = lineWidth;\n      if (!isNil(miterLimit)) {\n        context.miterLimit = miterLimit;\n      }\n\n      if (!isNil(lineCap)) {\n        context.lineCap = lineCap;\n      }\n\n      if (!isNil(lineJoin)) {\n        context.lineJoin = lineJoin;\n      }\n\n      if (shouldDrawShadowWithStroke) {\n        if (isInnerShadow) {\n          context.globalCompositeOperation = 'source-atop';\n        }\n        setShadowAndFilter(object, context, true);\n\n        if (isInnerShadow) {\n          applyStroke(\n            context,\n            object,\n            stroke,\n            canvasContext,\n            plugin,\n            runtime,\n            this.imagePool,\n          );\n          context.globalCompositeOperation = 'source-over';\n          this.clearShadowAndFilter(context, hasFilter, true);\n        }\n      }\n\n      applyStroke(\n        context,\n        object,\n        stroke,\n        canvasContext,\n        plugin,\n        runtime,\n        this.imagePool,\n      );\n    }\n  }\n\n  private clearShadowAndFilter(\n    context: CanvasRenderingContext2D,\n    hasFilter: boolean,\n    hasShadow: boolean,\n  ) {\n    if (hasShadow) {\n      context.shadowColor = 'transparent';\n      context.shadowBlur = 0;\n    }\n\n    if (hasFilter) {\n      // save drop-shadow filter\n      const oldFilter = context.filter;\n      if (!isNil(oldFilter) && oldFilter.indexOf('drop-shadow') > -1) {\n        context.filter =\n          oldFilter.replace(/drop-shadow\\([^)]*\\)/, '').trim() || 'none';\n      }\n    }\n  }\n}\n\n/**\n * apply before fill and stroke but only once\n */\nexport function setShadowAndFilter(\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  hasShadow: boolean,\n) {\n  const { filter, shadowColor, shadowBlur, shadowOffsetX, shadowOffsetY } =\n    object.parsedStyle as ParsedBaseStyleProps;\n\n  if (filter && filter.length) {\n    // use raw filter string\n    context.filter = object.style.filter;\n  }\n\n  if (hasShadow) {\n    context.shadowColor = shadowColor.toString();\n    context.shadowBlur = shadowBlur || 0;\n    context.shadowOffsetX = shadowOffsetX || 0;\n    context.shadowOffsetY = shadowOffsetY || 0;\n  }\n}\n\nexport function getPattern(\n  pattern: Pattern,\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n): CanvasPattern {\n  let $offscreenCanvas: HTMLCanvasElement;\n  let dpr: number;\n  if ((pattern.image as Rect).nodeName === 'rect') {\n    const { width, height } = (pattern.image as Rect).parsedStyle;\n    dpr = canvasContext.contextService.getDPR();\n    const { offscreenCanvas } = canvasContext.config;\n    $offscreenCanvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(\n      offscreenCanvas,\n    ) as HTMLCanvasElement;\n\n    $offscreenCanvas.width = width * dpr;\n    $offscreenCanvas.height = height * dpr;\n\n    const offscreenCanvasContext =\n      runtime.offscreenCanvasCreator.getOrCreateContext(\n        offscreenCanvas,\n      ) as CanvasRenderingContext2D;\n\n    const restoreStack = [];\n\n    // offscreenCanvasContext.scale(1 / dpr, 1 / dpr);\n\n    (pattern.image as Rect).forEach((object: DisplayObject) => {\n      plugin.renderDisplayObject(\n        object,\n        offscreenCanvasContext,\n        canvasContext,\n        restoreStack,\n        runtime,\n      );\n    });\n\n    restoreStack.forEach(() => {\n      offscreenCanvasContext.restore();\n    });\n  }\n\n  const canvasPattern = imagePool.getOrCreatePatternSync(\n    object,\n    pattern,\n    context,\n    $offscreenCanvas,\n    dpr,\n    object.getGeometryBounds().min,\n    () => {\n      // set dirty rectangle flag\n      object.renderable.dirty = true;\n      canvasContext.renderingService.dirtify();\n    },\n  );\n\n  return canvasPattern;\n}\n\nexport function getColor(\n  parsedColor: CSSGradientValue,\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  imagePool: ImagePool,\n) {\n  let color: CanvasGradient | string;\n\n  if (\n    parsedColor.type === GradientType.LinearGradient ||\n    parsedColor.type === GradientType.RadialGradient\n  ) {\n    const bounds = object.getGeometryBounds();\n    const width = (bounds && bounds.halfExtents[0] * 2) || 1;\n    const height = (bounds && bounds.halfExtents[1] * 2) || 1;\n    const min = (bounds && bounds.min) || [0, 0];\n    color = imagePool.getOrCreateGradient(\n      {\n        type: parsedColor.type,\n        ...(parsedColor.value as LinearGradient & RadialGradient),\n        min: min as [number, number],\n        width,\n        height,\n      },\n      context,\n    );\n  }\n\n  return color;\n}\n\nexport function applyFill(\n  context: CanvasRenderingContext2D,\n  object: DisplayObject,\n  fill: CSSRGB | CSSGradientValue[] | Pattern,\n  fillRule: 'nonzero' | 'evenodd',\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n  skipFill = false,\n) {\n  if (Array.isArray(fill)) {\n    fill.forEach((gradient) => {\n      context.fillStyle = getColor(gradient, object, context, imagePool);\n      if (!skipFill) {\n        fillRule ? context.fill(fillRule) : context.fill();\n      }\n    });\n  } else {\n    if (isPattern(fill)) {\n      context.fillStyle = getPattern(\n        fill,\n        object,\n        context,\n        canvasContext,\n        plugin,\n        runtime,\n        imagePool,\n      );\n    }\n    if (!skipFill) {\n      fillRule ? context.fill(fillRule) : context.fill();\n    }\n  }\n}\n\nexport function applyStroke(\n  context: CanvasRenderingContext2D,\n  object: DisplayObject,\n  stroke: CSSRGB | CSSGradientValue[] | Pattern,\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n  skipStroke = false,\n) {\n  if (Array.isArray(stroke)) {\n    stroke.forEach((gradient) => {\n      context.strokeStyle = getColor(gradient, object, context, imagePool);\n      if (!skipStroke) {\n        context.stroke();\n      }\n    });\n  } else {\n    if (isPattern(stroke)) {\n      context.strokeStyle = getPattern(\n        stroke,\n        object,\n        context,\n        canvasContext,\n        plugin,\n        runtime,\n        imagePool,\n      );\n    }\n    if (!skipStroke) {\n      context.stroke();\n    }\n  }\n}\n","import { vec3, mat4 } from 'gl-matrix';\n\n/**\n * 判断两个点是否重合，点坐标的格式为 [x, y]\n */\nexport function isSamePoint(\n  point1: [number, number],\n  point2: [number, number],\n) {\n  return point1[0] === point2[0] && point1[1] === point2[1];\n}\n\nexport function calculateOverlapRect<\n  Rect extends [number, number, number, number],\n>(rect1: Rect, rect2: Rect): null | Rect {\n  const [x1, y1, w1, h1] = rect1;\n  const [x2, y2, w2, h2] = rect2;\n\n  // 计算重叠区域的左上角和右下角\n  const overlapLeft = Math.max(x1, x2);\n  const overlapTop = Math.max(y1, y2);\n  const overlapRight = Math.min(x1 + w1, x2 + w2);\n  const overlapBottom = Math.min(y1 + h1, y2 + h2);\n\n  if (overlapRight <= overlapLeft || overlapBottom <= overlapTop) {\n    return null;\n  }\n\n  return [\n    overlapLeft,\n    overlapTop,\n    overlapRight - overlapLeft,\n    overlapBottom - overlapTop,\n  ] as Rect;\n}\n\nexport function transformRect<Rect extends [number, number, number, number]>(\n  rect: Rect,\n  matrix: mat4,\n): Rect {\n  const tl = vec3.transformMat4(vec3.create(), [rect[0], rect[1], 0], matrix);\n  const tr = vec3.transformMat4(\n    vec3.create(),\n    [rect[0] + rect[2], rect[1], 0],\n    matrix,\n  );\n  const bl = vec3.transformMat4(\n    vec3.create(),\n    [rect[0], rect[1] + rect[3], 0],\n    matrix,\n  );\n  const br = vec3.transformMat4(\n    vec3.create(),\n    [rect[0] + rect[2], rect[1] + rect[3], 0],\n    matrix,\n  );\n\n  return [\n    Math.min(tl[0], tr[0], bl[0], br[0]),\n    Math.min(tl[1], tr[1], bl[1], br[1]),\n    Math.max(tl[0], tr[0], bl[0], br[0]) - Math.min(tl[0], tr[0], bl[0], br[0]),\n    Math.max(tl[1], tr[1], bl[1], br[1]) - Math.min(tl[1], tr[1], bl[1], br[1]),\n  ] as Rect;\n}\n","import type { DisplayObject, ParsedImageStyleProps } from '@antv/g-lite';\nimport { ImagePool, type ImageCache } from '@antv/g-plugin-image-loader';\nimport { isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport { setShadowAndFilter } from './Default';\nimport type { StyleRenderer } from './interfaces';\nimport { transformRect, calculateOverlapRect } from '../../utils/math';\n\nexport class ImageRenderer implements StyleRenderer {\n  constructor(private imagePool: ImagePool) {}\n\n  static renderFull(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      image: HTMLImageElement;\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    context.drawImage(\n      data.image,\n      Math.floor(data.drawRect[0]),\n      Math.floor(data.drawRect[1]),\n      Math.ceil(data.drawRect[2]),\n      Math.ceil(data.drawRect[3]),\n    );\n  }\n\n  #renderDownSampled(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      src: string | HTMLImageElement;\n      imageCache: ImageCache;\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    const { src, imageCache } = data;\n\n    if (!imageCache.downSampled) {\n      this.imagePool\n        .createDownSampledImage(src, object)\n        .then((res) => {\n          // rerender\n          object.renderable.dirty = true;\n          object.ownerDocument.defaultView.context.renderingService.dirtify();\n        })\n        .catch(() => {\n          //\n        });\n\n      return;\n    }\n\n    context.drawImage(\n      imageCache.downSampled,\n      Math.floor(data.drawRect[0]),\n      Math.floor(data.drawRect[1]),\n      Math.ceil(data.drawRect[2]),\n      Math.ceil(data.drawRect[3]),\n    );\n  }\n\n  #renderTile(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      src: string | HTMLImageElement;\n      imageCache: ImageCache;\n      imageRect: [number, number, number, number];\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    const { src, imageCache, imageRect, drawRect } = data;\n    const { size: originalSize } = imageCache;\n    const { a, b, c, d, e, f } = context.getTransform();\n\n    context.resetTransform();\n\n    if (!imageCache?.gridSize) {\n      this.imagePool\n        .createImageTiles(src, [], object)\n        .then(() => {\n          // rerender\n          object.renderable.dirty = true;\n          object.ownerDocument.defaultView.context.renderingService.dirtify();\n        })\n        .catch(() => {\n          //\n        });\n\n      return;\n    }\n\n    const scaleToOrigin = [\n      originalSize[0] / imageRect[2],\n      originalSize[1] / imageRect[3],\n    ];\n    const scaledTileSize = [\n      imageCache.tileSize[0] / scaleToOrigin[0],\n      imageCache.tileSize[1] / scaleToOrigin[1],\n    ];\n    const [startTileX, endTileX] = [\n      Math.floor((drawRect[0] - imageRect[0]) / scaledTileSize[0]),\n      Math.ceil((drawRect[0] + drawRect[2] - imageRect[0]) / scaledTileSize[0]),\n    ];\n    const [startTileY, endTileY] = [\n      Math.floor((drawRect[1] - imageRect[1]) / scaledTileSize[1]),\n      Math.ceil((drawRect[1] + drawRect[3] - imageRect[1]) / scaledTileSize[1]),\n    ];\n\n    for (let tileY = startTileY; tileY <= endTileY; tileY++) {\n      for (let tileX = startTileX; tileX <= endTileX; tileX++) {\n        const item = imageCache.tiles[tileY][tileX];\n\n        if (item) {\n          const tileRect = [\n            Math.floor(imageRect[0] + item.tileX * scaledTileSize[0]),\n            Math.floor(imageRect[1] + item.tileY * scaledTileSize[1]),\n            Math.ceil(scaledTileSize[0]),\n            Math.ceil(scaledTileSize[1]),\n          ];\n\n          context.drawImage(\n            item.data,\n            tileRect[0],\n            tileRect[1],\n            tileRect[2],\n            tileRect[3],\n          );\n        }\n      }\n    }\n\n    context.setTransform(a, b, c, d, e, f);\n  }\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n  ) {\n    const {\n      x = 0,\n      y = 0,\n      width,\n      height,\n      src,\n      shadowColor,\n      shadowBlur,\n    } = parsedStyle;\n\n    const imageCache = this.imagePool.getImageSync(src, object);\n    const image = imageCache?.img;\n    let iw = width;\n    let ih = height;\n\n    if (!image) {\n      return;\n    }\n\n    iw ||= image.width;\n    ih ||= image.height;\n\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    setShadowAndFilter(object, context, hasShadow);\n\n    // node-canvas will throw the following err:\n    // Error: Image given has not completed loading\n    try {\n      const { width: viewWidth, height: viewHeight } =\n        object.ownerDocument.defaultView.getContextService().getDomElement();\n\n      const currentTransform = context.getTransform();\n      const { a, b, c, d, e, f } = currentTransform;\n      // 构建 mat4 矩阵\n      // prettier-ignore\n      const transformMatrix = mat4.fromValues(\n          a, c, 0, 0,\n          b, d, 0, 0,\n          0, 0, 1, 0,\n          e, f, 0, 1,\n        );\n      const imageRect = transformRect([x, y, iw, ih], transformMatrix);\n      const drawRect = calculateOverlapRect(\n        [0, 0, viewWidth, viewHeight],\n        imageRect,\n      );\n\n      if (!drawRect) {\n        return;\n      }\n\n      if (\n        !object.ownerDocument.defaultView.getConfig()\n          .enableLargeImageOptimization\n      ) {\n        ImageRenderer.renderFull(context, parsedStyle, object, {\n          image,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      const sizeOfOrigin = imageRect[2] / imageCache.size[0];\n\n      if (sizeOfOrigin < (imageCache.downSamplingRate || 0.5)) {\n        this.#renderDownSampled(context, parsedStyle, object, {\n          src,\n          imageCache,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      if (!ImagePool.isSupportTile) {\n        ImageRenderer.renderFull(context, parsedStyle, object, {\n          image,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      this.#renderTile(context, parsedStyle, object, {\n        src,\n        imageCache,\n        imageRect,\n        drawRect,\n      });\n    } catch {}\n  }\n}\n","import {\n  type CSSRGB,\n  type CanvasContext,\n  type DisplayObject,\n  type GlobalRuntime,\n  type ParsedTextStyleProps,\n  type Rectangle,\n  CSSGradientValue,\n  Pattern,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { ImagePool } from '@antv/g-plugin-image-loader';\nimport { applyFill, applyStroke, setShadowAndFilter } from './Default';\nimport type { StyleRenderer } from './interfaces';\nimport { CanvasRendererPlugin } from '../../CanvasRendererPlugin';\n\nexport class TextRenderer implements StyleRenderer {\n  constructor(private imagePool: ImagePool) {}\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedTextStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    // Trigger text geometry calculation.\n    object.getBounds();\n    const {\n      lineWidth = 1,\n      textAlign = 'start',\n      textBaseline = 'alphabetic',\n      lineJoin = 'miter',\n      miterLimit = 10,\n      letterSpacing = 0,\n      stroke,\n      fill,\n      fillRule,\n      fillOpacity = 1,\n      strokeOpacity = 1,\n      opacity = 1,\n      metrics,\n      x = 0,\n      y = 0,\n      dx,\n      dy,\n      shadowColor,\n      shadowBlur,\n    } = parsedStyle;\n\n    const { font, lines, height, lineHeight, lineMetrics } = metrics;\n\n    context.font = font;\n    context.lineWidth = lineWidth;\n    context.textAlign = textAlign === 'middle' ? 'center' : textAlign;\n\n    let formattedTextBaseline = textBaseline;\n    if (formattedTextBaseline === 'alphabetic') {\n      formattedTextBaseline = 'bottom';\n    }\n\n    context.lineJoin = lineJoin;\n    if (!isNil(miterLimit)) {\n      context.miterLimit = miterLimit;\n    }\n\n    let linePositionY = y;\n    // handle vertical text baseline\n    if (textBaseline === 'middle') {\n      linePositionY += -height / 2 - lineHeight / 2;\n    } else if (\n      textBaseline === 'bottom' ||\n      textBaseline === 'alphabetic' ||\n      textBaseline === 'ideographic'\n    ) {\n      linePositionY += -height;\n    } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n      linePositionY += -lineHeight;\n    }\n\n    // account for dx & dy\n    const offsetX = x + (dx || 0);\n    linePositionY += dy || 0;\n\n    if (lines.length === 1) {\n      if (formattedTextBaseline === 'bottom') {\n        formattedTextBaseline = 'middle';\n        linePositionY -= 0.5 * height;\n      } else if (formattedTextBaseline === 'top') {\n        formattedTextBaseline = 'middle';\n        linePositionY += 0.5 * height;\n      }\n    }\n    context.textBaseline = formattedTextBaseline;\n\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    setShadowAndFilter(object, context, hasShadow);\n\n    // draw lines line by line\n    for (let i = 0; i < lines.length; i++) {\n      const linePositionX = lineWidth / 2 + offsetX;\n      linePositionY += lineHeight;\n\n      // no need to re-position X, cause we already set text align\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textAlign\n      if (!isNil(stroke) && !(stroke as CSSRGB).isNone && lineWidth) {\n        this.drawLetterSpacing(\n          context,\n          object,\n          lines[i],\n          lineMetrics[i],\n          textAlign,\n          linePositionX,\n          linePositionY,\n          letterSpacing,\n          fill,\n          fillRule,\n          fillOpacity,\n          stroke,\n          strokeOpacity,\n          opacity,\n          true,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      if (!isNil(fill)) {\n        this.drawLetterSpacing(\n          context,\n          object,\n          lines[i],\n          lineMetrics[i],\n          textAlign,\n          linePositionX,\n          linePositionY,\n          letterSpacing,\n          fill,\n          fillRule,\n          fillOpacity,\n          stroke,\n          strokeOpacity,\n          opacity,\n          false,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n    }\n  }\n\n  private drawLetterSpacing(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    lineMetrics: Rectangle,\n    textAlign: CanvasTextAlign | 'middle',\n    x: number,\n    y: number,\n    letterSpacing: number,\n    fill: CSSRGB | CSSGradientValue[] | Pattern,\n    fillRule: 'nonzero' | 'evenodd',\n    fillOpacity: number | undefined,\n    stroke: CSSRGB | CSSGradientValue[] | Pattern,\n    strokeOpacity: number | undefined,\n    opacity: number | undefined,\n    isStroke: boolean,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ): void {\n    // letterSpacing of 0 means normal, render all texts directly\n    if (letterSpacing === 0) {\n      if (isStroke) {\n        this.strokeText(\n          context,\n          object,\n          text,\n          x,\n          y,\n          stroke,\n          strokeOpacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      } else {\n        this.fillText(\n          context,\n          object,\n          text,\n          x,\n          y,\n          fill,\n          fillRule,\n          fillOpacity,\n          opacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      return;\n    }\n\n    // draw text using left align\n    const currentTextAlign = context.textAlign;\n    context.textAlign = 'left';\n\n    let currentPosition = x;\n    if (textAlign === 'center' || textAlign === 'middle') {\n      currentPosition = x - lineMetrics.width / 2;\n    } else if (textAlign === 'right' || textAlign === 'end') {\n      currentPosition = x - lineMetrics.width;\n    }\n\n    const stringArray = Array.from(text);\n    let previousWidth = context.measureText(text).width;\n    let currentWidth = 0;\n    for (let i = 0; i < stringArray.length; ++i) {\n      const currentChar = stringArray[i];\n      if (isStroke) {\n        this.strokeText(\n          context,\n          object,\n          currentChar,\n          currentPosition,\n          y,\n          stroke,\n          strokeOpacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      } else {\n        this.fillText(\n          context,\n          object,\n          currentChar,\n          currentPosition,\n          y,\n          fill,\n          fillRule,\n          fillOpacity,\n          opacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      currentWidth = context.measureText(text.substring(i + 1)).width;\n      currentPosition += previousWidth - currentWidth + letterSpacing;\n      previousWidth = currentWidth;\n    }\n\n    context.textAlign = currentTextAlign;\n  }\n\n  private fillText(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    x: number,\n    y: number,\n    fill: CSSRGB | CSSGradientValue[] | Pattern,\n    fillRule: 'nonzero' | 'evenodd',\n    fillOpacity: number | undefined,\n    opacity: number | undefined,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    applyFill(\n      context,\n      object,\n      fill,\n      fillRule,\n      canvasContext,\n      plugin,\n      runtime,\n      this.imagePool,\n      true,\n    );\n\n    let currentGlobalAlpha: number;\n    const applyOpacity = !isNil(fillOpacity) && fillOpacity !== 1;\n    if (applyOpacity) {\n      currentGlobalAlpha = context.globalAlpha;\n      context.globalAlpha = fillOpacity * opacity;\n    }\n    context.fillText(text, x, y);\n    if (applyOpacity) {\n      context.globalAlpha = currentGlobalAlpha;\n    }\n  }\n\n  private strokeText(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    x: number,\n    y: number,\n    stroke: CSSRGB | CSSGradientValue[] | Pattern,\n    strokeOpacity: number | undefined,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    applyStroke(\n      context,\n      object,\n      stroke,\n      canvasContext,\n      plugin,\n      runtime,\n      this.imagePool,\n      true,\n    );\n\n    let currentGlobalAlpha: number;\n    const applyOpacity = !isNil(strokeOpacity) && strokeOpacity !== 1;\n    if (applyOpacity) {\n      currentGlobalAlpha = context.globalAlpha;\n      context.globalAlpha = strokeOpacity!;\n    }\n    context.strokeText(text, x, y);\n    if (applyOpacity) {\n      context.globalAlpha = currentGlobalAlpha;\n    }\n  }\n}\n","import { DefaultRenderer } from './Default';\n\nexport class RectRenderer extends DefaultRenderer {}\n","import { DefaultRenderer } from './Default';\n\nexport class CircleRenderer extends DefaultRenderer {}\n","import { DefaultRenderer } from './Default';\n\nexport class EllipseRenderer extends DefaultRenderer {}\n","import { DefaultRenderer } from './Default';\n\nexport class LineRenderer extends DefaultRenderer {}\n","import { DefaultRenderer } from './Default';\n\nexport class PolylineRenderer extends DefaultRenderer {}\n","import { DefaultRenderer } from './Default';\n\nexport class PolygonRenderer extends DefaultRenderer {}\n","import { DefaultRenderer } from './Default';\n\nexport class PathRenderer extends DefaultRenderer {}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport { CanvasRendererPlugin } from './CanvasRendererPlugin';\nimport type { StyleRenderer } from './shapes/styles';\nimport { DefaultRenderer } from './shapes/styles/Default';\nimport { ImageRenderer } from './shapes/styles/Image';\nimport { TextRenderer } from './shapes/styles/Text';\nimport type { CanvasRendererPluginOptions } from './interfaces';\n\nexport * from './shapes/styles';\n\nexport class Plugin extends AbstractRendererPlugin<{\n  defaultStyleRendererFactory: Record<Shape, StyleRenderer>;\n  styleRendererFactory: Record<Shape, StyleRenderer>;\n}> {\n  name = 'canvas-renderer';\n\n  constructor(private options: Partial<CanvasRendererPluginOptions> = {}) {\n    super();\n  }\n\n  init(): void {\n    const canvasRendererPluginOptions: CanvasRendererPluginOptions = {\n      dirtyObjectNumThreshold: 500,\n      dirtyObjectRatioThreshold: 0.8,\n      ...this.options,\n    };\n\n    // @ts-ignore\n    const { imagePool } = this.context;\n\n    const defaultRenderer = new DefaultRenderer(imagePool);\n\n    const defaultStyleRendererFactory: Record<Shape, StyleRenderer> = {\n      [Shape.CIRCLE]: defaultRenderer,\n      [Shape.ELLIPSE]: defaultRenderer,\n      [Shape.RECT]: defaultRenderer,\n      [Shape.IMAGE]: new ImageRenderer(imagePool),\n      [Shape.TEXT]: new TextRenderer(imagePool),\n      [Shape.LINE]: defaultRenderer,\n      [Shape.POLYLINE]: defaultRenderer,\n      [Shape.POLYGON]: defaultRenderer,\n      [Shape.PATH]: defaultRenderer,\n      [Shape.GROUP]: undefined,\n      [Shape.HTML]: undefined,\n      [Shape.MESH]: undefined,\n    };\n\n    this.context.defaultStyleRendererFactory = defaultStyleRendererFactory;\n    this.context.styleRendererFactory = defaultStyleRendererFactory;\n\n    this.addRenderingPlugin(\n      new CanvasRendererPlugin(canvasRendererPluginOptions),\n    );\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n\n    delete this.context.defaultStyleRendererFactory;\n    delete this.context.styleRendererFactory;\n  }\n}\n"],"names":["CanvasRendererPlugin","canvasRendererPluginOptions","_classCallCheck","removedRBushNodeAABBs","renderQueue","restoreStack","clearFullScreenLastFrame","clearFullScreen","vpMatrix","mat4","create","dprMatrix","tmpMat4","vec3a","vec3","vec3b","vec3c","vec3d","_createClass","key","value","apply","context","runtime","_this","config","camera","renderingService","renderingContext","rBushRoot","pathGeneratorFactory","rBush","contextService","canvas","root","ownerDocument","defaultView","handleUnmounted","e","object","target","rBushNode","aabb","push","handleCulled","hooks","init","tap","tag","addEventListener","ElementEvent","UNMOUNTED","CULLED","dpr","getDPR","width","height","getContext","clearRect","background","destroy","removeEventListener","beginFrame","_canvas$context$rende","_this$canvasRendererP","dirtyObjectNumThreshold","dirtyObjectRatioThreshold","_renderingService$get","getStats","total","rendered","ratio","renderingPlugins","isFirstTimeRenderingFinished","disableDirtyRectangleRendering","resetTransform","setTransform","renderByZIndex","isVisible","isCulled","renderDisplayObject","sorted","sortable","childNodes","forEach","child","endFrame","length","fromScaling","multiply","getOrthoMatrix","dirtyRenderBounds","safeMergeAABB","mergeDirtyAABBs","concat","_toConsumableArray","map","_ref","minX","minY","maxX","maxY","AABB","setMinMax","isEmpty","dirtyRect","convertAABB2Rect","x","y","tl","transformMat4","tr","bl","br","minx","Math","min","miny","maxx","max","maxy","ix","floor","iy","iwidth","ceil","iheight","save","beginPath","rect","clip","_config$renderer$getC","renderer","getConfig","enableDirtyRectangleRenderingDebug","dispatchEvent","CustomEvent","CanvasEvent","DIRTY_RECTANGLE","dirtyObjects","searchDirtyObjects","sort","a","b","renderOrder","restore","saveDirtyAABB","render","fillStyle","fillRect","canvasContext","nodeName","parent","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINS","pop","styleRenderer","styleRendererFactory","generatePath","_ref2","parsedStyle","clipPath","applyWorldTransform","closePath","applyAttributesToContext","Shape","LINE","PATH","POLYLINE","renderable","dirty","getMin","getMax","renderBounds","getRenderBounds","add","dirtyRectangle","_dirtyRectangle$getMi","_dirtyRectangle$getMi2","_slicedToArray","_dirtyRectangle$getMa","_dirtyRectangle$getMa2","rBushNodes","search","_ref3","displayObject","update","center","halfExtents","_ref4","stroke","fill","opacity","lineDash","lineDashOffset","setLineDash","isNil","globalAlpha","Array","isArray","isNone","strokeStyle","attributes","matrix","copy","getLocalTransform","getWorldTransform","merged","_len","arguments","aabbs","_key","DefaultRenderer","imagePool","plugin","fillRule","_parsedStyle$opacity","_parsedStyle$fillOpac","fillOpacity","_parsedStyle$strokeOp","strokeOpacity","_parsedStyle$lineWidt","lineWidth","lineCap","lineJoin","shadowType","shadowColor","shadowBlur","filter","miterLimit","hasFill","hasStroke","isFillTransparent","alpha","hasFilter","hasShadow","isInnerShadow","shouldDrawShadowWithStroke","setShadowAndFilter","applyFill","clearShadowAndFilter","globalCompositeOperation","applyStroke","oldFilter","indexOf","replace","trim","shadowOffsetX","shadowOffsetY","style","toString","getPattern","pattern","$offscreenCanvas","image","_parsedStyle","offscreenCanvas","offscreenCanvasCreator","getOrCreateCanvas","offscreenCanvasContext","getOrCreateContext","canvasPattern","getOrCreatePatternSync","getGeometryBounds","dirtify","getColor","parsedColor","color","type","GradientType","LinearGradient","RadialGradient","bounds","getOrCreateGradient","_objectSpread","skipFill","undefined","gradient","isPattern","skipStroke","calculateOverlapRect","rect1","rect2","_rect","x1","y1","w1","h1","_rect2","x2","y2","w2","h2","overlapLeft","overlapTop","overlapRight","overlapBottom","transformRect","_renderDownSampled","_classPrivateFieldLooseKey","_renderTile","ImageRenderer","Object","defineProperty","_renderTile2","_renderDownSampled2","_parsedStyle$x","_parsedStyle$y","src","imageCache","getImageSync","img","iw","ih","_object$ownerDocument","getContextService","getDomElement","viewWidth","viewHeight","currentTransform","getTransform","c","d","f","transformMatrix","fromValues","imageRect","drawRect","enableLargeImageOptimization","renderFull","sizeOfOrigin","size","downSamplingRate","_classPrivateFieldLooseBase","ImagePool","isSupportTile","_unused","data","drawImage","downSampled","createDownSampledImage","then","res","originalSize","_context$getTransform","gridSize","createImageTiles","scaleToOrigin","scaledTileSize","tileSize","startTileX","endTileX","startTileY","endTileY","tileY","tileX","item","tiles","tileRect","TextRenderer","getBounds","_parsedStyle$textAlig","textAlign","_parsedStyle$textBase","textBaseline","_parsedStyle$lineJoin","_parsedStyle$miterLim","_parsedStyle$letterSp","letterSpacing","metrics","dx","dy","font","lines","lineHeight","lineMetrics","formattedTextBaseline","linePositionY","offsetX","i","linePositionX","drawLetterSpacing","text","isStroke","strokeText","fillText","currentTextAlign","currentPosition","stringArray","from","previousWidth","measureText","currentWidth","currentChar","substring","currentGlobalAlpha","applyOpacity","RectRenderer","_DefaultRenderer","_callSuper","_inherits","CircleRenderer","EllipseRenderer","LineRenderer","PolylineRenderer","PolygonRenderer","PathRenderer","Plugin","_AbstractRendererPlug","options","name","_defaultStyleRenderer","defaultRenderer","defaultStyleRendererFactory","_defineProperty","CIRCLE","ELLIPSE","RECT","IMAGE","TEXT","POLYGON","GROUP","HTML","MESH","addRenderingPlugin","removeAllRenderingPlugins","AbstractRendererPlugin"],"mappings":"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"}